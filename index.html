<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevPro Toolkit - Developer Tools, Code Playground & Format Converter</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/ajv@8/dist/2020.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #60a5fa;
            --secondary: #0ea5e9;
            --secondary-dark: #0284c7;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-primary: #0d1424;
            --bg-secondary: #111a2e;
            --bg-tertiary: #1b2540;
            --text-primary: #e5e7eb;
            --text-secondary: #c7d0dd;
            --text-muted: #94a3b8;
            --border: rgba(148, 163, 184, 0.25);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 8px -1px rgba(0, 0, 0, 0.14);
            --shadow-lg: 0 10px 18px -3px rgba(0, 0, 0, 0.18);
            --shadow-xl: 0 18px 32px -8px rgba(0, 0, 0, 0.28);
            
            /* Consistent Spacing System */
            --space-xs: 0.5rem;
            --space-sm: 0.75rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Consistent Border Radius */
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            
            /* Input/Button Heights */
            --input-height: 2.75rem;
            --button-height: 2.75rem;
        }

        /* Light theme overrides (cream white background) */
        body.theme-light {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #1d4ed8;
            --secondary: #0f766e;
            --secondary-dark: #115e59;
            --danger: #b91c1c;
            --warning: #b45309;
            --bg-primary: #f9f5ee;
            --bg-secondary: #f3ebe0;
            --bg-tertiary: #e6dccf;
            --text-primary: #111827;
            --text-secondary: #374151;
            --text-muted: #6b7280;
            --border: rgba(0, 0, 0, 0.06);
        }

        html {
            width: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: 'Manrope', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: radial-gradient(circle at 20% 20%, rgba(37, 99, 235, 0.12), transparent 28%),
                        radial-gradient(circle at 80% 10%, rgba(14, 165, 233, 0.12), transparent 30%),
                        linear-gradient(135deg, #0d1424 0%, #111a2e 50%, #152038 100%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
            margin: 0;
            padding: 0;
            width: 100%;
            max-width: 100vw;
        }

        body.theme-light {
            background: radial-gradient(circle at 10% 0%, rgba(248, 250, 252, 0.9), transparent 45%),
                        radial-gradient(circle at 90% 10%, rgba(254, 243, 199, 0.7), transparent 55%),
                        linear-gradient(135deg, #fdfaf5 0%, #f7f1e7 50%, #f1e4d4 100%);
        }

        /* Professional grid background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(99, 102, 241, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(99, 102, 241, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        /* Floating orb for depth */
        body::after {
            content: '';
            position: fixed;
            width: 500px;
            height: 500px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.15) 0%, transparent 70%);
            top: -250px;
            right: -250px;
            pointer-events: none;
            z-index: 0;
            animation: float 20s ease-in-out infinite;
        }

        body.theme-light::before {
            background-image: 
                linear-gradient(rgba(148, 163, 184, 0.2) 1px, transparent 1px),
                linear-gradient(90deg, rgba(148, 163, 184, 0.2) 1px, transparent 1px);
        }

        body.theme-light::after {
            background: radial-gradient(circle, rgba(248, 250, 252, 0.9) 0%, transparent 70%);
            opacity: 0.7;
        }

        .container {
            position: relative;
            z-index: 1;
            width: min(1200px, calc(100% - 2.5rem));
            margin: 0 auto;
        }

        /* Second floating orb */
        .container::before {
            content: '';
            position: fixed;
            width: 400px;
            height: 400px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.1) 0%, transparent 70%);
            bottom: -200px;
            left: -200px;
            pointer-events: none;
            z-index: 0;
            animation: float 25s ease-in-out infinite reverse;
            margin: 0 auto;
            padding: 1rem 2rem;
            min-height: 10vh;
        }

        .site-footer {
            text-align: center;
            margin-top: 4rem;
            padding: 2rem 0;
            border-top: 1px solid rgba(148, 163, 184, 0.1);
            background: linear-gradient(180deg, transparent 0%, rgba(15, 23, 42, 0.4) 100%);
            backdrop-filter: blur(10px);
            color: var(--text-secondary);
            font-size: 0.95rem;
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }

        .site-footer span {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        .site-footer a {
            color: var(--primary-light);
            text-decoration: none;
            font-weight: 600;
        }

        .site-footer a:hover {
            text-decoration: underline;
        }

        /* Header with Navigation */
        .header {
            position: relative;
            z-index: 1000;
            margin-bottom: 1.5rem;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid rgba(99, 102, 241, 0.15);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);
            animation: slideDown 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            transition: all 0.3s ease;
        }

        body.theme-light .header {
            background: rgba(249, 245, 238, 0.96);
            border-bottom-color: rgba(15, 23, 42, 0.08);
            box-shadow: 0 10px 24px rgba(148, 163, 184, 0.35);
        }

        @keyframes slideDown {
            0% {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            60% {
                transform: translateY(5px) scale(1.02);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(40px) rotateX(10deg);
            }
            100% {
                opacity: 1;
                transform: translateY(0) rotateX(0);
            }
        }

        @keyframes sectionFadeIn {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.96);
                filter: blur(5px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 
                    0 8px 24px rgba(102, 126, 234, 0.4),
                    0 0 0 0 rgba(102, 126, 234, 0.4);
                transform: scale(1);
            }
            50% {
                box-shadow: 
                    0 12px 32px rgba(102, 126, 234, 0.6),
                    0 0 0 20px rgba(102, 126, 234, 0);
                transform: scale(1.05);
            }
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-3deg); }
            75% { transform: rotate(3deg); }
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            14% { transform: scale(1.15); }
            28% { transform: scale(1); }
            42% { transform: scale(1.1); }
            70% { transform: scale(1); }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.5;
            }
            50% {
                transform: translateY(50px) rotate(180deg);
                opacity: 0.8;
            }
        }

        @keyframes toastSlideIn {
            0% {
                opacity: 0;
                transform: translateX(100px) rotate(10deg) scale(0.8);
            }
            70% {
                transform: translateX(-10px) rotate(-2deg) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateX(0) rotate(0) scale(1);
            }
        }

        @keyframes pdfInputFadeIn {
            0% {
                opacity: 0;
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .header-wrapper {
            width: min(1200px, calc(100% - 2.5rem));
            margin: 0 auto;
            padding: 0.65rem 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo { 
            flex-shrink: 0;
            cursor: pointer;
        }
        
        .logo img {
            max-width: 90px;
            height: auto;
            display: block;
            filter: drop-shadow(0 2px 8px rgba(99, 102, 241, 0.4));
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .logo:hover img {
            transform: scale(1.05);
            filter: drop-shadow(0 4px 10px rgba(99, 102, 241, 0.45));
        }
        
        .logo-text { 
            font-size: 1.1rem; 
            font-weight: 700; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .logo-text::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .logo-text:hover::after {
            width: 100%;
        }

        .logo-text:hover {
            letter-spacing: 0.02em;
        }

        /* Navigation Menu */
        .nav-menu {
            display: flex !important;
            flex-direction: row !important;
            align-items: center;
            gap: 0.5rem;
            list-style: none;
            margin: 0;
            padding: 0;
            flex-wrap: wrap;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.4rem 0.8rem;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
            border-radius: 6px;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .nav-link:hover::before {
            opacity: 1;
        }

        .nav-link:hover {
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .nav-link.active {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(168, 85, 247, 0.15) 100%);
            color: var(--primary-light);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 10%;
            right: 10%;
            height: 2px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        .nav-icon {
            font-size: 0.95rem;
        }

        /* Dropdown Menu Styles */
        .nav-dropdown {
            position: relative;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            min-width: 180px;
            background: rgba(30, 41, 59, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 8px;
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.4);
            padding: 0.4rem;
            margin-top: 0.3rem;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease;
        }

        body.theme-light .dropdown-menu {
            background: rgba(249, 245, 238, 0.98);
            border-color: rgba(15, 23, 42, 0.08);
            box-shadow: 0 10px 28px rgba(148, 163, 184, 0.45);
        }

        body.theme-light .dropdown-menu a {
            color: #111827;
        }

        body.theme-light .dropdown-menu a:hover {
            background: rgba(37, 99, 235, 0.08);
            color: #1d4ed8;
        }

        .dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-menu a {
            display: block;
            color: var(--text-primary);
            text-decoration: none;
            padding: 0.5rem 0.8rem;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
        }

        .dropdown-menu a:hover {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary-light);
            transform: translateX(4px);
        }

        @keyframes dropdownSlideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: rgba(51, 65, 85, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: var(--text-primary);
            padding: 0.6rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            background: rgba(99, 102, 241, 0.2);
            transform: scale(1.05);
        }

        .theme-toggle {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.4rem 0.7rem;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.85);
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.25s ease;
            margin-left: auto;
            margin-right: 0.5rem;
        }

        .theme-toggle-icon {
            font-size: 0.7rem;
        }

        .theme-toggle:hover {
            border-color: var(--primary-light);
            color: var(--text-primary);
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.35);
        }

        body.theme-light .theme-toggle {
            background: rgba(249, 250, 251, 0.9);
        }

        body.theme-light .mobile-menu-toggle {
            background: rgba(248, 250, 252, 0.95);
            border-color: rgba(148, 163, 184, 0.7);
            color: #111827;
        }

        /* Force horizontal layout on desktop/tablet */
        @media (min-width: 481px) {
            .nav-menu {
                display: flex !important;
                flex-direction: row !important;
                position: static !important;
                width: auto !important;
                background: transparent !important;
                padding: 0 !important;
                border: none !important;
                box-shadow: none !important;
                gap: 0.25rem !important;
                align-items: center !important;
            }
            
            .nav-item {
                display: inline-block !important;
            }
        }

        @media (max-width: 480px) {
            .header {
                margin-bottom: 0.75rem;
            }

            .header-wrapper {
                padding: 0.55rem 0.8rem;
                gap: 0.5rem;
            }

            .logo img {
                max-width: 56px;
            }

            .logo-text {
                font-size: 1.05rem;
            }

            .nav-menu {
                position: absolute;
                top: 64px;
                left: 0.75rem;
                right: 0.75rem;
                flex-direction: column !important;
                background: #020617;
                backdrop-filter: blur(18px);
                width: auto;
                padding: 0.6rem 0.7rem 0.7rem;
                border-radius: 16px;
                border: 1px solid rgba(96, 109, 128, 0.35);
                box-shadow: 0 16px 32px rgba(15, 23, 42, 0.75);
                gap: 0.2rem;
                align-items: stretch;
                display: none;
                z-index: 1100;
            }

            body.theme-light .nav-menu {
                background: #f9f5ee;
                border-color: rgba(148, 163, 184, 0.45);
                box-shadow: 0 18px 40px rgba(148, 163, 184, 0.45);
            }

            .nav-menu.active {
                display: flex;
                z-index: 9999;
            }

            .nav-link {
                padding: 0.55rem 0.75rem;
                font-size: 0.78rem;
            }

            .nav-link.active::after { display: none; }
            .nav-item { margin: 0; }
            .nav-icon { font-size: 0.85rem; }

            .nav-link {
                justify-content: flex-start;
                padding: 0.85rem 1rem;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .header-wrapper {
                padding: 0.9rem 1.1rem;
            }

            .logo-text {
                font-size: 1.2rem;
            }

            /* Mobile dropdown styles */
            .dropdown-menu {
                position: static;
                margin-top: 0.5rem;
                margin-left: 1rem;
                box-shadow: none;
                border: 1px solid rgba(96, 109, 128, 0.25);
            }
        }

        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.1) 100%);
            border: 1px solid rgba(16, 185, 129, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            margin-top: 1rem;
            color: var(--secondary);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        /* Main Content Sections */
        .main-content {
            opacity: 1;
            transform: translateY(0);
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .content-section {
            display: none;
            opacity: 0;
            transform: translateY(30px);
            animation: sectionFadeIn 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards;
        }

        .content-section.active {
            display: block;
        }

        @keyframes sectionFadeIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInUp 0.6s ease-out;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #2563eb 0%, #0ea5e9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.75rem;
            letter-spacing: -0.02em;
        }

        .section-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Home Page */
        .home-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem 0;
        }

        .format-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            width: 100%;
            max-width: 1200px;
            margin-top: 2rem;
        }

        @media (max-width: 1200px) {
            .format-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .format-options {
                grid-template-columns: 1fr;
                max-width: 500px;
            }
            
            .section-title {
                font-size: 2rem;
            }
        }

        .format-card {
            background: rgba(23, 32, 54, 0.55);
            backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 18px;
            padding: 1.85rem;
            cursor: pointer;
            transition: all 0.35s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 26px rgba(0, 0, 0, 0.16);
        }

        body.theme-light .format-card {
            background: rgba(255, 255, 255, 0.85);
            border-color: rgba(15, 23, 42, 0.06);
            box-shadow: 0 14px 32px rgba(148, 163, 184, 0.35);
        }

        .format-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(37, 99, 235, 0.14) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.6s ease;
        }

        .format-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent
            );
            transition: left 0.6s ease;
        }

        .format-card:hover {
            transform: translateY(-6px);
            border-color: rgba(37, 99, 235, 0.4);
            box-shadow: 
                0 18px 48px rgba(37, 99, 235, 0.28),
                0 0 0 1px rgba(37, 99, 235, 0.24),
                inset 0 -3px 18px rgba(37, 99, 235, 0.08);
        }

        .format-card:hover::before {
            opacity: 1;
        }

        .format-card:hover::after {
            left: 100%;
        }

        .format-card:active {
            transform: translateY(-4px) scale(0.99);
        }

        .format-card:nth-child(1) { animation: fadeInUp 0.6s ease-out 0.1s both; }
        .format-card:nth-child(2) { animation: fadeInUp 0.6s ease-out 0.15s both; }
        .format-card:nth-child(3) { animation: fadeInUp 0.6s ease-out 0.2s both; }
        .format-card:nth-child(4) { animation: fadeInUp 0.6s ease-out 0.25s both; }
        .format-card:nth-child(5) { animation: fadeInUp 0.6s ease-out 0.3s both; }
        .format-card:nth-child(6) { animation: fadeInUp 0.6s ease-out 0.35s both; }
        .format-card:nth-child(7) { animation: fadeInUp 0.6s ease-out 0.4s both; }
        .format-card:nth-child(8) { animation: fadeInUp 0.6s ease-out 0.45s both; }
        .format-card:nth-child(9) { animation: fadeInUp 0.6s ease-out 0.5s both; }

        .format-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 4px 12px rgba(102, 126, 234, 0.4));
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .format-card:hover .format-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .format-card:nth-child(3n+1) .format-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .format-card:nth-child(3n+2) .format-icon {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .format-card:nth-child(3n) .format-icon {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .format-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .format-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        /* Remove color gradients from all format icons except JSON and XML */
        .format-card:not(:nth-child(1)):not(:nth-child(2)) .format-icon {
            background: none !important;
            -webkit-background-clip: unset !important;
            -webkit-text-fill-color: unset !important;
            background-clip: unset !important;
            color: var(--text-primary) !important;
            filter: none !important;
        }

        /* Editor Page */
        .editor-page {
            display: none;
            animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            /* Keep content below the fixed quick-action-bar */
            padding-top: 100px;
        }
        /* Reduce top padding on small screens to avoid excessive whitespace */
        @media (max-width: 1024px) {
            .editor-page { padding-top: 160px; }
        }

        .editor-page.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .playground-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 1rem;
            min-height: 500px;
        }

        .playground-panel {
            display: flex;
            flex-direction: column;
        }

        .playground-editor-wrapper {
            position: relative;
            flex: 1;
        }

        #playground-editor {
            width: 100%;
            min-height: 500px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
        }

        #playground-output {
            flex: 1;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            overflow-y: auto;
        body.theme-light .url-modal-content {
            background: #ffffff;
            box-shadow: 0 20px 40px rgba(148, 163, 184, 0.45);
        }
            min-height: 500px;
            white-space: pre-wrap;
            word-break: break-word;
        }

        body.theme-light #playground-output {
            background: #ffffff;
            border-color: rgba(148, 163, 184, 0.55);
            color: #111827;
        }

        @media (max-width: 1200px) {
            .playground-grid {
                grid-template-columns: 1fr;
            }

            #playground-editor,
            #playground-output {
                min-height: 400px;
            }
        }

        @media (max-width: 768px) {
            #playground-editor,
            #playground-output {
                min-height: 300px;
            }
        }

        .editor-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            flex-wrap: nowrap;
            gap: 1rem;
            min-height: 50px;
        }

        .editor-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 600;
            flex: 0 0 auto;
        }

        .back-button {
            display: inline-flex;
            flex-shrink: 0;
            align-items: center;
            gap: 0.5rem;
            background: rgba(51, 65, 85, 0.8);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.625rem 1.25rem;
            border-radius: 10px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .back-button:hover {
            background: var(--bg-tertiary);
            border-color: rgba(99, 102, 241, 0.4);
            transform: translateX(-4px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .editor-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .editor-grid {
                grid-template-columns: 1.5fr 3.5fr;
            }
        }

        /* Maximize: single-column full-width panels */
        .editor-grid.maximized { grid-template-columns: 1fr; }
        .editor-grid.maximized .panel-content { min-height: 70vh; }

        .output-panel-large {
            grid-column: 1 / -1;
        }

        .resize-toggle {
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            color: var(--primary-light);
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 0.5rem;
        }

        .resize-toggle:hover { background: rgba(99, 102, 241, 0.3); }

        .editor-panel {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .editor-panel:hover {
            border-color: rgba(99, 102, 241, 0.3);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(99, 102, 241, 0.1);
        }

        .panel-header {
            background: linear-gradient(135deg, rgba(51, 65, 85, 0.8) 0%, rgba(30, 41, 59, 0.8) 100%);
            padding: 1.25rem 1.75rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-title {
            font-size: 0.8125rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            background: linear-gradient(135deg, #a5b4fc 0%, #818cf8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .panel-actions {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .icon-button {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: var(--text-primary);
            padding: 0.625rem 0.875rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.125rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 44px;
            min-height: 44px;
        }

        .icon-button:hover {
            background: rgba(99, 102, 241, 0.25);
            border-color: rgba(99, 102, 241, 0.5);
            color: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .icon-button:active {
            transform: scale(0.95);
        }

        .panel-content {
            padding: 1.5rem;
            flex: 1;
            overflow: auto;
            position: relative;
      }

        .code-input {
            width: 100%;
            min-height: 400px;
            background: rgba(15, 23, 42, 0.6);
            border: 1.5px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            resize: vertical;
            transition: all 0.3s ease;
            white-space: pre-wrap;
            word-wrap: break-word;
            tab-size: 4;
        }

        .code-input:focus {
            outline: none;
            border-color: rgba(99, 102, 241, 0.8);
            background: rgba(15, 23, 42, 0.95);
            box-shadow: 
                0 0 0 3px rgba(99, 102, 241, 0.3),
                0 8px 24px rgba(99, 102, 241, 0.25);
        }

        .code-input::placeholder {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .code-output {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            min-height: 500px;
            max-height: none;
            overflow-x: auto;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-all;
            max-width: 100%;
        }

        body.theme-light .code-input {
            background: rgba(249, 250, 251, 0.95);
            border-color: rgba(148, 163, 184, 0.55);
            color: var(--text-primary);
        }

        body.theme-light .code-input:focus {
            background: #ffffff;
            box-shadow:
                0 0 0 3px rgba(37, 99, 235, 0.28),
                0 10px 26px rgba(148, 163, 184, 0.35);
        }

        body.theme-light .code-output {
            background: #ffffff;
            border-color: rgba(148, 163, 184, 0.55);
            color: #111827;
        }

        .action-buttons {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .action-buttons .button {
            flex: 0 1 auto;
            white-space: nowrap;
        }

        /* Advanced Tools Panel */
        .advanced-tools-panel {
            position: fixed;
            left: 0;
            right: 0;
            z-index: 99;
            margin-bottom: 1rem;
            animation: slideDown 0.3s ease-out;
            overflow: hidden;
            transition: all 0.3s ease;
            background: rgba(30, 41, 59, 0.4);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            padding: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .advanced-tools-panel[style*="display: none"] {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 1;
                max-height: 200px;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                max-height: 0;
                transform: translateY(-10px);
            }
        }

        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-family: inherit;
            height: var(--button-height);
            white-space: nowrap;
            text-decoration: none;
            line-height: 1;
        }

        .button-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            box-shadow: 
                0 4px 16px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .button-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .button-primary:hover::before {
            left: 100%;
        }

        .button-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 28px rgba(102, 126, 234, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            animation: heartbeat 0.8s ease-in-out;
        }

        .button-primary:active {
            transform: translateY(-1px) scale(0.98);
            box-shadow: 
                0 4px 12px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .button-secondary {
            background: rgba(51, 65, 85, 0.8);
            color: var(--text-primary);
            border: 1px solid rgba(148, 163, 184, 0.3);
            transition: all 0.3s ease;
        }

        body.theme-light .advanced-tools-panel {
            background: rgba(255, 255, 255, 0.96);
            border-bottom-color: rgba(15, 23, 42, 0.08);
            box-shadow: 0 10px 24px rgba(148, 163, 184, 0.25);
        }

        body.theme-light .button-secondary {
            background: #ffffff;
            color: #111827;
            border-color: rgba(148, 163, 184, 0.5);
        }

        .button-secondary:hover {
            background: var(--bg-tertiary);
            border-color: rgba(99, 102, 241, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        /* Syntax Highlighting */
        .json-key {
            color: #a5d6ff;
            text-decoration: none;
            border: none;
            background: none;
        }

        .json-string {
            color: #7ee787;
        }

        .json-number {
            color: #f8dfa3;
        }

        .json-boolean {
            color: #ff7b72;
        }

        .json-null {
            color: #ff7b72;
        }

        .json-bracket {
            white-space: pre;
            display: inline;
        }

        .xml-tag {
            color: #79c0ff;
        }

        .xml-tag-name {
            color: #7ee787;
            font-weight: 500;
        }

        .xml-attr {
            color: #a5d6ff;
        }

        .xml-value {
            color: #ffa657;
        }

        .xml-text {
            color: var(--text-primary);
        }

        .xml-comment {
            color: #8b949e;
            font-style: italic;
        }

        /* Higher-contrast syntax colors on light (cream) theme */
        body.theme-light .json-key {
            color: #1d4ed8;
        }

        body.theme-light .json-string {
            color: #166534;
        }

        body.theme-light .json-number {
            color: #b45309;
        }

        body.theme-light .json-boolean,
        body.theme-light .json-null {
            color: #b91c1c;
        }

        body.theme-light .xml-tag {
            color: #1d4ed8;
        }

        body.theme-light .xml-tag-name {
            color: #166534;
        }

        body.theme-light .xml-attr {
            color: #0369a1;
        }

        body.theme-light .xml-value {
            color: #b45309;
        }

        body.theme-light .xml-comment {
            color: #6b7280;
        }

        /* Collapsible Nodes */
        .collapsible-node {
            position: relative;
        }

        .node-toggle {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0 0.25rem;
            margin-right: 0.25rem;
            font-size: 0.75rem;
            transition: all 0.2s ease;
            display: inline-block;
            width: 16px;
            text-align: center;
        }

        .node-toggle:hover {
            color: var(--primary-light);
        }

        .node-content {
            margin-left: 1.5rem;
            border-left: 1px solid rgba(148, 163, 184, 0.1);
            padding-left: 0.75rem;
            display: inline-block;
            vertical-align: top;
        }

        .node-content.collapsed {
            display: none;
        }

        .node-collapsed-indicator {
            color: var(--text-muted);
            font-style: italic;
        }

        /* Path Copy Mode */
        .path-copy-mode .json-key,
        .path-copy-mode .xml-tag-name {
            cursor: pointer;
            position: relative;
        }

        .path-copy-mode .json-key:hover,
        .path-copy-mode .xml-tag-name:hover {
            background: rgba(99, 102, 241, 0.2);
            border-radius: 3px;
            padding: 0 4px;
            margin: 0 -4px;
        }

        .json-path-display {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--accent);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            max-width: 400px;
            word-wrap: break-word;
        }

        .json-path-display.active {
            display: block;
            animation: slideInUp 0.3s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Status Messages */
        .status-message {
            padding: 1.25rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9375rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            backdrop-filter: blur(10px);
            border: 1px solid;
            animation: toastSlideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideInScale {
            from {
                opacity: 0;
                transform: translateY(10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .status-error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.15) 100%);
            border-color: rgba(239, 68, 68, 0.5);
            color: #fca5a5;
        }

        .status-success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(5, 150, 105, 0.15) 100%);
            border-color: rgba(16, 185, 129, 0.5);
            color: #6ee7b7;
        }

        .status-success::before {
            content: 'âœ“';
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
            animation: wiggle 0.5s ease-in-out;
        }

        .status-warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(217, 119, 6, 0.15) 100%);
            border-color: rgba(245, 158, 11, 0.5);
            color: #fcd34d;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.5);
            border-radius: 5px;
            border: 2px solid rgba(15, 23, 42, 0.9);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.7);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .logo-text {
                font-size: 1.5rem;
            }

            .format-options {
                grid-template-columns: 1fr;
            }

            .editor-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .action-buttons {
                flex-direction: column;
            }

            .button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        /* Tooltips are rendered fixed so they are not clipped by parent overflow
           and will always appear above the quick-action bar. */
        .tooltip .tooltiptext {
            visibility: hidden;
            background: linear-gradient(135deg, rgba(51, 65, 85, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            text-align: center;
            border-radius: 8px;
            padding: 0.5rem 0.875rem;
            position: fixed; /* fixed prevents clipping by overflow parents */
            z-index: 1100; /* above quick-action-bar (100) and other UI layers */
            opacity: 0;
            transition: opacity 0.18s ease, transform 0.18s ease;
            font-size: 0.8125rem;
            white-space: nowrap;
            border: 1px solid rgba(99, 102, 241, 0.3);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.45);
            pointer-events: none;
            transform-origin: bottom center;
            /* default offscreen; will be positioned on hover via data attributes or JS fallback */
            left: 0;
            top: 0;
            will-change: transform, opacity;
        }

        /* Visible state: we'll compute final translate via inline style set on hover (JS) or fall back to this */
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(-8px) scale(1);
        }

        /* Search Bar */
        .search-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            padding: 0.625rem 2.5rem 0.625rem 1rem;
            background: rgba(15, 23, 42, 0.6);
            border: 1.5px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: rgba(99, 102, 241, 0.6);
            background: rgba(15, 23, 42, 0.8);
            box-shadow: 
                0 0 0 4px rgba(99, 102, 241, 0.1),
                0 8px 24px rgba(99, 102, 241, 0.15);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        .search-stats {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .highlight-match {
            background-color: rgba(245, 158, 11, 0.3);
            border-radius: 2px;
            padding: 0 2px;
        }

        .highlight-current {
            background-color: rgba(245, 158, 11, 0.6);
            border-radius: 2px;
            padding: 0 2px;
        }

        /* Stats Display */
        .stats-display {
            font-size: 0.75rem;
            color: var(--text-secondary);
            padding: 0.5rem 0;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Indent Control */
        .indent-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .indent-control select {
            padding: 0.375rem 0.5rem;
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            font-size: 0.875rem;
            cursor: pointer;
        }

        .indent-control select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* File input hidden */
        .file-input-hidden {
            display: none;
        }

        /* Drag and drop indicator */
        .drag-over {
            border-color: var(--primary) !important;
            background: rgba(99, 102, 241, 0.05) !important;
        }

        /* Compare Mode Styles */
        .compare-mode-toggle {
            margin-bottom: 1rem;
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(51, 65, 85, 0.8);
            transition: 0.3s;
            border-radius: 24px;
            border: 1px solid var(--border);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .compare-container {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
        }

        .compare-container::-webkit-scrollbar {
            height: 12px;
        }

        .compare-container::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 6px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .compare-container::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.6);
            border-radius: 6px;
            border: 2px solid rgba(15, 23, 42, 0.8);
        }

        .compare-container::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.8);
        }

        .compare-box {
            flex: 0 0 calc(50% - 0.5rem);
            min-width: 450px;
            max-width: 600px;
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .compare-box:hover {
            border-color: rgba(99, 102, 241, 0.3);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(99, 102, 241, 0.1);
        }

        @media (max-width: 1024px) {
            .compare-box {
                flex: 0 0 100%;
                max-width: 100%;
                min-width: 300px;
            }
        }

        .compare-box-header {
            background: rgba(51, 65, 85, 0.5);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .compare-box-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        .compare-box-content {
            padding: 1.5rem;
            flex: 1;
            overflow: auto;
        }

        .add-compare-btn {
            background: rgba(16, 185, 129, 0.2);
            border: 1px dashed var(--secondary);
            color: var(--secondary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .add-compare-btn:hover {
            background: rgba(16, 185, 129, 0.3);
            border-style: solid;
        }

        .remove-compare-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 0.375rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1rem;
        }

        .remove-compare-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .compare-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Compression Stats */
        .compression-stats {
            margin-top: 1rem;
            padding: 0.875rem;
            background: rgba(51, 65, 85, 0.4);
            border-radius: 8px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            font-size: 0.8125rem;
        }

        .compression-stats-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .compression-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(140px, 100%), 1fr));
            gap: 0.75rem;
        }

        .compression-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .compression-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
        }

        .compression-value {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.9375rem;
        }

        .compression-savings {
            color: var(--secondary);
            font-weight: 700;
        }

        /* Schema Panel */
        .schema-panel {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(51, 65, 85, 0.4);
            border-radius: 8px;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        .schema-panel .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .schema-panel .panel-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .schema-panel .code-input {
            min-height: 150px;
            max-height: 300px;
        }

        /* Developer Tools */
        .tool-tab {
            padding: 0.75rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px 8px 0 0;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .tool-tab:hover {
            background: rgba(51, 65, 85, 0.6);
            color: var(--text-primary);
        }

        .tool-tab.active {
            background: rgba(99, 102, 241, 0.2);
            border-bottom-color: transparent;
            color: var(--primary-light);
        }

        .dev-tool-content {
            display: none;
        }

        .dev-tool-content.active {
            display: block;
        }

        .tool-section {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            transition: all 0.3s ease;
        }

        .tool-section:hover {
            background: rgba(30, 41, 59, 0.5);
            border-color: rgba(99, 102, 241, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .tool-section h3 {
            color: var(--primary-light);
            margin-bottom: var(--space-lg);
            font-size: 1.125rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        /* Consistent Button Groups */
        .button-group {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
            align-items: center;
            justify-content: flex-start;
        }

        .button-group-vertical {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        /* Consistent Input Groups */
        .input-group {
            display: flex;
            gap: var(--space-md);
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .input-group label {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            user-select: none;
        }

        .input-group input[type="number"],
        .input-group input[type="text"],
        .input-group select {
            padding: var(--space-sm) var(--space-md);
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: all 0.2s ease;
            height: var(--input-height);
        }

        .input-group input[type="number"]:focus,
        .input-group input[type="text"]:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(15, 23, 42, 0.95);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .input-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        /* Output Boxes */
        .output-box {
            margin-top: var(--space-lg);
            padding: var(--space-lg);
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            font-family: 'JetBrains Mono', monospace;
            word-break: break-all;
            min-height: 60px;
            transition: all 0.3s ease;
        }

        .output-box:empty::before {
            content: 'Output will appear here...';
            color: var(--text-muted);
            font-style: italic;
        }

        body.theme-light .output-box {
            background: #ffffff;
            border-color: rgba(148, 163, 184, 0.55);
            color: #111827;
        }

        body.theme-light .status-toolbar {
            background: #ffffff !important;
            border-color: rgba(148, 163, 184, 0.55) !important;
        }

        body.theme-light .scope-select {
            background: #ffffff !important;
            color: #111827 !important;
            border-color: rgba(148, 163, 184, 0.55) !important;
        }

        body.theme-light select,
        body.theme-light input[type="text"],
        body.theme-light input[type="number"],
        body.theme-light input[type="file"],
        body.theme-light textarea {
            background-color: #ffffff !important;
            color: #111827 !important;
            border-color: rgba(148, 163, 184, 0.55) !important;
        }

        /* URL Loader Modal */
        .url-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .url-modal.active {
            display: flex;
        }

        .url-modal-content {
            background: var(--bg-secondary);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .url-modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .url-input {
            width: 100%;
            padding: 0.75rem;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(71, 85, 105, 0.5);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .url-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .url-modal-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }

        .diff-added {
            background-color: rgba(16, 185, 129, 0.2);
            border-left: 3px solid var(--secondary);
            padding-left: 0.5rem;
        }

        .diff-removed {
            background-color: rgba(239, 68, 68, 0.2);
            border-left: 3px solid var(--danger);
            padding-left: 0.5rem;
        }

        .diff-modified {
            background-color: rgba(245, 158, 11, 0.2);
            border-left: 3px solid var(--warning);
            padding-left: 0.5rem;
        }

        /* Floating Scroll to Top Button */
        .floating-help {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 54px;
            height: 54px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 
                0 8px 24px rgba(102, 126, 234, 0.4),
                0 0 0 0 rgba(102, 126, 234, 0.4);
            animation: pulse 2s infinite;
            z-index: 9998;
            transition: all 0.3s ease;
            pointer-events: auto;
        }
        
        @media (max-width: 768px) {
            .floating-help {
                bottom: 1rem;
                right: 1rem;
                width: 48px;
                height: 48px;
                font-size: 1.3rem;
            }
        }

        .floating-help:hover {
            transform: scale(1.1) translateY(-4px);
            box-shadow: 
                0 12px 32px rgba(102, 126, 234, 0.6),
                0 0 0 0 rgba(102, 126, 234, 0.4);
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 
                    0 8px 24px rgba(102, 126, 234, 0.4),
                    0 0 0 0 rgba(102, 126, 234, 0.4);
            }
            50% {
                box-shadow: 
                    0 8px 24px rgba(102, 126, 234, 0.6),
                    0 0 0 20px rgba(102, 126, 234, 0);
            }
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Focus Visible Enhancement */
        *:focus-visible {
            outline: 2px solid rgba(99, 102, 241, 0.6);
            outline-offset: 2px;
        }

        /* Selection Color */
        ::selection {
            background: rgba(99, 102, 241, 0.3);
            color: var(--text-primary);
        }

        /* Smooth Transitions */
        * {
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Professional Card Badges */
        .feature-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 0.5rem;
        }

        /* Enhanced Scrollbar for Code Areas */
        .code-input::-webkit-scrollbar,
        .code-output::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        .code-input::-webkit-scrollbar-track,
        .code-output::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 6px;
        }

        .code-input::-webkit-scrollbar-thumb,
        .code-output::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.4) 0%, rgba(168, 85, 247, 0.4) 100%);
            border-radius: 6px;
            border: 2px solid rgba(15, 23, 42, 0.8);
        }

        .code-input::-webkit-scrollbar-thumb:hover,
        .code-output::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.6) 0%, rgba(168, 85, 247, 0.6) 100%);
        }

        /* Enhanced Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Premium Badge for Features */
        .premium-indicator {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #78350f;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.625rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.4);
        }

        /* Quick Action Bar - Sticky and Prominent */
        .quick-action-bar {
            position: fixed;
            top: 182px;
            left: 0;
            right: 0;
            z-index: 100;
            background: linear-gradient(135deg, rgba(51, 65, 85, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            padding: 1rem 1.5rem;
            margin-bottom: 0;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(99, 102, 241, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            animation: slideDown 0.3s ease-out;
            max-height: none;
            overflow-x: auto;
            overflow-y: visible;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .quick-action-bar .button {
            margin: 0;
            flex-shrink: 0;
            font-size: 0.9rem;
            padding: 0.875rem 1.25rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .quick-action-bar .button-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: scale(1.05);
            font-weight: 700;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
            }
            50% {
                box-shadow: 0 4px 24px rgba(102, 126, 234, 0.6);
            }
        }

        .quick-action-divider {
            width: 1px;
            height: 32px;
            background: rgba(148, 163, 184, 0.3);
            flex-shrink: 0;
        }

        .quick-action-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quick-action-label::before {
            content: 'âš¡';
            font-size: 1rem;
        }

        body.theme-light .quick-action-bar {
            background: rgba(249, 245, 238, 0.98);
            border-color: rgba(15, 23, 42, 0.08);
            box-shadow: 0 10px 24px rgba(148, 163, 184, 0.25);
        }

        body.theme-light .quick-action-label {
            color: #374151;
        }

        /* Improved Code Input with Better Visual Feedback */
        .code-input {
            width: 100%;
            min-height: 400px;
            background: rgba(15, 23, 42, 0.6);
            border: 1.5px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            resize: vertical;
            transition: all 0.3s ease;
            white-space: pre-wrap;
            word-wrap: break-word;
            tab-size: 4;
        }

        .code-input:focus {
            outline: none;
            border-color: rgba(99, 102, 241, 0.6);
            background: rgba(15, 23, 42, 0.9);
            box-shadow: 
                0 0 0 4px rgba(99, 102, 241, 0.1),
                0 8px 24px rgba(99, 102, 241, 0.15);
        }

        .code-input:hover:not(:focus) {
            border-color: rgba(99, 102, 241, 0.3);
            background: rgba(15, 23, 42, 0.75);
        }

        .code-input::placeholder {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        /* Enhanced Panel Content Padding */
        .panel-content {
            padding: 1.5rem;
            flex: 1;
            overflow: auto;
            position: relative;
        }

        /* Better Button Grouping */
        .action-buttons {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .action-buttons .button {
            flex: 0 1 auto;
            white-space: nowrap;
        }

        /* ========================================
           COMPREHENSIVE RESPONSIVE IMPROVEMENTS
        ======================================== */

        /* Tablet Devices */
        @media (max-width: 1024px) {
            :root {
                --space-xl: 1.5rem;
                --space-2xl: 2rem;
            }

            .tool-section {
                padding: var(--space-lg);
            }

            .quick-action-bar {
                padding: var(--space-md) var(--space-lg);
            }

            .button {
                font-size: 0.875rem;
                padding: 0.65rem 1rem;
            }
        }

        /* Mobile Devices */
        @media (max-width: 768px) {
            :root {
                --space-lg: 1rem;
                --space-xl: 1.25rem;
                --space-2xl: 1.5rem;
            }

            .container {
                padding: var(--space-md);
            }

            .tool-section {
                padding: var(--space-md);
                margin-bottom: var(--space-md);
            }

            .tool-section h3 {
                font-size: 1rem;
                margin-bottom: var(--space-md);
            }

            .editor-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-md);
            }

            .editor-title {
                font-size: 1.25rem;
            }

            .quick-action-bar {
                padding: var(--space-md);
                gap: var(--space-sm);
                position: relative;
                top: auto;
            }

            .quick-action-label {
                display: none;
            }

            .quick-action-divider {
                display: none;
            }

            .button-group {
                width: 100%;
            }

            .button-group .button {
                flex: 1 1 auto;
                min-width: fit-content;
            }

            .input-group {
                flex-direction: column;
                align-items: stretch;
                gap: var(--space-sm);
            }

            .input-group label {
                width: 100%;
            }

            .input-group input[type="number"],
            .input-group input[type="text"],
            .input-group select {
                width: 100%;
            }

            .button {
                font-size: 0.875rem;
                padding: 0.75rem 1rem;
                justify-content: center;
            }

            .code-input,
            .code-output {
                font-size: 0.8rem;
                padding: var(--space-sm);
            }

            .panel-header {
                padding: var(--space-md);
            }

            .panel-content {
                padding: var(--space-md);
            }

            .editor-grid {
                grid-template-columns: 1fr;
                gap: var(--space-md);
            }

            .playground-grid {
                grid-template-columns: 1fr;
                gap: var(--space-md);
            }

            /* Stack buttons vertically on mobile */
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }

            .action-buttons .button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Small Mobile Devices */
        @media (max-width: 480px) {
            :root {
                --space-md: 0.75rem;
                --space-lg: 0.875rem;
                --space-xl: 1rem;
            }

            .header-wrapper {
                padding: var(--space-sm) var(--space-md);
            }

            .logo-text {
                font-size: 1rem;
            }

            .tool-section {
                padding: var(--space-sm) var(--space-md);
            }

            .tool-section h3 {
                font-size: 0.95rem;
            }

            .button {
                font-size: 0.8rem;
                padding: 0.625rem 0.875rem;
                height: auto;
                min-height: 2.5rem;
            }

            .code-input,
            .code-output {
                font-size: 0.75rem;
                line-height: 1.5;
                min-height: 300px;
            }

            .quick-action-bar {
                padding: var(--space-sm);
            }

            .output-box {
                padding: var(--space-md);
                font-size: 0.8rem;
            }

            /* Ensure input fields are readable */
            input[type="text"],
            input[type="number"],
            select,
            textarea {
                font-size: 16px !important; /* Prevents zoom on iOS */
            }
        }

        /* Print Styles */
        @media print {
            .header,
            .back-button,
            .button,
            .quick-action-bar,
            .advanced-tools-panel {
                display: none !important;
            }

            .code-output,
            .output-box {
                border: 1px solid #000;
                page-break-inside: avoid;
            }

            body {
                background: white;
                color: black;
            }
        }

    </style>
</head>
<body class="theme-dark">
    <!-- Sticky Navigation Header -->
    <header class="header">
        <div class="header-wrapper">
            <div class="header-left">
                <div class="logo" onclick="showHome()">
                    <img src="logo.png" alt="DevPro Toolkit Logo">
                </div>
                <div class="logo-text" onclick="showHome()">DevPro Toolkit</div>
            </div>
            
            <nav>
                <ul class="nav-menu" id="navMenu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" onclick="showHome(); return false;">
                            <span class="nav-icon">ðŸ </span>
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="nav-item nav-dropdown">
                        <a href="#" class="nav-link" onclick="toggleDropdown(event, 'formatters-dropdown'); return false;">
                            <span class="nav-icon">âœ¨</span>
                            <span>Formatters</span>
                            <span style="margin-left: 0.25rem; font-size: 0.7rem;">â–¼</span>
                        </a>
                        <div class="dropdown-menu" id="formatters-dropdown">
                            <a href="#" onclick="showEditor('json'); closeAllDropdowns(); return false;">JSON Beautifier</a>
                            <a href="#" onclick="showEditor('xml'); closeAllDropdowns(); return false;">XML Beautifier</a>
                            <a href="#" onclick="showEditor('sql-builder'); closeAllDropdowns(); return false;">SQL Builder</a>
                        </div>
                    </li>
                    <li class="nav-item nav-dropdown">
                        <a href="#" class="nav-link" onclick="toggleDropdown(event, 'converters-dropdown'); return false;">
                            <span class="nav-icon">ðŸ”„</span>
                            <span>Converters</span>
                            <span style="margin-left: 0.25rem; font-size: 0.7rem;">â–¼</span>
                        </a>
                        <div class="dropdown-menu" id="converters-dropdown">
                            <a href="#" onclick="showEditor('converter'); closeAllDropdowns(); return false;">Format Converter</a>
                            <a href="#" onclick="showEditor('color'); closeAllDropdowns(); return false;">Color Converter</a>
                            <a href="#" onclick="showEditor('timestamp'); closeAllDropdowns(); return false;">Timestamp Converter</a>
                        </div>
                    </li>
                    <li class="nav-item nav-dropdown">
                        <a href="#" class="nav-link" onclick="toggleDropdown(event, 'tools-dropdown'); return false;">
                            <span class="nav-icon">ðŸ› ï¸</span>
                            <span>Dev Tools</span>
                            <span style="margin-left: 0.25rem; font-size: 0.7rem;">â–¼</span>
                        </a>
                        <div class="dropdown-menu" id="tools-dropdown">
                            <a href="#" onclick="showEditor('crypto'); closeAllDropdowns(); return false;">Text Encryption</a>
                            <a href="#" onclick="showEditor('devtools'); closeAllDropdowns(); return false;">Developer Tools</a>
                            <a href="#" onclick="showEditor('regex'); closeAllDropdowns(); return false;">Regex Tester</a>
                            <a href="#" onclick="showEditor('cron'); closeAllDropdowns(); return false;">Cron Builder</a>
                            <a href="#" onclick="showEditor('network'); closeAllDropdowns(); return false;">Network Tools</a>
                            <a href="#" onclick="showEditor('git-menu'); closeAllDropdowns(); return false;">Git Assistant</a>
                            <a href="#" onclick="showEditor('docker-menu'); closeAllDropdowns(); return false;">Docker Helper</a>
                            <a href="#" onclick="showEditor('api-mocker'); closeAllDropdowns(); return false;">API Mocker</a>
                            <a href="#" onclick="showEditor('log-analyzer'); closeAllDropdowns(); return false;">Log Analyzer</a>
                            <a href="#" onclick="showEditor('subnet-calc'); closeAllDropdowns(); return false;">Subnet Calculator</a>
                            <a href="#" onclick="showEditor('ascii'); closeAllDropdowns(); return false;">Image Compressor</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showEditor('pdf'); return false;">
                            <span class="nav-icon">ï¿½</span>
                            <span>PDF Tools</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showEditor('playground'); return false;">
                            <span class="nav-icon">âš¡</span>
                            <span>Playground</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <button class="theme-toggle" type="button" onclick="toggleTheme()" aria-label="Toggle color theme">
                <span class="theme-toggle-icon">â—</span>
                <span class="theme-toggle-label">Dark</span>
            </button>

            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">â˜°</button>
        </div>
    </header>

    <div class="container">
        <!-- Home Section -->
        <div id="home-section" class="content-section active">
            <div class="section-header">
                <h1 class="section-title">Welcome to DevPro Toolkit</h1>
                <p class="section-subtitle">
                    All-in-one developer toolkit - beautify, convert, code & test in your browser.
                    100% Client-Side â€¢ Zero Data Storage â€¢ Completely Private ðŸ”’
                </p>
            </div>

            <div id="home-page" class="home-page">
            <div class="format-options">
                <div class="format-card" onclick="showEditor('json')">
                    <div class="format-icon">{ }</div>
                    <div class="format-title">JSON Beautifier</div>
                    <div class="format-description">
                        Format, validate, and beautify your JSON data with syntax highlighting and collapsible nodes
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('xml')">
                    <div class="format-icon">&lt;/&gt;</div>
                    <div class="format-title">XML Beautifier</div>
                    <div class="format-description">
                        Format, validate, and beautify your XML documents with intelligent indentation and highlighting
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('crypto')">
                    <div class="format-icon">ðŸ”</div>
                    <div class="format-title">Text Encryption</div>
                    <div class="format-description">
                        Encrypt and decrypt text using AES-256 or Base64 encoding - completely secure and client-side
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('converter')">
                    <div class="format-icon">ðŸ”„</div>
                    <div class="format-title">Format Converter</div>
                    <div class="format-description">
                        Convert between JSON, XML, YAML, CSV, SQL, TypeScript and more - 14+ format transformations
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('devtools')">
                    <div class="format-icon">ðŸ› ï¸</div>
                    <div class="format-title">Developer Tools</div>
                    <div class="format-description">
                        Password generator, hash tools, JWT decoder, UUID generator, HTTP utilities and more
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('playground')">
                    <div class="format-icon">âš¡</div>
                    <div class="format-title">Code Playground</div>
                    <div class="format-description">
                        Write and run code in JavaScript, Python, SQL, TypeScript, HTML/CSS - all in your browser
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('color')">
                    <div class="format-icon">ðŸŽ¨</div>
                    <div class="format-title">Color Converter</div>
                    <div class="format-description">
                        Convert between HEX, RGB, HSL color formats - palette generator and picker included
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('regex')">
                    <div class="format-icon">ðŸ”</div>
                    <div class="format-title">Regex Tester</div>
                    <div class="format-description">
                        Test regular expressions with live highlighting, match groups, and code snippet generation
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('timestamp')">
                    <div class="format-icon">â±ï¸</div>
                    <div class="format-title">Unix Timestamp</div>
                    <div class="format-description">
                        Convert timestamps to dates, multiple timezones, relative time calculator
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('cron')">
                    <div class="format-icon">â°</div>
                    <div class="format-title">Cron Builder</div>
                    <div class="format-description">
                        Visual cron expression generator with validation and next execution preview
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('image-compressor')">
                    <div class="format-icon">ï¿½ï¸</div>
                    <div class="format-title">Image Compressor</div>
                    <div class="format-description">
                        Compress & convert images - reduce file size, resize, and change formats (JPG/PNG/WebP)
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('pdf')">
                    <div class="format-icon">ðŸ“„</div>
                    <div class="format-title">PDF Toolset</div>
                    <div class="format-description">
                        Split, merge, compress PDFs - rotate pages, extract images, and edit metadata
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('network')">
                    <div class="format-icon">ðŸŒ</div>
                    <div class="format-title">Network Tools</div>
                    <div class="format-description">
                        HTTP client, WebSocket tester, GraphQL playground, cURL generator - complete API toolkit
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('git-menu')">
                    <div class="format-icon">ðŸ”€</div>
                    <div class="format-title">Git Assistant</div>
                    <div class="format-description">
                        Command reference, branch visualizer, .gitignore templates - Git workflow helpers
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('docker-menu')">
                    <div class="format-icon">ðŸ³</div>
                    <div class="format-title">Docker Helper</div>
                    <div class="format-description">
                        Run command builder, configuration presets, Compose file generator - DevOps made easy
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('api-mocker')">
                    <div class="format-icon">ðŸ”§</div>
                    <div class="format-title">API Mocker</div>
                    <div class="format-description">
                        Mock REST APIs, simulate delays & errors, test frontend without backend
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('log-analyzer')">
                    <div class="format-icon">ðŸ“Š</div>
                    <div class="format-title">Log Analyzer</div>
                    <div class="format-description">
                        Parse logs, filter by level, regex search, extract stack traces with timeline
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('sql-builder')">
                    <div class="format-icon">ðŸ—ƒï¸</div>
                    <div class="format-title">SQL Query Builder</div>
                    <div class="format-description">
                        Visual no-code SQL builder, query templates, formatter with execution support
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('subnet-calc')">
                    <div class="format-icon">ðŸŒ</div>
                    <div class="format-title">Subnet Calculator</div>
                    <div class="format-description">
                        Calculate IPv4/IPv6 subnets with detailed network information and IP availability
                    </div>
                </div>
            </div>
        </div>
        <!-- End Home Section -->

        <!-- Formatters Section -->
        <div id="formatters-section" class="content-section">
            <div class="section-header">
                <h1 class="section-title">Formatters & Beautifiers</h1>
                <p class="section-subtitle">
                    Format and beautify your code with syntax highlighting and validation
                </p>
            </div>
            <div class="format-options">
                <div class="format-card" onclick="showEditor('json')">
                    <div class="format-icon">{ }</div>
                    <div class="format-title">JSON Beautifier</div>
                    <div class="format-description">
                        Format, validate, and beautify your JSON data with syntax highlighting and collapsible nodes
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('xml')">
                    <div class="format-icon">&lt;/&gt;</div>
                    <div class="format-title">XML Beautifier</div>
                    <div class="format-description">
                        Format, validate, and beautify your XML documents with intelligent indentation
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('sql-builder')">
                    <div class="format-icon">ðŸ—ƒï¸</div>
                    <div class="format-title">SQL Query Builder</div>
                    <div class="format-description">
                        Visual no-code SQL builder, query templates, formatter with execution support
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('subnet-calc')">
                    <div class="format-icon">ðŸŒ</div>
                    <div class="format-title">Subnet Calculator</div>
                    <div class="format-description">
                        Calculate IPv4/IPv6 subnets with detailed network information and IP availability
                    </div>
                </div>
            </div>
        </div>
        <!-- End Formatters Section -->

        <!-- Converters Section -->
        <div id="converters-section" class="content-section">
            <div class="section-header">
                <h1 class="section-title">Format Converters</h1>
                <p class="section-subtitle">
                    Convert between different data formats seamlessly
                </p>
            </div>
            <div class="format-options">
                <div class="format-card" onclick="showEditor('converter')">
                    <div class="format-icon">ðŸ”„</div>
                    <div class="format-title">Format Converter</div>
                    <div class="format-description">
                        Convert between JSON, XML, YAML, CSV, SQL, TypeScript and more
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('color')">
                    <div class="format-icon">ðŸŽ¨</div>
                    <div class="format-title">Color Converter</div>
                    <div class="format-description">
                        Convert between HEX, RGB, HSL color formats - palette generator included
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('timestamp')">
                    <div class="format-icon">â±ï¸</div>
                    <div class="format-title">Unix Timestamp</div>
                    <div class="format-description">
                        Convert timestamps to dates, multiple timezones, relative time calculator
                    </div>
                </div>
            </div>
        </div>
        <!-- End Converters Section -->

        <!-- Developer Tools Section -->
        <div id="tools-section" class="content-section">
            <div class="section-header">
                <h1 class="section-title">Developer Tools</h1>
                <p class="section-subtitle">
                    Essential utilities for modern development workflows
                </p>
            </div>
            <div class="format-options">
                <div class="format-card" onclick="showEditor('crypto')">
                    <div class="format-icon">ðŸ”</div>
                    <div class="format-title">Text Encryption</div>
                    <div class="format-description">
                        Encrypt and decrypt text using AES-256 or Base64 encoding
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('devtools')">
                    <div class="format-icon">ðŸ› ï¸</div>
                    <div class="format-title">Developer Tools</div>
                    <div class="format-description">
                        Password generator, hash tools, JWT decoder, UUID generator
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('regex')">
                    <div class="format-icon">ðŸ”</div>
                    <div class="format-title">Regex Tester</div>
                    <div class="format-description">
                        Test regular expressions with live highlighting and match groups
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('cron')">
                    <div class="format-icon">â°</div>
                    <div class="format-title">Cron Builder</div>
                    <div class="format-description">
                        Visual cron expression generator with validation
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('network')">
                    <div class="format-icon">ðŸŒ</div>
                    <div class="format-title">Network Tools</div>
                    <div class="format-description">
                        HTTP client, WebSocket tester, GraphQL playground
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('git-menu')">
                    <div class="format-icon">ðŸ”€</div>
                    <div class="format-title">Git Assistant</div>
                    <div class="format-description">
                        Command reference, branch visualizer, .gitignore templates
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('docker-menu')">
                    <div class="format-icon">ðŸ³</div>
                    <div class="format-title">Docker Helper</div>
                    <div class="format-description">
                        Run command builder, configuration presets
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('api-mocker')">
                    <div class="format-icon">ðŸ”§</div>
                    <div class="format-title">API Mocker</div>
                    <div class="format-description">
                        Mock REST APIs, simulate delays & errors
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('log-analyzer')">
                    <div class="format-icon">ðŸ“Š</div>
                    <div class="format-title">Log Analyzer</div>
                    <div class="format-description">
                        Parse logs, filter by level, regex search
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('ascii')">
                    <div class="format-icon">ï¿½ï¸</div>
                    <div class="format-title">Image Compressor</div>
                    <div class="format-description">
                        Compress & convert images - reduce file size, resize, and change formats
                    </div>
                </div>
            </div>
        </div>
        <!-- End Developer Tools Section -->

        <!-- PDF Tools Section -->
        <div id="pdf-section" class="content-section">
            <div class="section-header">
                <h1 class="section-title">PDF Toolset</h1>
                <p class="section-subtitle">
                    Complete PDF management tools - all client-side and secure
                </p>
            </div>
            <div class="format-options">
                <div class="format-card" onclick="showEditor('pdf')">
                    <div class="format-icon">ðŸ“„</div>
                    <div class="format-title">PDF Toolset</div>
                    <div class="format-description">
                        Split, merge, compress PDFs - rotate pages, extract images
                    </div>
                </div>
            </div>
        </div>
        <!-- End PDF Tools Section -->

        <!-- Playground Section -->
        <div id="playground-section" class="content-section">
            <div class="section-header">
                <h1 class="section-title">Code Playground</h1>
                <p class="section-subtitle">
                    Write, run, and test code directly in your browser
                </p>
            </div>
            <div class="format-options">
                <div class="format-card" onclick="showEditor('playground')">
                    <div class="format-icon">âš¡</div>
                    <div class="format-title">Code Playground</div>
                    <div class="format-description">
                        Write and run JavaScript, Python, SQL, TypeScript, HTML/CSS
                    </div>
                </div>
            </div>
        </div>
        <!-- End Playground Section -->

        <!-- JSON Editor -->
        <div id="json-page" class="editor-page">

            <div class="editor-header">
                <div class="editor-title">
                    <span>{ }</span>
                    <span>JSON Beautifier</span>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <div class="indent-control">
                        <label for="json-indent">Indent:</label>
                        <select id="json-indent">
                            <option value="1">1 space (Compact)</option>
                            <option value="2" selected>2 spaces</option>
                            <option value="4">4 spaces</option>
                            <option value="tab">Tab</option>
                        </select>
                    </div>
                </div>
            </div>
            <!-- Back to Home button always visible above quick actions -->
            <div style="margin: 0 0 1rem 0; display: flex; justify-content: flex-end;">
                <button class="back-button" onclick="showHome()">
                    <span>â†</span>
                    <span>Back to Home</span>
                </button>
            </div>

            <!-- Quick Action Bar -->
            <div class="quick-action-bar">
                <span class="quick-action-label">Quick Actions</span>
                <button class="button button-primary" onclick="beautifyJSON()">
                    <span>âœ¨</span>
                    <span>Beautify</span>
                </button>
                <button class="button button-secondary" onclick="clearInput('json')">
                    <span>ðŸ—‘ï¸</span>
                    <span>Clear</span>
                </button>
                <button class="button button-secondary" onclick="copyOutput('json')">
                    <span>ðŸ“‹</span>
                    <span>Copy Output</span>
                </button>
                <button class="button button-secondary" onclick="downloadOutput('json')">
                    <span>ðŸ’¾</span>
                    <span>Download</span>
                </button>
                <div class="quick-action-divider"></div>
                <button class="button button-secondary" onclick="minifyJSON()">
                    <span>ðŸ“¦</span>
                    <span>Minify</span>
                </button>
                <button class="button button-secondary" onclick="validateJSON()">
                    <span>âœ“</span>
                    <span>Validate</span>
                </button>
                <button class="button button-secondary" onclick="loadSampleJSON()">
                    <span>ðŸ“„</span>
                    <span>Sample</span>
                </button>
                <div class="quick-action-divider"></div>
                <button class="button button-secondary" onclick="toggleAdvancedTools('json')" id="json-advanced-toggle">
                    <span>âš™ï¸</span>
                    <span>More Tools</span>
                    <span style="margin-left: 0.25rem;">â–¼</span>
                </button>
            </div>

            <!-- Advanced Tools Section (Collapsible) -->
            <div id="json-advanced-tools" class="advanced-tools-panel" style="display: none;">
                <div style="display: flex; gap: 0.75rem; flex-wrap: wrap; padding: 1rem; background: rgba(30, 41, 59, 0.4); border-radius: 12px; border: 1px solid rgba(99, 102, 241, 0.2);">
                    <button class="button button-secondary" onclick="toggleCompactJSON()">
                        <span>âŠŸ</span>
                        <span>Toggle Compact</span>
                    </button>
                    <button class="button button-secondary" onclick="toggleSchemaPanel()">
                        <span>ðŸ“‹</span>
                        <span>Validate with Schema</span>
                    </button>
                    <button class="button button-secondary" onclick="autoFormat('json')">
                        <span>ðŸŽ¯</span>
                        <span>Auto Format</span>
                    </button>
                    <button class="button button-secondary" onclick="showUrlLoader('json')">
                        <span>ðŸŒ</span>
                        <span>Load from URL</span>
                    </button>
                    <button class="button button-secondary" onclick="quickConvert('json')">
                        <span>ðŸ”„</span>
                        <span>Convert to...</span>
                    </button>
                </div>
            </div>

            <div class="compare-mode-toggle">
                <label class="toggle-switch">
                    <input type="checkbox" id="json-compare-mode" onchange="toggleCompareMode('json')">
                    <span class="toggle-slider"></span>
                </label>
                <span style="font-size: 0.875rem; color: var(--text-secondary);">Compare Mode</span>
            </div>

            <div id="json-editor-grid" class="editor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Input</div>
                        <div class="panel-actions">
                            <input type="file" id="json-file-input" accept=".json,.txt" class="file-input-hidden">
                            <button class="icon-button tooltip" onclick="document.getElementById('json-file-input').click()">
                                <span>ðŸ“</span>
                                <span class="tooltiptext">Upload File</span>
                            </button>
                            <button class="icon-button tooltip" onclick="loadSampleJSON()">
                                <span>ðŸ“‹</span>
                                <span class="tooltiptext">Load Sample</span>
                            </button>
                            <button class="icon-button tooltip" onclick="clearInput('json')" title="Clear">
                                <span>ðŸ—‘ï¸</span>
                                <span class="tooltiptext">Clear Input</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <textarea 
                            id="json-input" 
                            class="code-input" 
                            placeholder='ðŸ“ Paste your JSON here or click "Sample" to try it out...

Pro Tips:
â€¢ Use Ctrl+A to select all text
â€¢ Use Ctrl+V to paste
â€¢ Click "Clear" to start fresh
â€¢ Use "Beautify" to format your JSON

Example:
{"name":"John","age":30,"city":"New York"}'></textarea>
                        <div class="stats-display" id="json-input-stats"></div>
                    </div>
                </div>

                <div class="editor-panel" id="json-output-panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            Output
                            <button class="resize-toggle" onclick="toggleOutputSize('json')" id="json-resize-btn">Maximize â›¶</button>
                        </div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="downloadOutput('json')">
                                <span>ðŸ’¾</span>
                                <span class="tooltiptext">Download JSON</span>
                            </button>
                            <button class="icon-button tooltip" onclick="copyOutput('json')">
                                <span>ðŸ“‹</span>
                                <span class="tooltiptext">Copy to Clipboard</span>
                            </button>
                            <button class="icon-button tooltip" onclick="togglePathMode('json')" id="json-path-btn">
                                <span>ðŸ”—</span>
                                <span class="tooltiptext">Enable Path Copy Mode</span>
                            </button>
                            <button class="icon-button tooltip" onclick="toggleExpandAll('json')">
                                <span>âš¡</span>
                                <span class="tooltiptext">Expand/Collapse All</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="search-container" id="json-search-container" style="display: none;">
                            <input type="text" id="json-search" class="search-input" placeholder="Search in output... (Enter: next, Shift+Enter: prev, Ctrl+F: focus)" onkeyup="searchInOutput('json', event)">
                            <span class="search-icon">ðŸ”</span>
                            <div id="json-search-stats" class="search-stats"></div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem; flex-wrap: wrap; align-items: center;">
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="json-search-regex" style="cursor: pointer;">
                                    <span>Regex</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="json-search-case" style="cursor: pointer;">
                                    <span>Case</span>
                                </label>
                                <select id="json-search-scope" class="scope-select" style="padding: 0.25rem 0.5rem; font-size: 0.75rem; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
                                    <option value="all">All</option>
                                    <option value="keys">Keys Only</option>
                                    <option value="values">Values Only</option>
                                </select>
                            </div>
                            <div class="action-buttons" style="margin-top: 0.5rem; gap: 0.5rem;">
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="prevMatch('json')">Prev â‡§</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="nextMatch('json')">Next â‡©</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="clearSearch('json')">Clear</button>
                            </div>
                        </div>
                        <div id="json-output" class="code-output">
                            <div style="color: var(--text-muted); text-align: center; padding: 3rem 2rem;">
                                <div style="font-size: 2.5rem; margin-bottom: 1rem;">âœ¨</div>
                                <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">Your formatted JSON will appear here...</div>
                                <div style="font-size: 0.9rem; opacity: 0.7;">ðŸ’¡ Paste JSON in the input box and click "Beautify" to format it!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schema Validation Panel -->
            <div id="json-schema-panel" class="schema-panel" style="display: none;">
                <div class="panel-header">
                    <div class="panel-title">JSON Schema</div>
                    <button class="icon-button" onclick="toggleSchemaPanel()">âœ•</button>
                </div>
                <div class="panel-content">
                    <textarea id="json-schema-input" class="code-input" placeholder='Enter JSON Schema or click "Load Sample Schema"...'></textarea>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <button class="button button-secondary" onclick="loadSampleSchema()">
                            <span>ðŸ“„</span>
                            <span>Load Sample Schema</span>
                        </button>
                        <button class="button button-primary" onclick="validateWithSchema()">
                            <span>âœ“</span>
                            <span>Validate Against Schema</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Compression Stats Display -->
            <div id="json-compression-stats" class="compression-stats" style="display: none;"></div>

            <div id="json-compare-container" class="compare-container" style="display: none;">
                <div class="compare-box" id="json-compare-0">
                    <div class="compare-box-header">
                        <div class="compare-box-title">Box 1</div>
                    </div>
                    <div class="compare-box-content">
                        <textarea id="json-compare-input-0" class="code-input" placeholder="Enter JSON..." style="min-height: 300px;"></textarea>
                        <div class="compare-actions">
                            <button class="button button-primary" onclick="beautifyCompare('json', 0)" style="flex: 1;">
                                <span>âœ¨</span>
                                <span>Beautify</span>
                            </button>
                        </div>
                        <div id="json-compare-output-0" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                    </div>
                </div>
            </div>

            <button id="json-add-compare-btn" class="add-compare-btn" style="display: none; margin-top: 1rem;" onclick="addCompareBox('json')">
                <span>âž•</span>
                <span>Add Comparison Box</span>
            </button>
            
            <!-- Path Display Tooltip -->
            <div id="json-path-display" class="json-path-display"></div>
        </div>

        <!-- XML Editor -->
        <div id="xml-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>&lt;/&gt;</span>
                    <span>XML Beautifier</span>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <div class="indent-control">
                        <label for="xml-indent">Indent:</label>
                        <select id="xml-indent">
                            <option value="2" selected>2 spaces</option>
                            <option value="4">4 spaces</option>
                            <option value="tab">Tab</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Quick Action Bar -->
            <div class="quick-action-bar">
                <span class="quick-action-label">Quick Actions</span>
                <button class="button button-secondary" onclick="showHome()">
                    <span>ðŸ </span>
                    <span>Home</span>
                </button>
                <button class="button button-primary" onclick="beautifyXML()">
                    <span>âœ¨</span>
                    <span>Beautify</span>
                </button>
                <button class="button button-secondary" onclick="clearInput('xml')">
                    <span>ðŸ—‘ï¸</span>
                    <span>Clear</span>
                </button>
                <button class="button button-secondary" onclick="copyOutput('xml')">
                    <span>ðŸ“‹</span>
                    <span>Copy Output</span>
                </button>
                <button class="button button-secondary" onclick="downloadOutput('xml')">
                    <span>ðŸ’¾</span>
                    <span>Download</span>
                </button>
                <div class="quick-action-divider"></div>
                <button class="button button-secondary" onclick="minifyXML()">
                    <span>ðŸ“¦</span>
                    <span>Minify</span>
                </button>
                <button class="button button-secondary" onclick="validateXML()">
                    <span>âœ“</span>
                    <span>Validate</span>
                </button>
                <button class="button button-secondary" onclick="loadSampleXML()">
                    <span>ðŸ“„</span>
                    <span>Sample</span>
                </button>
            </div>

            <div class="compare-mode-toggle">
                <label class="toggle-switch">
                    <input type="checkbox" id="xml-compare-mode" onchange="toggleCompareMode('xml')">
                    <span class="toggle-slider"></span>
                </label>
                <span style="font-size: 0.875rem; color: var(--text-secondary);">Compare Mode</span>
            </div>

            <div id="xml-editor-grid" class="editor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Input</div>
                        <div class="panel-actions">
                            <input type="file" id="xml-file-input" accept=".xml,.txt" class="file-input-hidden">
                            <button class="icon-button tooltip" onclick="document.getElementById('xml-file-input').click()">
                                <span>ðŸ“</span>
                                <span class="tooltiptext">Upload File</span>
                            </button>
                            <button class="icon-button tooltip" onclick="loadSampleXML()">
                                <span>ðŸ“‹</span>
                                <span class="tooltiptext">Load Sample</span>
                            </button>
                            <button class="icon-button tooltip" onclick="clearInput('xml')" title="Clear">
                                <span>ðŸ—‘ï¸</span>
                                <span class="tooltiptext">Clear Input</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <textarea 
                            id="xml-input" 
                            class="code-input" 
                            placeholder='ðŸ“ Paste your XML here or click "Sample" to try it out...

Pro Tips:
â€¢ Use Ctrl+A to select all text
â€¢ Use Ctrl+V to paste
â€¢ Click "Clear" to start fresh
â€¢ Use "Beautify" to format your XML

Example:
<root><person><name>John</name><age>30</age></person></root>'></textarea>
                        <div class="stats-display" id="xml-input-stats"></div>
                    </div>
                </div>

                <div class="editor-panel" id="xml-output-panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            Output
                            <button class="resize-toggle" onclick="toggleOutputSize('xml')" id="xml-resize-btn">Maximize â›¶</button>
                        </div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="downloadOutput('xml')">
                                <span>ðŸ’¾</span>
                                <span class="tooltiptext">Download XML</span>
                            </button>
                            <button class="icon-button tooltip" onclick="copyOutput('xml')">
                                <span>ðŸ“‹</span>
                                <span class="tooltiptext">Copy to Clipboard</span>
                            </button>
                            <button class="icon-button tooltip" onclick="toggleExpandAll('xml')">
                                <span>âš¡</span>
                                <span class="tooltiptext">Expand/Collapse All</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="search-container" id="xml-search-container" style="display: none;">
                            <input type="text" id="xml-search" class="search-input" placeholder="Search in output... (Enter: next, Shift+Enter: prev, Ctrl+F: focus)" onkeyup="searchInOutput('xml', event)">
                            <span class="search-icon">ðŸ”</span>
                            <div id="xml-search-stats" class="search-stats"></div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem; flex-wrap: wrap; align-items: center;">
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="xml-search-regex" style="cursor: pointer;">
                                    <span>Regex</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="xml-search-case" style="cursor: pointer;">
                                    <span>Case</span>
                                </label>
                                <select id="xml-search-scope" class="scope-select" style="padding: 0.25rem 0.5rem; font-size: 0.75rem; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
                                    <option value="all">All</option>
                                    <option value="keys">Tags Only</option>
                                    <option value="values">Content Only</option>
                                </select>
                            </div>
                            <div class="action-buttons" style="margin-top: 0.5rem; gap: 0.5rem;">
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="prevMatch('xml')">Prev â‡§</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="nextMatch('xml')">Next â‡©</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="clearSearch('xml')">Clear</button>
                            </div>
                        </div>
                        <div id="xml-output" class="code-output">
                            <div style="color: var(--text-muted); text-align: center; padding: 3rem 2rem;">
                                <div style="font-size: 2.5rem; margin-bottom: 1rem;">âœ¨</div>
                                <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">Your formatted XML will appear here...</div>
                                <div style="font-size: 0.9rem; opacity: 0.7;">ðŸ’¡ Paste XML in the input box and click "Beautify" to format it!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="button button-primary" onclick="beautifyXML()">
                    <span>âœ¨</span>
                    <span>Beautify XML</span>
                </button>
                <button class="button button-secondary" onclick="minifyXML()">
                    <span>ðŸ“¦</span>
                    <span>Minify XML</span>
                </button>
                <button class="button button-secondary" onclick="validateXML()">
                    <span>âœ“</span>
                    <span>Validate Only</span>
                </button>
                <button class="button button-secondary" onclick="autoFormat('xml')">
                    <span>ðŸŽ¯</span>
                    <span>Auto Format</span>
                </button>
                <button class="button button-secondary" onclick="showUrlLoader('xml')">
                    <span>ðŸŒ</span>
                    <span>Load from URL</span>
                </button>
                <button class="button button-secondary" onclick="quickConvert('xml')">
                    <span>ðŸ”„</span>
                    <span>Convert to...</span>
                </button>
            </div>

            <!-- Compression Stats Display -->
            <div id="xml-compression-stats" class="compression-stats" style="display: none;"></div>

            <div id="xml-compare-container" class="compare-container" style="display: none;">
                <div class="compare-box" id="xml-compare-0">
                    <div class="compare-box-header">
                        <div class="compare-box-title">Box 1</div>
                    </div>
                    <div class="compare-box-content">
                        <textarea id="xml-compare-input-0" class="code-input" placeholder="Enter XML..." style="min-height: 300px;"></textarea>
                        <div class="compare-actions">
                            <button class="button button-primary" onclick="beautifyCompare('xml', 0)" style="flex: 1;">
                                <span>âœ¨</span>
                                <span>Beautify</span>
                            </button>
                        </div>
                        <div id="xml-compare-output-0" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                    </div>
                </div>
            </div>

            <button id="xml-add-compare-btn" class="add-compare-btn" style="display: none; margin-top: 1rem;" onclick="addCompareBox('xml')">
                <span>âž•</span>
                <span>Add Comparison Box</span>
            </button>
        </div>

        <!-- Encryption/Decryption Page -->
        <div id="crypto-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>ðŸ”</span>
                    <span>Text Encryption & Decryption</span>
                </div>
                <button class="back-button" onclick="showHome()">
                    <span>â†</span>
                    <span>Back to Home</span>
                </button>
            </div>

            <div class="editor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Input Text</div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="clearInput('crypto')">
                                <span>ðŸ—‘ï¸</span>
                                <span class="tooltiptext">Clear Input</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <textarea 
                            id="crypto-input" 
                            class="code-input" 
                            placeholder="Enter your text to encrypt or decrypt..."></textarea>
                        <div class="stats-display" id="crypto-input-stats"></div>
                        
                        <div style="margin-top: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">
                                ðŸ”‘ Secret Key / Password
                            </label>
                            <input 
                                type="password" 
                                id="crypto-key" 
                                class="code-input" 
                                placeholder="Enter your secret key..."
                                style="min-height: auto; padding: 0.75rem; font-family: 'Inter', sans-serif;">
                            <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-muted);">
                                ðŸ’¡ Remember this key - you'll need it to decrypt your data
                            </div>
                        </div>

                        <div style="margin-top: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">
                                Algorithm
                            </label>
                            <select id="crypto-algorithm" style="width: 100%; padding: 0.75rem; border-radius: 8px; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); font-size: 0.875rem; cursor: pointer;">
                                <option value="aes">AES-256 (Advanced Encryption Standard)</option>
                                <option value="base64">Base64 (Encoding Only - Not Secure)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Output</div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="downloadOutput('crypto')">
                                <span>ðŸ’¾</span>
                                <span class="tooltiptext">Download Output</span>
                            </button>
                            <button class="icon-button tooltip" onclick="copyOutput('crypto')">
                                <span>ðŸ“‹</span>
                                <span class="tooltiptext">Copy to Clipboard</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div id="crypto-output" class="code-output">
                            <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                                Your encrypted/decrypted text will appear here...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="button button-primary" onclick="encryptText()">
                    <span>ðŸ”’</span>
                    <span>Encrypt</span>
                </button>
                <button class="button button-secondary" onclick="decryptText()">
                    <span>ðŸ”“</span>
                    <span>Decrypt</span>
                </button>
            </div>

            <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(30, 41, 59, 0.6); border: 1px solid var(--border); border-radius: 12px;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: var(--warning);">
                    <span style="font-size: 1.25rem;">âš ï¸</span>
                    <span style="font-weight: 600; font-size: 0.9375rem;">Important Security Notes</span>
                </div>
                <ul style="list-style: none; padding-left: 0; color: var(--text-secondary); font-size: 0.875rem; line-height: 1.8;">
                    <li style="margin-bottom: 0.5rem;">âœ“ All encryption happens locally in your browser - no data is sent to any server</li>
                    <li style="margin-bottom: 0.5rem;">âœ“ Keep your secret key safe - without it, you cannot decrypt your data</li>
                    <li style="margin-bottom: 0.5rem;">âœ“ Base64 is NOT encryption - it's just encoding and can be easily reversed</li>
                    <li style="margin-bottom: 0.5rem;">âœ“ AES-256 is military-grade encryption when used with a strong password</li>
                    <li style="margin-bottom: 0.5rem;">âœ“ Use a strong, unique password with letters, numbers, and symbols</li>
                </ul>
            </div>
        </div>

        <!-- Format Converter Page -->
        <div id="converter-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>ðŸ”„</span>
                    <span>Format Converter</span>
                </div>
                <button class="back-button" onclick="showHome()">
                    <span>â†</span>
                    <span>Back to Home</span>
                </button>
            </div>

        <div style="margin-bottom: 1.5rem; text-align: center;">
            <div style="display: inline-block; background: rgba(30, 41, 59, 0.6); padding: 1rem 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">
                    Select Conversion Type
                </label>
                <select id="conversion-type" onchange="updateConversionLabels()" style="width: 100%; min-width: 300px; padding: 0.75rem; border-radius: 8px; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); font-size: 0.875rem; cursor: pointer;">
                    <optgroup label="XML â†” JSON">
                        <option value="json-to-xml">JSON â†’ XML</option>
                        <option value="xml-to-json">XML â†’ JSON</option>
                    </optgroup>
                    <optgroup label="YAML Conversions">
                        <option value="json-to-yaml">JSON â†’ YAML</option>
                        <option value="yaml-to-json">YAML â†’ JSON</option>
                        <option value="xml-to-yaml">XML â†’ YAML</option>
                        <option value="yaml-to-xml">YAML â†’ XML</option>
                    </optgroup>
                    <optgroup label="CSV Conversions">
                        <option value="json-to-csv">JSON â†’ CSV</option>
                        <option value="csv-to-json">CSV â†’ JSON</option>
                        <option value="xml-to-csv">XML â†’ CSV</option>
                        <option value="csv-to-xml">CSV â†’ XML</option>
                    </optgroup>
                    <optgroup label="Code Generation">
                        <option value="json-to-typescript">JSON â†’ TypeScript Interface</option>
                        <option value="json-to-csharp">JSON â†’ C# Class</option>
                        <option value="json-to-java">JSON â†’ Java Class</option>
                        <option value="json-to-python">JSON â†’ Python Dataclass</option>
                        <option value="json-to-go">JSON â†’ Go Struct</option>
                        <option value="json-to-schema">JSON â†’ JSON Schema</option>
                    </optgroup>
                    <optgroup label="Database & Tables">
                        <option value="json-to-sql">JSON â†’ SQL INSERT</option>
                        <option value="csv-to-sql">CSV â†’ SQL INSERT</option>
                        <option value="json-to-html">JSON â†’ HTML Table</option>
                        <option value="csv-to-html">CSV â†’ HTML Table</option>
                        <option value="xml-to-html">XML â†’ HTML Table</option>
                        <option value="json-to-markdown">JSON â†’ Markdown Table</option>
                        <option value="csv-to-markdown">CSV â†’ Markdown Table</option>
                    </optgroup>
                    <optgroup label="Configuration Files">
                        <option value="json-to-ini">JSON â†’ INI File</option>
                        <option value="ini-to-json">INI â†’ JSON</option>
                    </optgroup>
                    <optgroup label="URL & Web">
                        <option value="json-to-query">JSON â†’ URL Query String</option>
                        <option value="query-to-json">URL Query String â†’ JSON</option>
                    </optgroup>
                </select>
            </div>
        </div>

        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title" id="converter-input-label">JSON Input</div>
                    <div class="panel-actions">
                        <input type="file" id="converter-file-input" accept=".json,.xml,.yaml,.yml,.csv,.ini,.txt" class="file-input-hidden">
                        <button class="icon-button tooltip" onclick="document.getElementById('converter-file-input').click()">
                            <span>ðŸ“</span>
                            <span class="tooltiptext">Upload File</span>
                        </button>
                        <button class="icon-button tooltip" onclick="clearInput('converter')">
                            <span>ðŸ—‘ï¸</span>
                            <span class="tooltiptext">Clear Input</span>
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <textarea 
                        id="converter-input" 
                        class="code-input" 
                        placeholder='Paste your data here...'></textarea>
                    <div class="stats-display" id="converter-input-stats"></div>
                </div>
            </div>

            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title" id="converter-output-label">XML Output</div>
                    <div class="panel-actions">
                        <button class="icon-button tooltip" onclick="downloadConverterOutput()">
                            <span>ðŸ’¾</span>
                            <span class="tooltiptext">Download</span>
                        </button>
                        <button class="icon-button tooltip" onclick="copyConverterOutput()">
                            <span>ðŸ“‹</span>
                            <span class="tooltiptext">Copy to Clipboard</span>
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <div id="converter-output" class="code-output">
                        <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                            Your converted output will appear here...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="button button-primary" onclick="performConversion()">
                <span>ðŸ”„</span>
                <span>Convert</span>
            </button>
            <button class="button button-secondary" onclick="swapConversion()">
                <span>â‡„</span>
                <span>Swap Direction</span>
            </button>
        </div>

        <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(30, 41, 59, 0.6); border: 1px solid var(--border); border-radius: 12px;">
            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: var(--primary-light);">
                <span style="font-size: 1.25rem;">âœ¨</span>
                <span style="font-weight: 600; font-size: 0.9375rem;">Supported Conversions (25+ formats)</span>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; color: var(--text-secondary); font-size: 0.8125rem;">
                <div>âœ“ JSON â†” XML</div>
                <div>âœ“ JSON â†” YAML</div>
                <div>âœ“ XML â†” YAML</div>
                <div>âœ“ JSON â†” CSV</div>
                <div>âœ“ XML â†” CSV</div>
                <div>âœ“ JSON â†’ SQL</div>
                <div>âœ“ CSV â†’ SQL</div>
                <div>âœ“ JSON â†’ TypeScript</div>
                <div>âœ“ JSON â†’ JSON Schema</div>
                <div>âœ“ JSON â†” INI</div>
                <div>âœ“ JSON â†’ HTML Table</div>
                <div>âœ“ CSV â†’ HTML Table</div>
                <div>âœ“ JSON â†’ Markdown</div>
                <div>âœ“ JSON â†” URL Query</div>
            </div>
        </div>
    </div>
        <!-- Developer Tools Page -->
        <div id="devtools-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>ðŸ› ï¸</span>
                    <span>Developer Tools</span>
                </div>
                <button class="back-button" onclick="showHome()">
                    <span>â†</span>
                    <span>Back to Home</span>
                </button>
            </div>

            <div style="padding: 0 1.5rem;">
                <!-- Tool Tabs -->
                <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; flex-wrap: wrap; border-bottom: 2px solid var(--border); padding-bottom: 0.5rem;">
                    <button class="tool-tab active" onclick="switchDevTool('security')">ðŸ”’ Security Tools</button>
                    <button class="tool-tab" onclick="switchDevTool('web')">ðŸŒ Web Tools</button>
                </div>

                <!-- Security Tools Tab -->
                <div id="security-tools" class="dev-tool-content active">
                <!-- Password Generator -->
                <div class="tool-section">
                    <h3>ðŸ”‘ Password Generator</h3>
                    <div class="input-group">
                        <label>
                            <input type="number" id="pwd-length" value="16" min="8" max="64" style="width: 80px;">
                            <span>Length</span>
                        </label>
                        <label>
                            <input type="checkbox" id="pwd-upper" checked>
                            <span>Uppercase</span>
                        </label>
                        <label>
                            <input type="checkbox" id="pwd-lower" checked>
                            <span>Lowercase</span>
                        </label>
                        <label>
                            <input type="checkbox" id="pwd-numbers" checked>
                            <span>Numbers</span>
                        </label>
                        <label>
                            <input type="checkbox" id="pwd-symbols" checked>
                            <span>Symbols</span>
                        </label>
                    </div>
                    <div class="button-group">
                        <button class="button button-primary" onclick="generatePassword()">Generate Password</button>
                        <button class="button button-secondary" onclick="copyToClipboard(document.getElementById('pwd-output').innerText)">ðŸ“‹ Copy</button>
                    </div>
                    <div id="pwd-output" class="output-box" style="display: none;"></div>
                </div>

                <!-- Hash Generator -->
                <div class="tool-section">
                    <h3>ðŸ” Hash Generator</h3>
                    <textarea id="hash-input" class="code-input" style="min-height: 120px;" placeholder="Enter text to hash..."></textarea>
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-secondary" onclick="generateHash('MD5')">MD5</button>
                        <button class="button button-secondary" onclick="generateHash('SHA-1')">SHA-1</button>
                        <button class="button button-secondary" onclick="generateHash('SHA-256')">SHA-256</button>
                        <button class="button button-secondary" onclick="generateHash('SHA-512')">SHA-512</button>
                    </div>
                    <div id="hash-output" class="output-box" style="display: none;"></div>
                </div>

                <!-- UUID Generator -->
                <div class="tool-section">
                    <h3>ðŸ†” UUID Generator</h3>
                    <div class="button-group">
                        <button class="button button-primary" onclick="generateUUID()">Generate UUID v4</button>
                        <button class="button button-secondary" onclick="generateBulkUUID()">Generate 10 UUIDs</button>
                    </div>
                    <div id="uuid-output" class="output-box" style="display: none;"></div>
                </div>

                <!-- JWT Decoder -->
                <div class="tool-section">
                    <h3>ðŸŽ« JWT Decoder</h3>
                    <textarea id="jwt-input" class="code-input" style="min-height: 120px;" placeholder="Paste JWT token here..."></textarea>
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-primary" onclick="decodeJWT()">Decode JWT</button>
                        <button class="button button-secondary" onclick="document.getElementById('jwt-input').value=''; document.getElementById('jwt-output').style.display='none';">Clear</button>
                    </div>
                    <div id="jwt-output" class="output-box" style="display: none;"></div>
                </div>
            </div>

            <!-- Web Tools Tab -->
            <div id="web-tools" class="dev-tool-content">
                <!-- HTTP Status Codes -->
                <div class="tool-section">
                    <h3>ðŸ“¡ HTTP Status Code Reference</h3>
                    <input type="text" id="status-search" placeholder="Search status code or description..." class="input-group" style="width: 100%; padding: var(--space-sm) var(--space-md); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-primary); height: var(--input-height);" oninput="filterStatusCodes()">
                    <div id="status-codes" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: var(--space-sm); max-height: 400px; overflow-y: auto; margin-top: var(--space-md);"></div>
                </div>

                <!-- User-Agent Parser -->
                <div class="tool-section">
                    <h3>ðŸ–¥ï¸ User-Agent Parser</h3>
                    <textarea id="ua-input" class="code-input" style="min-height: 100px;" placeholder="Paste User-Agent string..."></textarea>
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-primary" onclick="parseUserAgent()">Parse User-Agent</button>
                        <button class="button button-secondary" onclick="loadCurrentUA()">Use My Browser</button>
                    </div>
                    <div id="ua-output" class="output-box" style="display: none;"></div>
                </div>

                <!-- URL Parser -->
                <div class="tool-section">
                    <h3>ðŸ”— URL Parser</h3>
                    <input type="text" id="url-parse-input" placeholder="Enter URL to parse..." style="width: 100%; padding: var(--space-sm) var(--space-md); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-primary); height: var(--input-height);">
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-primary" onclick="parseURL()">Parse URL</button>
                        <button class="button button-secondary" onclick="document.getElementById('url-parse-input').value=''; document.getElementById('url-parse-output').style.display='none';">Clear</button>
                    </div>
                    <div id="url-parse-output" class="output-box" style="display: none;"></div>
                </div>

                <!-- Base64 Image -->
                <div class="tool-section">
                    <h3>ðŸ–¼ï¸ Base64 Image Encoder/Decoder</h3>
                    <input type="file" id="image-file" accept="image/*" style="margin-bottom: var(--space-md); padding: var(--space-sm); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-primary); width: 100%;">
                    <div class="button-group">
                        <button class="button button-primary" onclick="encodeImage()">Encode to Base64</button>
                    </div>
                    <textarea id="base64-input" class="code-input" style="min-height: 120px; margin-top: var(--space-lg);" placeholder="Or paste Base64 string to decode..."></textarea>
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-secondary" onclick="decodeImage()">Decode Base64 to Image</button>
                    </div>
                    <div id="image-output" style="margin-top: var(--space-lg); display: none;"></div>
                </div>

                <!-- Certificate Decoder -->
                <div class="tool-section">
                    <h3>ðŸ” Certificate Decoder (X.509)</h3>
                    <textarea id="cert-input" class="code-input" style="min-height: 140px;" placeholder="Paste X.509 certificate (PEM format: -----BEGIN CERTIFICATE-----)"></textarea>
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-primary" onclick="decodeCertificate()">Decode Certificate</button>
                    </div>
                    <div id="cert-output" style="margin-top: var(--space-lg); display: none;"></div>
                </div>

                <!-- SSL Certificate Checker -->
                <div class="tool-section">
                    <h3>ðŸ”’ SSL Certificate Checker</h3>
                    <input type="text" id="ssl-domain" placeholder="Enter domain (e.g., google.com)" style="width: 100%; padding: var(--space-sm) var(--space-md); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-primary); height: var(--input-height);">
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-primary" onclick="checkSSL()">Check SSL</button>
                    </div>
                    <div id="ssl-output" style="margin-top: var(--space-lg); display: none;"></div>
                </div>

                <!-- IP Address Lookup -->
                <div class="tool-section">
                    <h3>ðŸŒ IP Address Lookup</h3>
                    <div style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-md);">
                        <input type="text" id="ip-address" placeholder="Enter IP or leave blank" style="flex: 1; padding: var(--space-sm) var(--space-md); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-primary); height: var(--input-height);">
                        <button class="button button-secondary" onclick="getMyIP()">My IP</button>
                    </div>
                    <div class="button-group">
                        <button class="button button-primary" onclick="lookupIP()">Lookup IP</button>
                    </div>
                    <div id="ip-output" style="margin-top: var(--space-lg); display: none;"></div>
                </div>

                <!-- Domain/DNS Lookup -->
                <div class="tool-section">
                    <h3>ðŸ” Domain/DNS Lookup</h3>
                    <input type="text" id="dns-domain" placeholder="Enter domain (e.g., example.com)" style="width: 100%; padding: var(--space-sm) var(--space-md); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-primary); height: var(--input-height);">
                    <div class="button-group" style="margin-top: var(--space-md);">
                        <button class="button button-primary" onclick="lookupDNS()">Lookup DNS</button>
                    </div>
                    <div id="dns-output" style="margin-top: var(--space-lg); display: none;"></div>
                </div>
            </div>
            </div> <!-- Close padding wrapper -->
        </div>
    </div>

        <!-- Code Playground -->
    <div id="playground-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>âš¡</span>
                <span>Code Playground</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>

        <div class="editor-container" style="display: block;">
            <!-- Language Selection -->
            <div class="status-toolbar" style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-lg); flex-wrap: wrap; background: rgba(15, 23, 42, 0.8); padding: var(--space-lg); border-radius: var(--radius-lg); border: 1px solid var(--border);">
                <button class="tool-tab active" onclick="switchPlayground('javascript')">JavaScript</button>
                <button class="tool-tab" onclick="switchPlayground('htmlcss')">HTML/CSS</button>
                <button class="tool-tab" onclick="switchPlayground('python')">Python</button>
                <button class="tool-tab" onclick="switchPlayground('sql')">SQL</button>
                <button class="tool-tab" onclick="switchPlayground('typescript')">TypeScript</button>
                <button class="tool-tab" onclick="switchPlayground('json')">JSON Query</button>
            </div>

            <!-- Code Editor & Output -->
            <div class="playground-grid">
                <!-- Editor Panel -->
                <div class="playground-panel">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                        <strong style="color: var(--primary-light); font-size: 1rem;">Code Editor</strong>
                        <div class="button-group">
                            <button class="button button-secondary" onclick="loadSample()" style="padding: 0.5rem 1rem; font-size: 0.875rem; height: auto;">ðŸ“ Sample</button>
                            <button class="button button-secondary" onclick="clearPlayground()" style="padding: 0.5rem 1rem; font-size: 0.875rem; height: auto;">ðŸ—‘ï¸ Clear</button>
                            <button class="button button-primary" onclick="runPlaygroundCode()" style="padding: 0.65rem 1.5rem; height: auto;">â–¶ Run</button>
                        </div>
                    </div>
                    <div class="playground-editor-wrapper">
                        <textarea id="playground-editor" class="code-input" spellcheck="false" placeholder="Write your code here..." style="min-height: 450px;"></textarea>
                        <div id="autocomplete-dropdown" style="display: none; position: absolute; background: #1f2937; border: 1px solid var(--border); border-radius: var(--radius-md); max-height: 200px; overflow-y: auto; z-index: 1000; box-shadow: 0 4px 6px rgba(0,0,0,0.3);"></div>
                    </div>
                </div>

                <!-- Output Panel -->
                <div class="playground-panel">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                        <strong style="color: var(--primary-light); font-size: 1rem;" id="output-label">Output</strong>
                        <button class="button button-secondary" onclick="clearOutput()" style="padding: 0.5rem 1rem; font-size: 0.875rem; height: auto;">Clear Output</button>
                    </div>
                    <div id="playground-output" style="min-height: 450px; padding: var(--space-lg); background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: var(--radius-md); overflow: auto;">
                        <div style="color: var(--text-muted); text-align: center; padding: 3rem 2rem;">
                            <div style="font-size: 2rem; margin-bottom: var(--space-md);">â–¶ï¸</div>
                            <div style="font-size: 1rem;">Click "Run" to execute your code...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Python Loading Notice -->
            <div id="python-notice" style="display: none; margin-top: var(--space-lg); padding: var(--space-lg); background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: var(--radius-md); color: #3b82f6;">
                â³ Loading Python environment (first time only, ~6MB)...
            </div>
        </div>
    </div>

    <!-- Color Converter Page -->
    <div id="color-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸŽ¨</span>
                <span>Color Converter & Picker</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Color Picker</div>
                </div>
                <div class="panel-content">
                    <input type="color" id="color-picker" value="#6366f1" oninput="updateColorFromPicker()" style="width: 100%; height: 180px; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 1rem;">
                    <div style="display: flex; gap: 0.5rem; align-items: center; margin-bottom: 0.75rem;">
                        <label style="min-width: 45px; font-size: 0.875rem; color: var(--text-secondary);">HEX</label>
                        <input type="text" id="color-hex" value="#6366f1" oninput="updateColorFromHex()" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                        <button onclick="copyColorValue('hex')" style="padding: 0.5rem 0.75rem; background: rgba(99, 102, 241, 0.2); border: 1px solid var(--primary); border-radius: 6px; color: var(--primary-light); cursor: pointer; font-size: 0.875rem;">Copy</button>
                    </div>
                    <div style="display: flex; gap: 0.5rem; align-items: center; margin-bottom: 0.75rem;">
                        <label style="min-width: 45px; font-size: 0.875rem; color: var(--text-secondary);">RGB</label>
                        <input type="text" id="color-rgb" value="rgb(99, 102, 241)" oninput="updateColorFromRgb()" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                        <button onclick="copyColorValue('rgb')" style="padding: 0.5rem 0.75rem; background: rgba(99, 102, 241, 0.2); border: 1px solid var(--primary); border-radius: 6px; color: var(--primary-light); cursor: pointer; font-size: 0.875rem;">Copy</button>
                    </div>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <label style="min-width: 45px; font-size: 0.875rem; color: var(--text-secondary);">HSL</label>
                        <input type="text" id="color-hsl" value="hsl(239, 84%, 67%)" oninput="updateColorFromHsl()" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                        <button onclick="copyColorValue('hsl')" style="padding: 0.5rem 0.75rem; background: rgba(99, 102, 241, 0.2); border: 1px solid var(--primary); border-radius: 6px; color: var(--primary-light); cursor: pointer; font-size: 0.875rem;">Copy</button>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Random Palette</div>
                </div>
                <div class="panel-content">
                    <button class="button button-primary" onclick="generatePalette()" style="width: 100%; margin-bottom: 1rem;">Generate Random Palette</button>
                    <div id="color-palette" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.5rem;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Regex Tester Page -->
    <div id="regex-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ”</span>
                <span>Regex Tester & Builder</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Pattern & Flags</div>
                </div>
                <div class="panel-content">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">Regex Pattern</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="text" id="regex-pattern" oninput="testRegex()" placeholder="Enter regex pattern (e.g., \d{3}-\d{3}-\d{4})" style="flex: 1; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.95rem;">
                            <button class="button button-secondary" onclick="escapeRegexPattern()" title="Escape special characters" style="padding: 0.75rem; font-size: 0.875rem;">
                                <span>âš¡ Escape</span>
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">Flags</label>
                        <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 0.35rem; cursor: pointer; padding: 0.5rem 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px;">
                                <input type="checkbox" id="flag-g" onchange="testRegex()" checked>
                                <span style="font-size: 0.85rem;"><strong>g</strong> - Global</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.35rem; cursor: pointer; padding: 0.5rem 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px;">
                                <input type="checkbox" id="flag-i" onchange="testRegex()">
                                <span style="font-size: 0.85rem;"><strong>i</strong> - Ignore Case</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.35rem; cursor: pointer; padding: 0.5rem 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px;">
                                <input type="checkbox" id="flag-m" onchange="testRegex()">
                                <span style="font-size: 0.85rem;"><strong>m</strong> - Multiline</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.35rem; cursor: pointer; padding: 0.5rem 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px;">
                                <input type="checkbox" id="flag-s" onchange="testRegex()">
                                <span style="font-size: 0.85rem;"><strong>s</strong> - Dotall</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.35rem; cursor: pointer; padding: 0.5rem 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px;">
                                <input type="checkbox" id="flag-u" onchange="testRegex()">
                                <span style="font-size: 0.85rem;"><strong>u</strong> - Unicode</span>
                            </label>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">Quick Patterns</label>
                        <select onchange="loadRegexPattern(this.value)" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                            <option value="">Select a common pattern...</option>
                            <option value="email">Email Address</option>
                            <option value="url">URL/Website</option>
                            <option value="phone">Phone Number (US)</option>
                            <option value="ipv4">IPv4 Address</option>
                            <option value="ipv6">IPv6 Address</option>
                            <option value="date">Date (YYYY-MM-DD)</option>
                            <option value="time">Time (HH:MM:SS)</option>
                            <option value="hex">Hex Color (#RGB)</option>
                            <option value="uuid">UUID</option>
                            <option value="digits">Digits Only</option>
                            <option value="alphanumeric">Alphanumeric</option>
                            <option value="splunk-timestamp">Splunk Timestamp</option>
                            <option value="splunk-ip">Splunk Extract IP</option>
                            <option value="splunk-field">Splunk Field Extraction</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">Test Text</label>
                        <textarea id="regex-test-text" oninput="testRegex()" placeholder="Enter or paste your test text here...

Example for Splunk logs:
2024-12-12 10:15:30 ERROR user=john.doe@company.com ip=192.168.1.100 status=failed
2024-12-12 10:16:45 INFO user=jane.smith@company.com ip=10.0.0.50 status=success" style="width: 100%; min-height: 150px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical; line-height: 1.6;"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Matches & Results</div>
                </div>
                <div class="panel-content">
                    <div id="regex-error" style="display: none; padding: 0.75rem; background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); border-radius: 6px; margin-bottom: 1rem; color: var(--danger); font-size: 0.875rem;"></div>
                    
                    <div id="regex-stats" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem; font-size: 0.875rem; color: var(--text-secondary);"></div>
                    
                    <div id="regex-highlighted" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; min-height: 150px; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.8; white-space: pre-wrap; word-wrap: break-word; margin-bottom: 1rem; max-height: 300px; overflow-y: auto;"></div>
                    
                    <div id="regex-matches" style="background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; max-height: 250px; overflow-y: auto; overflow-x: auto; font-size: 0.875rem; word-break: break-all;"></div>
                    
                    <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.8rem; color: var(--text-secondary); line-height: 1.6;">
                        <strong style="color: var(--primary-light);">ðŸ’¡ Splunk Tips:</strong><br>
                        â€¢ Use <code>rex</code> command: <code>| rex field=_raw "pattern"</code><br>
                        â€¢ For field extraction: Use named groups <code>(?&lt;fieldname&gt;...)</code><br>
                        â€¢ Test with <code>| regex</code> to filter events<br>
                        â€¢ Escape special chars: <code>\.  \(  \)  \[  \]  \*  \+  \?</code>
                    </div>
                </div>
            </div>
            
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Code Snippets</div>
                </div>
                <div class="panel-content">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem; margin-bottom: 0.75rem;">
                        <button class="button button-secondary" onclick="generateRegexSnippet('javascript')" style="padding: 0.65rem; font-size: 0.875rem;">JavaScript</button>
                        <button class="button button-secondary" onclick="generateRegexSnippet('python')" style="padding: 0.65rem; font-size: 0.875rem;">Python</button>
                        <button class="button button-secondary" onclick="generateRegexSnippet('java')" style="padding: 0.65rem; font-size: 0.875rem;">Java</button>
                        <button class="button button-secondary" onclick="generateRegexSnippet('splunk')" style="padding: 0.65rem; font-size: 0.875rem; background: rgba(234, 179, 8, 0.1); border-color: rgba(234, 179, 8, 0.3);">Splunk</button>
                    </div>
                    <pre id="regex-snippet" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; min-height: 200px; white-space: pre-wrap; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-muted); overflow-x: auto; line-height: 1.6;">Select a language to generate code snippet...</pre>
                    <button class="button button-primary" onclick="copyRegexSnippet()" style="margin-top: 0.75rem; width: 100%;">
                        <span>ðŸ“‹</span>
                        <span>Copy Code</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Unix Timestamp Page -->
    <div id="timestamp-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>â±ï¸</span>
                <span>Unix Timestamp Converter</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Timestamp â†’ Date</div>
                </div>
                <div class="panel-content">
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Current Timestamp</label>
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <input type="text" id="current-timestamp" readonly style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--primary-light); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; font-weight: 600;">
                        <button onclick="copyCurrentTimestamp()" class="button button-primary" style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">Copy</button>
                    </div>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Enter Timestamp</label>
                    <input type="number" id="timestamp-input" oninput="convertTimestamp()" placeholder="e.g., 1638360000" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Timezone</label>
                    <select id="timestamp-timezone" onchange="convertTimestamp()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                        <option value="UTC">UTC</option>
                        <option value="America/New_York">Eastern (US)</option>
                        <option value="America/Chicago">Central (US)</option>
                        <option value="America/Los_Angeles">Pacific (US)</option>
                        <option value="Europe/London">London</option>
                        <option value="Asia/Kolkata">India</option>
                        <option value="Asia/Tokyo">Tokyo</option>
                    </select>
                    <div id="timestamp-result" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; min-height: 120px; font-size: 0.875rem; color: var(--text-muted);">Enter a timestamp...</div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Date â†’ Timestamp</div>
                </div>
                <div class="panel-content">
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Select Date & Time</label>
                    <input type="datetime-local" id="date-input" onchange="convertDateToTimestamp()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                    <div id="date-timestamp-result" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; min-height: 120px; font-size: 0.875rem; color: var(--text-muted); margin-bottom: 1rem;">Select a date...</div>
                    <button onclick="copyConvertedTimestamp()" class="button button-primary" style="width: 100%;">Copy Timestamp</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cron Builder Page -->
    <div id="cron-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>â°</span>
                <span>Cron Expression Builder</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Build Expression</div>
                </div>
                <div class="panel-content">
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Presets</label>
                    <select onchange="loadCronPreset(this.value)" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                        <option value="">Select preset...</option>
                        <option value="* * * * *">Every minute</option>
                        <option value="0 * * * *">Every hour</option>
                        <option value="0 0 * * *">Daily at midnight</option>
                        <option value="0 9 * * 1-5">Weekdays at 9 AM</option>
                        <option value="0 0 * * 0">Weekly on Sunday</option>
                    </select>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.5rem; margin-bottom: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.75rem; color: var(--text-secondary); text-align: center;">Min</label>
                            <input type="text" id="cron-minute" value="*" oninput="updateCronExpression()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; text-align: center;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.75rem; color: var(--text-secondary); text-align: center;">Hour</label>
                            <input type="text" id="cron-hour" value="*" oninput="updateCronExpression()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; text-align: center;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.75rem; color: var(--text-secondary); text-align: center;">Day</label>
                            <input type="text" id="cron-day" value="*" oninput="updateCronExpression()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; text-align: center;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.75rem; color: var(--text-secondary); text-align: center;">Month</label>
                            <input type="text" id="cron-month" value="*" oninput="updateCronExpression()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; text-align: center;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.75rem; color: var(--text-secondary); text-align: center;">Week</label>
                            <input type="text" id="cron-weekday" value="*" oninput="updateCronExpression()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; text-align: center;">
                        </div>
                    </div>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Expression</label>
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <input type="text" id="cron-expression" readonly value="* * * * *" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--primary-light); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; font-weight: 600;">
                        <button onclick="copyCronExpression()" class="button button-primary" style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">Copy</button>
                    </div>
                    <div style="padding: 0.75rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px;">
                        <div id="cron-description" style="color: var(--primary-light); font-size: 0.875rem;">Runs every minute</div>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Next Executions</div>
                </div>
                <div class="panel-content">
                    <div id="cron-next-runs" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; min-height: 300px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Compressor Page -->
    <div id="image-compressor-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ï¿½ï¸</span>
                <span>Image Compressor & Converter</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Upload Image</div>
                </div>
                <div class="panel-content">
                    <!-- Drag & Drop Zone -->
                    <div id="image-drop-zone" style="border: 2px dashed var(--border); border-radius: 12px; padding: 3rem 2rem; text-align: center; cursor: pointer; transition: all 0.3s ease; background: rgba(99, 102, 241, 0.05);" onclick="document.getElementById('image-upload-input').click()">
                        <div style="font-size: clamp(2rem, 8vw, 3rem); margin-bottom: 1rem;">ðŸ“¤</div>
                        <div style="font-size: 1.1rem; color: var(--text-primary); margin-bottom: 0.5rem; font-weight: 600;">Drop image here or click to upload</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">Supports: JPG, PNG, WebP, GIF (Max 10MB)</div>
                    </div>
                    <input type="file" id="image-upload-input" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                    
                    <!-- Compression Settings -->
                    <div id="compression-settings" style="display: none; margin-top: 1.5rem;">
                        <h4 style="color: var(--primary-light); margin-bottom: 1rem; font-size: 0.95rem;">âš™ï¸ Compression Settings</h4>
                        
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Quality: <span id="quality-value">80</span>%</label>
                        <input type="range" id="quality-slider" min="1" max="100" value="80" oninput="updateQualityValue(this.value)" style="width: 100%; margin-bottom: 1rem;">
                        
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Output Format</label>
                        <select id="output-format" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                            <option value="original">Keep Original</option>
                            <option value="image/jpeg">JPEG</option>
                            <option value="image/png">PNG</option>
                            <option value="image/webp">WebP</option>
                        </select>
                        
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Resize (optional)</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 1rem;">
                            <input type="number" id="resize-width" placeholder="Width (px)" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                            <input type="number" id="resize-height" placeholder="Height (px)" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                        </div>
                        <label style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">
                            <input type="checkbox" id="keep-aspect-ratio" checked>
                            Keep aspect ratio
                        </label>
                        
                        <button class="button button-primary" onclick="compressImage()" style="width: 100%; padding: 0.75rem; font-size: 0.95rem; margin-bottom: 0.5rem;">ðŸš€ Compress & Convert</button>
                        <button class="button button-secondary" onclick="resetCompressor()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">ðŸ”„ Upload New Image</button>
                    </div>
                </div>
            </div>
            
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Preview & Download</div>
                </div>
                <div class="panel-content">
                    <!-- Original Image -->
                    <div id="original-preview" style="display: none;">
                        <h4 style="color: var(--text-secondary); margin-bottom: 0.5rem; font-size: 0.875rem;">Original Image</h4>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; text-align: center;">
                            <img id="original-image" style="max-width: 100%; max-height: 200px; border-radius: 6px;">
                            <div id="original-stats" style="margin-top: 0.75rem; font-size: 0.875rem; color: var(--text-secondary);"></div>
                        </div>
                    </div>
                    
                    <!-- Compressed Image -->
                    <div id="compressed-preview" style="display: none;">
                        <h4 style="color: var(--primary-light); margin-bottom: 0.5rem; font-size: 0.875rem;">Compressed Image</h4>
                        <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid var(--primary); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; text-align: center;">
                            <img id="compressed-image" style="max-width: 100%; max-height: 200px; border-radius: 6px;">
                            <div id="compressed-stats" style="margin-top: 0.75rem; font-size: 0.875rem; color: var(--text-primary);"></div>
                        </div>
                        
                        <!-- Size Savings -->
                        <div id="savings-display" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2)); border: 1px solid #10b981; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; text-align: center;"></div>
                        
                        <button class="button button-primary" onclick="downloadCompressedImage()" style="width: 100%; padding: 0.75rem; font-size: 0.95rem;">ðŸ’¾ Download Compressed Image</button>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="empty-preview" style="text-align: center; padding: 3rem 1rem; color: var(--text-muted);">
                        <div style="font-size: clamp(2rem, 8vw, 3rem); margin-bottom: 1rem; opacity: 0.5;">ðŸ–¼ï¸</div>
                        <div style="font-size: 0.95rem;">Upload an image to get started</div>
                        <div style="font-size: 0.875rem; margin-top: 0.5rem;">Your compressed image will appear here</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Tools Menu Page -->
    <div id="pdf-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ“„</span>
                <span>PDF Toolset</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="format-options" style="max-width: 900px; margin: 0 auto;">
            <div class="format-card" onclick="showPdfTool('pdf-split')">
                <div class="format-icon">âœ‚ï¸</div>
                <div class="format-title">Split & Extract</div>
                <div class="format-description">
                    Split PDF into pages or extract specific page ranges from your documents
                </div>
            </div>
            <div class="format-card" onclick="showPdfTool('pdf-merge')">
                <div class="format-icon">ðŸ”—</div>
                <div class="format-title">Merge & Combine</div>
                <div class="format-description">
                    Combine multiple PDF files into one - drag and drop to reorder pages
                </div>
            </div>
            <div class="format-card" onclick="showPdfTool('pdf-compress')">
                <div class="format-icon">ðŸ—œï¸</div>
                <div class="format-title">Compress & Optimize</div>
                <div class="format-description">
                    Reduce PDF file size while maintaining quality - optimize for web or print
                </div>
            </div>
            <div class="format-card" onclick="showPdfTool('pdf-tools')">
                <div class="format-icon">ðŸ› ï¸</div>
                <div class="format-title">Advanced Tools</div>
                <div class="format-description">
                    Rotate, delete pages, extract images, and edit PDF metadata
                </div>
            </div>
            <div class="format-card" onclick="showPdfTool('pdf-editor')">
                <div class="format-icon">âœï¸</div>
                <div class="format-title">PDF Editor</div>
                <div class="format-description">
                    Add text, annotations, signatures, and shapes to your PDF documents
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Split Page -->
    <div id="pdf-split-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>âœ‚ï¸</span>
                <span>PDF Split & Extract</span>
            </div>
            <button class="back-button" onclick="showPdfMenu()">
                <span>â†</span>
                <span>Back to PDF Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Upload PDF</div>
                </div>
                <div class="panel-content">
                    <input type="file" id="pdf-split-file" accept=".pdf" onchange="loadPdfForSplit()" style="display: none;">
                    <div onclick="document.getElementById('pdf-split-file').click()" style="padding: 2rem; border: 2px dashed var(--border); border-radius: 8px; text-align: center; cursor: pointer; background: var(--bg-tertiary); margin-bottom: 1rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“„</div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem;">Click to upload PDF or drag & drop</div>
                    </div>
                    <div id="pdf-split-info" style="display: none; padding: 0.75rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.875rem; margin-bottom: 1rem;"></div>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Split Mode</label>
                    <select id="split-mode" onchange="updateSplitMode()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                        <option value="all">Extract all pages individually</option>
                        <option value="range">Extract page range</option>
                        <option value="custom">Custom pages (e.g., 1,3,5-8)</option>
                    </select>
                    <div id="split-range-input" style="display: none;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Page Range</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 1rem;">
                            <input type="number" id="split-start" placeholder="From" min="1" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                            <input type="number" id="split-end" placeholder="To" min="1" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                        </div>
                    </div>
                    <div id="split-custom-input" style="display: none;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Pages (e.g., 1,3,5-8)</label>
                        <input type="text" id="split-custom" placeholder="1,3,5-8" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                    </div>
                    <button class="button button-primary" onclick="splitPdf()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Split PDF</button>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Preview & Download</div>
                </div>
                <div class="panel-content">
                    <div id="pdf-split-preview" style="min-height: 300px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-size: 0.875rem; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center;">Upload a PDF to start splitting</div>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Merge Page -->
    <div id="pdf-merge-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ”—</span>
                <span>PDF Merge & Combine</span>
            </div>
            <button class="back-button" onclick="showPdfMenu()">
                <span>â†</span>
                <span>Back to PDF Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Upload PDFs</div>
                </div>
                <div class="panel-content">
                    <input type="file" id="pdf-merge-files" accept=".pdf" multiple onchange="loadPdfsForMerge()" style="display: none;">
                    <div onclick="document.getElementById('pdf-merge-files').click()" style="padding: 2rem; border: 2px dashed var(--border); border-radius: 8px; text-align: center; cursor: pointer; background: var(--bg-tertiary); margin-bottom: 1rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“š</div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem;">Click to upload multiple PDFs or drag & drop</div>
                    </div>
                    <div id="pdf-merge-list" style="display: none;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Files to Merge (drag to reorder)</label>
                        <div id="merge-files-container" style="margin-bottom: 1rem;"></div>
                        <button class="button button-primary" onclick="mergePdfs()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Merge PDFs</button>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Preview & Download</div>
                </div>
                <div class="panel-content">
                    <div id="pdf-merge-preview" style="min-height: 300px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-size: 0.875rem; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center;">Upload PDFs to start merging</div>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Compress Page -->
    <div id="pdf-compress-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ—œï¸</span>
                <span>PDF Compress & Optimize</span>
            </div>
            <button class="back-button" onclick="showPdfMenu()">
                <span>â†</span>
                <span>Back to PDF Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Upload PDF</div>
                </div>
                <div class="panel-content">
                    <input type="file" id="pdf-compress-file" accept=".pdf" onchange="loadPdfForCompress()" style="display: none;">
                    <div onclick="document.getElementById('pdf-compress-file').click()" style="padding: 2rem; border: 2px dashed var(--border); border-radius: 8px; text-align: center; cursor: pointer; background: var(--bg-tertiary); margin-bottom: 1rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“„</div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem;">Click to upload PDF or drag & drop</div>
                    </div>
                    <div id="pdf-compress-info" style="display: none; padding: 0.75rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.875rem; margin-bottom: 1rem;"></div>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Compression Quality</label>
                    <select id="compress-quality" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                        <option value="low">Low Quality (Smallest size)</option>
                        <option value="medium" selected>Medium Quality (Balanced)</option>
                        <option value="high">High Quality (Larger size)</option>
                    </select>
                    <button class="button button-primary" onclick="compressPdf()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Compress PDF</button>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Result & Download</div>
                </div>
                <div class="panel-content">
                    <div id="pdf-compress-result" style="min-height: 300px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-size: 0.875rem; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center;">Upload a PDF to start compression</div>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Tools Page -->
    <div id="pdf-tools-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ï¿½ï¸</span>
                <span>PDF Advanced Tools</span>
            </div>
            <button class="back-button" onclick="showPdfMenu()">
                <span>â†</span>
                <span>Back to PDF Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Upload PDF</div>
                </div>
                <div class="panel-content">
                    <input type="file" id="pdf-tools-file" accept=".pdf" onchange="loadPdfForTools()" style="display: none;">
                    <div onclick="document.getElementById('pdf-tools-file').click()" style="padding: 2rem; border: 2px dashed var(--border); border-radius: 8px; text-align: center; cursor: pointer; background: var(--bg-tertiary); margin-bottom: 1rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“„</div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem;">Click to upload PDF or drag & drop</div>
                    </div>
                    <div id="pdf-tools-info" style="display: none; padding: 0.75rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.875rem; margin-bottom: 1rem;"></div>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Tools</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 1rem;">
                        <button class="button button-secondary" onclick="rotatePdfPages(90)" style="padding: 0.5rem; font-size: 0.875rem;">Rotate 90Â°</button>
                        <button class="button button-secondary" onclick="rotatePdfPages(180)" style="padding: 0.5rem; font-size: 0.875rem;">Rotate 180Â°</button>
                        <button class="button button-secondary" onclick="extractPdfImages()" style="padding: 0.5rem; font-size: 0.875rem;">Extract Images</button>
                        <button class="button button-secondary" onclick="editPdfMetadata()" style="padding: 0.5rem; font-size: 0.875rem;">Edit Metadata</button>
                    </div>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Delete Pages (e.g., 2,4,6)</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="text" id="delete-pages" placeholder="2,4,6" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                        <button class="button button-primary" onclick="deletePdfPages()" style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">Delete</button>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Preview & Result</div>
                </div>
                <div class="panel-content">
                    <div id="pdf-tools-preview" style="min-height: 300px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-size: 0.875rem; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center;">Upload a PDF to use advanced tools</div>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Editor Page -->
    <div id="pdf-editor-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>âœï¸</span>
                <span>PDF Editor</span>
            </div>
            <button class="back-button" onclick="showPdfMenu()">
                <span>â†</span>
                <span>Back to PDF Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Tools</div>
                </div>
                <div class="panel-content">
                    <input type="file" id="pdf-editor-file" accept=".pdf" onchange="loadPdfForEditor()" style="display: none;">
                    <div onclick="document.getElementById('pdf-editor-file').click()" style="padding: 2rem; border: 2px dashed var(--border); border-radius: 8px; text-align: center; cursor: pointer; background: var(--bg-tertiary); margin-bottom: 1rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“„</div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem;">Click to upload PDF</div>
                    </div>
                    
                    <div id="pdf-editor-info" style="display: none; padding: 0.75rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.875rem; margin-bottom: 1rem;"></div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 600;">Editing Tools</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <button id="pdf-text-tool" onclick="selectPdfTool('text')" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; color: var(--text-primary); font-size: 0.875rem; transition: all 0.2s;">
                                ðŸ“ Text
                            </button>
                            <button id="pdf-signature-tool" onclick="selectPdfTool('signature')" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; color: var(--text-primary); font-size: 0.875rem; transition: all 0.2s;">
                                âœï¸ Signature
                            </button>
                            <button id="pdf-draw-tool" onclick="selectPdfTool('draw')" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; color: var(--text-primary); font-size: 0.875rem; transition: all 0.2s;">
                                âœï¸ Draw
                            </button>
                            <button id="pdf-highlight-tool" onclick="selectPdfTool('highlight')" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; color: var(--text-primary); font-size: 0.875rem; transition: all 0.2s;">
                                ðŸ–ï¸ Highlight
                            </button>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button onclick="pdfEditorUndo()" style="padding: 0.5rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; color: var(--text-primary); font-size: 0.75rem;">
                                â†¶ Undo
                            </button>
                            <button onclick="pdfEditorDeleteSelected()" style="padding: 0.5rem; background: var(--danger); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; color: white; font-size: 0.75rem;">
                                ðŸ—‘ï¸ Delete
                            </button>
                        </div>
                    </div>
                    
                    <div id="pdf-selected-info" style="display: none; margin-bottom: 1rem; padding: 0.75rem; background: rgba(99, 102, 241, 0.2); border: 1px solid var(--primary); border-radius: 6px; font-size: 0.875rem;">
                        <strong>Selected:</strong> <span id="pdf-selected-type"></span><br>
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Click Delete or press Delete key to remove</span>
                    </div>
                    
                    <div id="pdf-text-options" style="display: none; margin-bottom: 1rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 6px;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Text Size:</label>
                        <input type="number" id="pdf-text-size" value="16" min="8" max="72" style="width: 100%; padding: 0.5rem; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary); margin-bottom: 0.5rem;">
                        
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Text Color:</label>
                        <input type="color" id="pdf-text-color" value="#000000" style="width: 100%; height: 40px; border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
                    </div>
                    
                    <div id="pdf-signature-options" style="display: none; margin-bottom: 1rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 6px;">
                        <input type="file" id="pdf-signature-upload" accept="image/*" style="display: none;" onchange="uploadSignatureImage()">
                        <button onclick="document.getElementById('pdf-signature-upload').click()" class="button button-primary" style="width: 100%; margin-bottom: 0.5rem;">
                            ðŸ“ Upload Signature Image
                        </button>
                        <div id="pdf-signature-preview" style="min-height: 100px; border: 2px dashed var(--border); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); font-size: 0.875rem; background: var(--bg-primary);">
                            No signature uploaded
                        </div>
                        <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-secondary);">
                            ðŸ’¡ Upload your digital or scanned signature (PNG/JPG)
                        </div>
                    </div>
                    
                    <div id="pdf-draw-options" style="display: none; margin-bottom: 1rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 6px;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Brush Size:</label>
                        <input type="range" id="pdf-brush-size" value="3" min="1" max="20" style="width: 100%; margin-bottom: 0.5rem;">
                        
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Brush Color:</label>
                        <input type="color" id="pdf-brush-color" value="#000000" style="width: 100%; height: 40px; border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
                    </div>
                    
                    <div id="pdf-highlight-options" style="display: none; margin-bottom: 1rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 6px;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Highlight Color:</label>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                            <div onclick="setPdfHighlightColor('#FFFF00')" style="background: #FFFF00; height: 40px; border-radius: 4px; cursor: pointer; border: 2px solid var(--border);"></div>
                            <div onclick="setPdfHighlightColor('#00FF00')" style="background: #00FF00; height: 40px; border-radius: 4px; cursor: pointer; border: 2px solid var(--border);"></div>
                            <div onclick="setPdfHighlightColor('#00FFFF')" style="background: #00FFFF; height: 40px; border-radius: 4px; cursor: pointer; border: 2px solid var(--border);"></div>
                            <div onclick="setPdfHighlightColor('#FF69B4')" style="background: #FF69B4; height: 40px; border-radius: 4px; cursor: pointer; border: 2px solid var(--border);"></div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1rem;">
                        <button class="button button-primary" onclick="savePdfEdits()" style="width: 100%; margin-bottom: 0.5rem;">
                            ðŸ’¾ Save Edited PDF
                        </button>
                        <button class="button button-secondary" onclick="clearPdfEdits()" style="width: 100%;">
                            ðŸ”„ Clear All Edits
                        </button>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(99, 102, 241, 0.1); border-left: 3px solid var(--primary); border-radius: 4px; font-size: 0.875rem;">
                        <strong>ðŸ’¡ How to Use:</strong><br>
                        â€¢ <strong>Text:</strong> Click to add, type inline, Enter to save<br>
                        â€¢ <strong>Signature:</strong> Upload image, click to place, drag corners to resize<br>
                        â€¢ <strong>Draw:</strong> Click and drag to draw freehand<br>
                        â€¢ <strong>Highlight:</strong> Click and drag to highlight<br>
                        â€¢ <strong>Edit:</strong> Click any annotation to select it, then drag to move<br>
                        â€¢ <strong>Delete:</strong> Select annotation and press Delete key or click Delete button<br>
                        â€¢ <strong>Undo:</strong> Click Undo button to remove last change
                    </div>
                </div>
            </div>
            
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">PDF Canvas</div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button onclick="zoomPdfEditor('in')" style="padding: 0.25rem 0.5rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 0.875rem;">+</button>
                        <button onclick="zoomPdfEditor('out')" style="padding: 0.25rem 0.5rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 0.875rem;">-</button>
                        <select id="pdf-page-selector" onchange="changePdfPage()" style="padding: 0.25rem 0.5rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary); font-size: 0.875rem;"></select>
                    </div>
                </div>
                <div class="panel-content" style="position: relative; overflow: auto; height: 600px; background: #525659;">
                    <div id="pdf-editor-canvas-container" style="display: flex; justify-content: center; align-items: center; min-height: 100%;">
                        <div style="color: var(--text-secondary); text-align: center; padding: 2rem;">
                            Upload a PDF to start editing
                        </div>
                    </div>
                    <div id="pdf-text-input" contenteditable="true" style="display: none; position: absolute; min-width: 150px; padding: 10px; background: white; border: 3px solid #6366f1; border-radius: 6px; font-family: Arial, sans-serif; font-size: 16px; color: #000; outline: none; box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3), 0 0 0 4px rgba(99, 102, 241, 0.1); z-index: 100; animation: pdfInputFadeIn 0.2s ease-out;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Network Tools Menu Page -->
    <div id="network-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸŒ</span>
                <span>Network Tools</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="format-options" style="max-width: 900px; margin: 0 auto;">
            <div class="format-card" onclick="showNetworkTool('http-client')">
                <div class="format-icon">ðŸ”„</div>
                <div class="format-title">HTTP Client</div>
                <div class="format-description">
                    Test REST APIs with full request builder, headers, body formats, and response viewer
                </div>
            </div>
            <div class="format-card" onclick="showNetworkTool('websocket')">
                <div class="format-icon">âš¡</div>
                <div class="format-title">WebSocket Client</div>
                <div class="format-description">
                    Real-time WebSocket testing with message history and auto-reconnect
                </div>
            </div>
            <div class="format-card" onclick="showNetworkTool('graphql')">
                <div class="format-icon">â—ˆ</div>
                <div class="format-title">GraphQL Playground</div>
                <div class="format-description">
                    Query editor with schema introspection, variables, and query history
                </div>
            </div>
            <div class="format-card" onclick="showNetworkTool('curl')">
                <div class="format-icon">ðŸ’»</div>
                <div class="format-title">cURL Generator</div>
                <div class="format-description">
                    Visual request builder to cURL command converter and reverse parser
                </div>
            </div>
        </div>
    </div>

    <!-- HTTP Client Page -->
    <div id="http-client-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ”„</span>
                <span>HTTP Client</span>
            </div>
            <button class="back-button" onclick="showNetworkMenu()">
                <span>â†</span>
                <span>Back to Network Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Request</div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="button button-secondary" onclick="saveHttpRequest()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Save</button>
                        <button class="button button-secondary" onclick="loadHttpRequest()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Load</button>
                    </div>
                </div>
                <div class="panel-content">
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <select id="http-method" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; font-weight: 600;">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="PATCH">PATCH</option>
                            <option value="DELETE">DELETE</option>
                            <option value="HEAD">HEAD</option>
                            <option value="OPTIONS">OPTIONS</option>
                        </select>
                        <input type="text" id="http-url" placeholder="https://api.example.com/endpoint" value="https://jsonplaceholder.typicode.com/posts/1" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                        <button class="button button-primary" onclick="sendHttpRequest()" style="padding: 0.5rem 1rem; font-size: 0.875rem;">Send</button>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
                            <button id="tab-headers" class="tab-button active" onclick="switchHttpTab('headers')" style="padding: 0.5rem 1rem; background: none; border: none; color: var(--text-secondary); cursor: pointer; border-bottom: 2px solid transparent; font-size: 0.875rem;">Headers</button>
                            <button id="tab-body" class="tab-button" onclick="switchHttpTab('body')" style="padding: 0.5rem 1rem; background: none; border: none; color: var(--text-secondary); cursor: pointer; border-bottom: 2px solid transparent; font-size: 0.875rem;">Body</button>
                            <button id="tab-params" class="tab-button" onclick="switchHttpTab('params')" style="padding: 0.5rem 1rem; background: none; border: none; color: var(--text-secondary); cursor: pointer; border-bottom: 2px solid transparent; font-size: 0.875rem;">Params</button>
                        </div>
                        <div id="http-headers-tab" class="http-tab">
                            <div id="headers-container"></div>
                            <button class="button button-secondary" onclick="addHttpHeader()" style="padding: 0.5rem; font-size: 0.875rem; width: 100%;">+ Add Header</button>
                        </div>
                        <div id="http-body-tab" class="http-tab" style="display: none;">
                            <select id="body-type" onchange="switchBodyType()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 0.5rem;">
                                <option value="json">JSON</option>
                                <option value="xml">XML</option>
                                <option value="text">Plain Text</option>
                                <option value="form">Form Data</option>
                            </select>
                            <textarea id="http-body" placeholder='{"key": "value"}' style="width: 100%; min-height: 200px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                        </div>
                        <div id="http-params-tab" class="http-tab" style="display: none;">
                            <div id="params-container"></div>
                            <button class="button button-secondary" onclick="addHttpParam()" style="padding: 0.5rem; font-size: 0.875rem; width: 100%;">+ Add Parameter</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Response</div>
                    <div id="response-status" style="font-size: 0.875rem; color: var(--text-secondary);"></div>
                </div>
                <div class="panel-content">
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
                        <button id="resp-tab-body" class="tab-button active" onclick="switchResponseTab('body')" style="padding: 0.5rem 1rem; background: none; border: none; color: var(--text-secondary); cursor: pointer; border-bottom: 2px solid transparent; font-size: 0.875rem;">Body</button>
                        <button id="resp-tab-headers" class="tab-button" onclick="switchResponseTab('headers')" style="padding: 0.5rem 1rem; background: none; border: none; color: var(--text-secondary); cursor: pointer; border-bottom: 2px solid transparent; font-size: 0.875rem;">Headers</button>
                    </div>
                    <div id="response-body-tab" class="response-tab">
                        <pre id="http-response" style="min-height: 350px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-muted); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;">Send a request to see the response...</pre>
                    </div>
                    <div id="response-headers-tab" class="response-tab" style="display: none;">
                        <pre id="http-response-headers" style="min-height: 350px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-muted); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre-wrap;">No headers yet...</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- WebSocket Client Page -->
    <div id="websocket-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>âš¡</span>
                <span>WebSocket Client</span>
            </div>
            <button class="back-button" onclick="showNetworkMenu()">
                <span>â†</span>
                <span>Back to Network Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Connection</div>
                    <div id="ws-status" style="font-size: 0.875rem; color: var(--text-secondary);">Disconnected</div>
                </div>
                <div class="panel-content">
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <input type="text" id="ws-url" placeholder="wss://echo.websocket.org" value="wss://echo.websocket.org" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                        <button id="ws-connect-btn" class="button button-primary" onclick="toggleWebSocket()" style="padding: 0.5rem 1rem; font-size: 0.875rem;">Connect</button>
                    </div>
                    <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <input type="checkbox" id="ws-auto-reconnect" checked style="width: 16px; height: 16px;">
                        Auto-reconnect on disconnect
                    </label>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Message to Send</label>
                    <textarea id="ws-message" placeholder='{"type": "ping"}' style="width: 100%; min-height: 120px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 0.5rem; resize: vertical;"></textarea>
                    <button class="button button-primary" onclick="sendWebSocketMessage()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Send Message</button>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Message History</div>
                    <button class="button button-secondary" onclick="clearWsHistory()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Clear</button>
                </div>
                <div class="panel-content">
                    <div id="ws-history" style="min-height: 400px; max-height: 500px; overflow-y: auto; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; color: var(--text-muted);">
                        Connect to a WebSocket server to see messages...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GraphQL Playground Page -->
    <div id="graphql-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>â—ˆ</span>
                <span>GraphQL Playground</span>
            </div>
            <button class="back-button" onclick="showNetworkMenu()">
                <span>â†</span>
                <span>Back to Network Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Query</div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="button button-secondary" onclick="formatGraphQLQuery()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Format</button>
                        <button class="button button-secondary" onclick="loadGraphQLHistory()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">History</button>
                    </div>
                </div>
                <div class="panel-content">
                    <input type="text" id="graphql-endpoint" placeholder="https://api.example.com/graphql" value="https://countries.trevorblades.com/" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; margin-bottom: 1rem;">
                    <textarea id="graphql-query" placeholder='query {&#10;  countries {&#10;    code&#10;    name&#10;  }&#10;}' style="width: 100%; min-height: 180px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: #60a5fa; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 1rem; resize: vertical; line-height: 1.6; tab-size: 2;"></textarea>
                    <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Variables (JSON)</label>
                    <textarea id="graphql-variables" placeholder='{}' style="width: 100%; min-height: 80px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 1rem; resize: vertical;"></textarea>
                    <button class="button button-primary" onclick="executeGraphQL()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Execute Query</button>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Response</div>
                    <div id="graphql-status" style="font-size: 0.875rem; color: var(--text-secondary);"></div>
                </div>
                <div class="panel-content">
                    <pre id="graphql-response" style="min-height: 450px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-muted); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;">Execute a query to see the response...</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- cURL Generator Page -->
    <div id="curl-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ’»</span>
                <span>cURL Generator</span>
            </div>
            <button class="back-button" onclick="showNetworkMenu()">
                <span>â†</span>
                <span>Back to Network Tools</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Request Builder</div>
                    <button class="button button-secondary" onclick="switchCurlMode()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Parse cURL</button>
                </div>
                <div class="panel-content">
                    <div id="curl-builder-mode">
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <select id="curl-method" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem; font-weight: 600;">
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="PUT">PUT</option>
                                <option value="DELETE">DELETE</option>
                            </select>
                            <input type="text" id="curl-url" placeholder="https://api.example.com/endpoint" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                        </div>
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Headers (one per line: Key: Value)</label>
                        <textarea id="curl-headers" placeholder="Content-Type: application/json&#10;Authorization: Bearer token" style="width: 100%; min-height: 100px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 1rem; resize: vertical;"></textarea>
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Body</label>
                        <textarea id="curl-body" placeholder='{"key": "value"}' style="width: 100%; min-height: 120px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 1rem; resize: vertical;"></textarea>
                        <button class="button button-primary" onclick="generateCurl()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Generate cURL</button>
                    </div>
                    <div id="curl-parser-mode" style="display: none;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">Paste cURL Command</label>
                        <textarea id="curl-input" placeholder="curl -X POST https://api.example.com/endpoint -H 'Content-Type: application/json' -d '{...}'" style="width: 100%; min-height: 200px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 1rem; resize: vertical;"></textarea>
                        <button class="button button-primary" onclick="parseCurl()" style="width: 100%; padding: 0.5rem; font-size: 0.875rem;">Parse to Form</button>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">cURL Command</div>
                    <button class="button button-secondary" onclick="copyCurlCommand()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Copy</button>
                </div>
                <div class="panel-content">
                    <pre id="curl-output" style="min-height: 450px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;">Build a request or paste a cURL command to start...</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Git Assistant Menu -->
    <div id="git-menu-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ”€</span>
                <span>Git Assistant</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="format-options" style="max-width: 900px; margin: 0 auto;">
            <div class="format-card" onclick="showGitTool('command-ref')">
                <div class="format-icon">ðŸ“–</div>
                <div class="format-title">Command Reference</div>
                <div class="format-description">Searchable Git command library with examples</div>
            </div>
            <div class="format-card" onclick="showGitTool('branch-viz')">
                <div class="format-icon">ðŸŒ³</div>
                <div class="format-title">Branch Visualizer</div>
                <div class="format-description">Visual branch diagram generator</div>
            </div>
            <div class="format-card" onclick="showGitTool('gitignore')">
                <div class="format-icon">ðŸš«</div>
                <div class="format-title">.gitignore Generator</div>
                <div class="format-description">Template library for common tech stacks</div>
            </div>
        </div>
    </div>

    <!-- Git Command Reference -->
    <div id="git-command-ref-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ“–</span>
                <span>Git Command Reference</span>
            </div>
            <button class="back-button" onclick="showEditor('git-menu')">
                <span>â†</span>
                <span>Back to Git Tools</span>
            </button>
        </div>
        <div class="editor-panel" style="max-width: 1200px; margin: 0 auto;">
            <div class="panel-header">
                <div class="panel-title">Search Commands</div>
            </div>
            <div class="panel-content">
                <input type="text" id="git-cmd-search" placeholder="Search commands (e.g., commit, branch, merge)..." style="width: 100%; padding: 0.75rem; margin-bottom: 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;" oninput="filterGitCommands()">
                <div id="git-cmd-list" style="max-height: 600px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Git Branch Visualizer -->
    <div id="git-branch-viz-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸŒ³</span>
                <span>Branch Visualizer</span>
            </div>
            <button class="back-button" onclick="showEditor('git-menu')">
                <span>â†</span>
                <span>Back to Git Tools</span>
            </button>
        </div>
        <div class="editor-panel" style="max-width: 1200px; margin: 0 auto;">
            <div class="panel-header">
                <div class="panel-title">Branch Structure</div>
            </div>
            <div class="panel-content">
                <textarea id="branch-input" placeholder="Enter branch structure (one per line):&#10;main&#10;  feature/auth&#10;  feature/payments&#10;develop&#10;  hotfix/bug-123" style="width: 100%; height: 150px; padding: 0.75rem; margin-bottom: 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                    <button class="button button-primary" onclick="generateBranchViz()">Generate Visualization</button>
                    <button class="button button-secondary" onclick="document.getElementById('branch-input').value='main\n  feature/user-auth\n  feature/api-integration\ndevelop\n  hotfix/login-fix';generateBranchViz();">Load Example</button>
                </div>
                <pre id="branch-viz-output" style="padding: 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre; min-height: 200px;">Branch visualization will appear here...</pre>
            </div>
        </div>
    </div>

    <!-- .gitignore Generator -->
    <div id="git-gitignore-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸš«</span>
                <span>.gitignore Generator</span>
            </div>
            <button class="back-button" onclick="showEditor('git-menu')">
                <span>â†</span>
                <span>Back to Git Tools</span>
            </button>
        </div>
        <div class="editor-panel" style="max-width: 1200px; margin: 0 auto;">
            <div class="panel-header">
                <div class="panel-title">Select Template</div>
            </div>
            <div class="panel-content">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Select Template:</label>
                    <select id="gitignore-template" onchange="loadGitignoreTemplate()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                        <option value="">-- Choose a template --</option>
                        <option value="node">Node.js</option>
                        <option value="python">Python</option>
                        <option value="java">Java</option>
                        <option value="react">React</option>
                        <option value="vue">Vue.js</option>
                        <option value="angular">Angular</option>
                        <option value="dotnet">.NET</option>
                        <option value="go">Go</option>
                        <option value="rust">Rust</option>
                        <option value="general">General</option>
                    </select>
                </div>
                <textarea id="gitignore-output" style="width: 100%; height: 400px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;" placeholder="Select a template to generate .gitignore content..."></textarea>
                <button class="button button-primary" onclick="copyGitignore()" style="margin-top: 1rem;">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- Docker Helper Menu -->
    <div id="docker-menu-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ³</span>
                <span>Docker Helper</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="format-options" style="max-width: 900px; margin: 0 auto;">
            <div class="format-card" onclick="showDockerTool('run-builder')">
                <div class="format-icon">â–¶ï¸</div>
                <div class="format-title">Run Command Builder</div>
                <div class="format-description">Visual builder for docker run commands</div>
            </div>
            <div class="format-card" onclick="showDockerTool('config-presets')">
                <div class="format-icon">âš™ï¸</div>
                <div class="format-title">Config Presets</div>
                <div class="format-description">Common configurations for popular services</div>
            </div>
            <div class="format-card" onclick="showDockerTool('compose-gen')">
                <div class="format-icon">ðŸ“‹</div>
                <div class="format-title">Compose Generator</div>
                <div class="format-description">Multi-container docker-compose.yml builder</div>
            </div>
        </div>
    </div>

    <!-- Docker Run Command Builder -->
    <div id="docker-run-builder-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>â–¶ï¸</span>
                <span>Docker Run Command Builder</span>
            </div>
            <button class="back-button" onclick="showEditor('docker-menu')">
                <span>â†</span>
                <span>Back to Docker Tools</span>
            </button>
        </div>
        <div class="editor-panel" style="max-width: 1200px; margin: 0 auto;">
            <div class="panel-header">
                <div class="panel-title">Build Command</div>
            </div>
            <div class="panel-content">
                <div style="display: grid; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Image Name:</label>
                        <input type="text" id="docker-image" placeholder="e.g., nginx:latest" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Container Name (optional):</label>
                        <input type="text" id="docker-name" placeholder="e.g., my-nginx" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="docker-detached" checked>
                                <span>Detached mode (-d)</span>
                            </label>
                        </div>
                        <div>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="docker-rm">
                                <span>Auto-remove (--rm)</span>
                            </label>
                        </div>
                    </div>
                    <div id="docker-ports-container"></div>
                    <button class="button button-secondary" onclick="addDockerPort()">+ Add Port Mapping</button>
                    <div id="docker-env-container"></div>
                    <button class="button button-secondary" onclick="addDockerEnv()">+ Add Environment Variable</button>
                    <div id="docker-volume-container"></div>
                    <button class="button button-secondary" onclick="addDockerVolume()">+ Add Volume Mount</button>
                </div>
                <button class="button button-primary" onclick="generateDockerRun()">Generate Command</button>
                <pre id="docker-run-output" style="margin-top: 1rem; padding: 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word; min-height: 100px;">Configure options above and click Generate Command...</pre>
                <button class="button button-secondary" onclick="copyDockerCommand()" style="margin-top: 1rem;">Copy Command</button>
            </div>
        </div>
    </div>

    <!-- Docker Config Presets -->
    <div id="docker-config-presets-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>âš™ï¸</span>
                <span>Docker Config Presets</span>
            </div>
            <button class="back-button" onclick="showEditor('docker-menu')">
                <span>â†</span>
                <span>Back to Docker Tools</span>
            </button>
        </div>
        <div class="editor-panel" style="max-width: 1200px; margin: 0 auto;">
            <div class="panel-header">
                <div class="panel-title">Select Service</div>
            </div>
            <div class="panel-content">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Select Service:</label>
                    <select id="docker-preset" onchange="loadDockerPreset()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                        <option value="">-- Choose a service --</option>
                        <option value="nginx">Nginx Web Server</option>
                        <option value="postgres">PostgreSQL Database</option>
                        <option value="mysql">MySQL Database</option>
                        <option value="redis">Redis Cache</option>
                        <option value="mongodb">MongoDB Database</option>
                        <option value="elasticsearch">Elasticsearch</option>
                    </select>
                </div>
                <pre id="docker-preset-output" style="padding: 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word; min-height: 300px;">Select a service to see its Docker configuration...</pre>
                <button class="button button-primary" onclick="copyDockerPreset()" style="margin-top: 1rem;">Copy Configuration</button>
            </div>
        </div>
    </div>

    <!-- Docker Compose Generator -->
    <div id="docker-compose-gen-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ“‹</span>
                <span>Docker Compose Generator</span>
            </div>
            <button class="back-button" onclick="showEditor('docker-menu')">
                <span>â†</span>
                <span>Back to Docker Tools</span>
            </button>
        </div>
        <div class="editor-panel" style="max-width: 1200px; margin: 0 auto;">
            <div class="panel-header">
                <div class="panel-title">Select Stack Template</div>
            </div>
            <div class="panel-content">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Select Stack Template:</label>
                    <select id="compose-template" onchange="loadComposeTemplate()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                        <option value="">-- Choose a template --</option>
                        <option value="lamp">LAMP Stack (Apache, MySQL, PHP)</option>
                        <option value="mean">MEAN Stack (MongoDB, Express, Angular, Node)</option>
                        <option value="wordpress">WordPress + MySQL</option>
                        <option value="node-postgres">Node.js + PostgreSQL</option>
                        <option value="python-redis">Python + Redis</option>
                        <option value="nginx-node">Nginx + Node.js</option>
                    </select>
                </div>
                <textarea id="compose-output" style="width: 100%; height: 450px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;" placeholder="Select a template to generate docker-compose.yml content..."></textarea>
                <button class="button button-primary" onclick="copyCompose()" style="margin-top: 1rem;">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- API Response Mocker -->
    <div id="api-mocker-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ”§</span>
                <span>API Response Mocker</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Create Mock Endpoint</div>
                </div>
                <div class="panel-content">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Endpoint Name:</label>
                        <input type="text" id="mock-name" placeholder="My API Endpoint" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Path:</label>
                        <input type="text" id="mock-path" placeholder="/api/users" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div style="margin-bottom: 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Method:</label>
                            <select id="mock-method" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                                <option>GET</option>
                                <option>POST</option>
                                <option>PUT</option>
                                <option>PATCH</option>
                                <option>DELETE</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Status Code:</label>
                            <input type="number" id="mock-status" value="200" min="100" max="599" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Response Body (JSON):</label>
                        <textarea id="mock-response" placeholder='{"success": true, "data": []}' style="width: 100%; height: 150px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Delay (ms):</label>
                        <input type="number" id="mock-delay" value="0" min="0" max="10000" step="100" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <button class="button button-primary" onclick="createMockEndpoint()">Create Endpoint</button>
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                        <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.5rem;">Load Preset:</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button class="button button-secondary" onclick="loadMockPreset('getUsers')" style="font-size: 0.75rem;">Get Users (200)</button>
                            <button class="button button-secondary" onclick="loadMockPreset('createUser')" style="font-size: 0.75rem;">Create User (201)</button>
                            <button class="button button-secondary" onclick="loadMockPreset('notFound')" style="font-size: 0.75rem;">Not Found (404)</button>
                            <button class="button button-secondary" onclick="loadMockPreset('serverError')" style="font-size: 0.75rem;">Server Error (500)</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Mock Endpoints</div>
                </div>
                <div class="panel-content">
                    <div id="mock-endpoints-list"></div>
                </div>
                <div class="panel-header" style="margin-top: 1rem;">
                    <div class="panel-title">Request History</div>
                </div>
                <div class="panel-content">
                    <div id="mock-history" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Log Analyzer -->
    <div id="log-analyzer-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ“Š</span>
                <span>Log Analyzer</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Input Logs</div>
                    <div class="panel-actions">
                        <button class="button button-secondary" onclick="document.getElementById('log-file-input').click()">Upload File</button>
                        <button class="button button-secondary" onclick="loadSampleLogs()">Load Sample</button>
                        <input type="file" id="log-file-input" accept=".log,.txt" style="display: none;">
                    </div>
                </div>
                <div class="panel-content">
                    <textarea id="log-input" placeholder="Paste your logs here or upload a .log file...&#x0a;&#x0a;Example format:&#x0a;2024-01-15 10:23:45 ERROR Failed to connect to database&#x0a;2024-01-15 10:23:46 WARN Retrying connection...&#x0a;2024-01-15 10:23:47 INFO Connected successfully" style="width: 100%; height: 300px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                    <button class="button button-primary" onclick="analyzeLogs()" style="margin-top: 1rem;">Analyze Logs</button>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Filters</div>
                </div>
                <div class="panel-content">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Log Level:</label>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="filter-error" checked style="width: 16px; height: 16px; cursor: pointer;">
                                <span style="color: var(--danger);">ERROR</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="filter-warn" checked style="width: 16px; height: 16px; cursor: pointer;">
                                <span style="color: var(--warning);">WARN</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="filter-info" checked style="width: 16px; height: 16px; cursor: pointer;">
                                <span style="color: var(--success);">INFO</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="filter-debug" checked style="width: 16px; height: 16px; cursor: pointer;">
                                <span style="color: var(--text-secondary);">DEBUG</span>
                            </label>
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Regex Search:</label>
                        <input type="text" id="log-regex" placeholder="e.g., error|exception|failed" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <button class="button button-secondary" onclick="analyzeLogs()">Apply Filters</button>
                    <div id="log-stats" style="margin-top: 1rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 6px; font-size: 0.875rem;"></div>
                    <div id="log-timeline" style="margin-top: 1rem;"></div>
                </div>
            </div>
        </div>
        <div class="editor-panel" style="margin-top: 1rem;">
            <div class="panel-header">
                <div class="panel-title">Parsed Logs</div>
                <button class="button button-secondary" onclick="exportFilteredLogs()">Export Filtered</button>
            </div>
            <div class="panel-content">
                <div id="parsed-logs" style="max-height: 400px; overflow-y: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;"></div>
            </div>
        </div>
    </div>

    <!-- Subnet Calculator Page -->
    <div id="subnet-calc-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸŒ</span>
                <span>Subnet Calculator</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>

        <!-- IP Version Tabs -->
        <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; border-bottom: 2px solid var(--border); padding-bottom: 0.5rem;">
            <button id="ipv4-tab" class="tool-tab active" onclick="switchSubnetVersion('ipv4')">IPv4 Subnet</button>
            <button id="ipv6-tab" class="tool-tab" onclick="switchSubnetVersion('ipv6')">IPv6 Subnet</button>
        </div>

        <!-- IPv4 Calculator -->
        <div id="ipv4-subnet" class="subnet-version-content">
            <div class="editor-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">IPv4 Input</div>
                    </div>
                    <div class="panel-content">
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">IP Address</label>
                            <input type="text" id="ipv4-address" placeholder="e.g., 192.168.1.0" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Subnet Mask / CIDR</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                                <input type="text" id="ipv4-mask" placeholder="255.255.255.0" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                                <input type="number" id="ipv4-cidr" placeholder="/24" min="0" max="32" style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                            </div>
                        </div>
                        <button class="button button-primary" onclick="calculateIPv4Subnet()" style="width: 100%; margin-bottom: 1rem;">
                            <span>ðŸ”</span>
                            <span>Calculate Subnet</span>
                        </button>
                        <div style="padding: 1rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.8rem;">
                            <strong style="color: var(--primary-light);">ðŸ’¡ Quick Examples:</strong><br>
                            â€¢ 192.168.1.0/24 (256 addresses)<br>
                            â€¢ 10.0.0.0/8 (16M addresses)<br>
                            â€¢ 172.16.0.0/12 (1M addresses)<br>
                            â€¢ 192.168.1.0/255.255.255.0
                        </div>
                    </div>
                </div>

                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Subnet Information</div>
                        <button class="icon-button tooltip" onclick="copySubnetInfo('ipv4')">
                            <span>ðŸ“‹</span>
                            <span class="tooltiptext">Copy All Info</span>
                        </button>
                    </div>
                    <div class="panel-content">
                        <div id="ipv4-result" style="font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.8;">
                            <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸŒ</div>
                                <div>Enter an IP address and subnet mask to calculate</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Usable IP Range Table -->
            <div id="ipv4-ip-range" class="editor-panel" style="margin-top: 1rem; display: none;">
                <div class="panel-header">
                    <div class="panel-title">Usable IP Address Range</div>
                    <button class="icon-button tooltip" onclick="exportIPList('ipv4')">
                        <span>ðŸ’¾</span>
                        <span class="tooltiptext">Export IP List</span>
                    </button>
                </div>
                <div class="panel-content">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Show IPs (max 1024):</label>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button class="button button-secondary" onclick="showIPRange('ipv4', 'first', 10)">First 10</button>
                            <button class="button button-secondary" onclick="showIPRange('ipv4', 'first', 50)">First 50</button>
                            <button class="button button-secondary" onclick="showIPRange('ipv4', 'last', 10)">Last 10</button>
                            <button class="button button-secondary" onclick="showIPRange('ipv4', 'all')">Show All</button>
                        </div>
                    </div>
                    <div id="ipv4-ip-list" style="max-height: 400px; overflow-y: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;"></div>
                </div>
            </div>
        </div>

        <!-- IPv6 Calculator -->
        <div id="ipv6-subnet" class="subnet-version-content" style="display: none;">
            <div class="editor-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">IPv6 Input</div>
                    </div>
                    <div class="panel-content">
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">IPv6 Address</label>
                            <input type="text" id="ipv6-address" placeholder="e.g., 2001:0db8:85a3::/64" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Prefix Length</label>
                            <input type="number" id="ipv6-prefix" placeholder="/64" min="0" max="128" value="64" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                        </div>
                        <button class="button button-primary" onclick="calculateIPv6Subnet()" style="width: 100%; margin-bottom: 1rem;">
                            <span>ðŸ”</span>
                            <span>Calculate Subnet</span>
                        </button>
                        <div style="padding: 1rem; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; font-size: 0.8rem;">
                            <strong style="color: var(--primary-light);">ðŸ’¡ Quick Examples:</strong><br>
                            â€¢ 2001:db8::/32 (Global Unicast)<br>
                            â€¢ fe80::/10 (Link-Local)<br>
                            â€¢ fd00::/8 (Unique Local)<br>
                            â€¢ 2001:0db8:85a3:0000:0000:8a2e:0370:7334/64
                        </div>
                    </div>
                </div>

                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Subnet Information</div>
                        <button class="icon-button tooltip" onclick="copySubnetInfo('ipv6')">
                            <span>ðŸ“‹</span>
                            <span class="tooltiptext">Copy All Info</span>
                        </button>
                    </div>
                    <div class="panel-content">
                        <div id="ipv6-result" style="font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.8;">
                            <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸŒ</div>
                                <div>Enter an IPv6 address and prefix to calculate</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- IPv6 Address Range -->
            <div id="ipv6-ip-range" class="editor-panel" style="margin-top: 1rem; display: none;">
                <div class="panel-header">
                    <div class="panel-title">IPv6 Address Range & Examples</div>
                </div>
                <div class="panel-content">
                    <div id="ipv6-ip-list" style="font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SQL Query Builder -->
    <div id="sql-builder-page" class="editor-page">
        <div class="editor-header">
            <div class="editor-title">
                <span>ðŸ—ƒï¸</span>
                <span>SQL Query Builder</span>
            </div>
            <button class="back-button" onclick="showHome()">
                <span>â†</span>
                <span>Back to Home</span>
            </button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Visual Query Builder</div>
                </div>
                <div class="panel-content">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Query Type:</label>
                        <select id="sql-query-type" onchange="updateSqlBuilder()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                            <option>SELECT</option>
                            <option>INSERT</option>
                            <option>UPDATE</option>
                            <option>DELETE</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Table Name:</label>
                        <input type="text" id="sql-table" placeholder="users" oninput="updateSqlBuilder()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div id="sql-select-fields" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Columns (comma-separated, or * for all):</label>
                        <input type="text" id="sql-columns" placeholder="id, name, email" oninput="updateSqlBuilder()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div id="sql-insert-fields" style="margin-bottom: 1rem; display: none;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Values (JSON format):</label>
                        <textarea id="sql-values" placeholder='{"name": "John", "email": "john@example.com"}' oninput="updateSqlBuilder()" style="width: 100%; height: 100px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                    </div>
                    <div id="sql-update-fields" style="margin-bottom: 1rem; display: none;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Set Values (JSON format):</label>
                        <textarea id="sql-set-values" placeholder='{"name": "Jane", "status": "active"}' oninput="updateSqlBuilder()" style="width: 100%; height: 100px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                    </div>
                    <div id="sql-where-section" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">WHERE Clause:</label>
                        <input type="text" id="sql-where" placeholder="age > 18 AND status = 'active'" oninput="updateSqlBuilder()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div id="sql-order-section" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">ORDER BY:</label>
                        <input type="text" id="sql-order" placeholder="created_at DESC" oninput="updateSqlBuilder()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;">
                    </div>
                    <div style="margin-bottom: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                        <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.5rem;">Load Template:</div>
                        <select id="sql-template" onchange="loadSqlTemplate()" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">
                            <option value="">-- Choose a template --</option>
                            <option value="basic-select">Basic SELECT</option>
                            <option value="join">SELECT with JOIN</option>
                            <option value="aggregate">Aggregate Functions</option>
                            <option value="insert">INSERT Example</option>
                            <option value="update">UPDATE Example</option>
                            <option value="delete">DELETE Example</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">Generated SQL Query</div>
                    <div class="panel-actions">
                        <button class="button button-secondary" onclick="formatSqlQuery()">Format</button>
                        <button class="button button-secondary" onclick="copySqlQuery()">Copy</button>
                    </div>
                </div>
                <div class="panel-content">
                    <textarea id="sql-output" readonly style="width: 100%; height: 200px; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; resize: vertical;"></textarea>
                    <button class="button button-primary" onclick="executeSqlQuery()" style="margin-top: 1rem;">Execute Query</button>
                </div>
                <div class="panel-header" style="margin-top: 1rem;">
                    <div class="panel-title">Query Results</div>
                </div>
                <div class="panel-content">
                    <div id="sql-results" style="max-height: 300px; overflow: auto;"></div>
                </div>
            </div>
        </div>
    </div>

        <!-- URL Loader Modal -->
        <div id="url-modal" class="url-modal">
        <div class="url-modal-content">
            <div class="url-modal-title">ðŸŒ Load from URL</div>
            <input type="text" id="url-input" class="url-input" placeholder="Enter URL (e.g., https://api.example.com/data.json)">
            <div class="url-modal-actions">
                <button class="button button-secondary" onclick="closeUrlLoader()">Cancel</button>
                <button class="button button-primary" onclick="loadFromURL()">Load</button>
            </div>
        </div>
    </div>

        <footer class="site-footer">
            <div><span>Developed for Developers by developer</span></div>

            <div>Â© <span>@devprotool2026</span></div>
            <div>Support us / Email us: <a href="mailto:finedharsan@gmail.com">finedharsan@gmail.com</a></div>
        </footer>

        <!-- Floating Scroll to Top Button -->
        <div class="floating-help" onclick="scrollToTop()" title="Scroll to Top">
            <span>â†‘</span>
        </div>
    </div>

    <script>
        // Scroll to Top Function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Help Info Function
        function showHelpInfo() {
            const helpMessage = `
ðŸ”¹ DevPro Toolkit - Quick Help

âœ“ All tools run 100% in your browser
âœ“ No data is sent to any server
âœ“ Your privacy is fully protected

ðŸ’¡ Tips:
â€¢ Use keyboard shortcuts (Ctrl+Enter to format)
â€¢ Drag & drop files into input areas
â€¢ All conversions are instant
â€¢ Download results anytime

ðŸ“§ Need support?
Email: finedharsan@gmail.com

Made with â¤ï¸ for developers
            `.trim();
            
            alert(helpMessage);
        }

        // Dropdown Navigation Functions
        function toggleDropdown(event, dropdownId) {
            event.stopPropagation();
            const dropdown = document.getElementById(dropdownId);
            const allDropdowns = document.querySelectorAll('.dropdown-menu');
            
            // Close all other dropdowns
            allDropdowns.forEach(dd => {
                if (dd.id !== dropdownId) {
                    dd.classList.remove('active');
                }
            });
            
            // Toggle current dropdown
            dropdown.classList.toggle('active');
        }

        function closeAllDropdowns() {
            const allDropdowns = document.querySelectorAll('.dropdown-menu');
            allDropdowns.forEach(dd => {
                dd.classList.remove('active');
            });
        }

        // Click outside to close dropdowns
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.nav-dropdown')) {
                closeAllDropdowns();
            }
        });

        // Section Navigation
        function navigateToSection(sectionName) {
            // Don't navigate if clicking on a tool card
            if (event && event.target.closest('.format-card')) {
                return;
            }

            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Show selected section
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
            }

            // Update navigation active states
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
            });

            const activeLink = document.querySelector(`a[href="#${sectionName}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }

            // Close mobile menu if open
            const navMenu = document.getElementById('navMenu');
            if (navMenu) {
                navMenu.classList.remove('active');
            }
        }

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            navMenu.classList.toggle('active');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const navMenu = document.getElementById('navMenu');
            const toggle = document.querySelector('.mobile-menu-toggle');
            
            if (navMenu && toggle) {
                if (!navMenu.contains(event.target) && !toggle.contains(event.target)) {
                    navMenu.classList.remove('active');
                }
            }
        });

        const THEME_STORAGE_KEY = 'devprotool-theme';

        function applyTheme(theme) {
            const body = document.body;
            const next = theme === 'light' ? 'light' : 'dark';

            body.classList.toggle('theme-light', next === 'light');
            body.classList.toggle('theme-dark', next === 'dark');

            const label = document.querySelector('.theme-toggle-label');
            if (label) {
                label.textContent = next === 'light' ? 'Light' : 'Dark';
            }
        }

        function toggleTheme() {
            const isLight = document.body.classList.contains('theme-light');
            const next = isLight ? 'dark' : 'light';
            applyTheme(next);
            try {
                localStorage.setItem(THEME_STORAGE_KEY, next);
            } catch (e) {
                // ignore storage errors
            }
        }

        // Smooth scroll behavior for section transitions and theme init
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize first section - make sure home is visible
            const homeSection = document.getElementById('home-section');
            if (homeSection) {
                homeSection.classList.add('active');
            }
            const homePage = document.getElementById('home-page');
            if (homePage) {
                homePage.style.display = 'flex';
            }

            // Initialize theme from storage or prefers-color-scheme
            let stored = null;
            try {
                stored = localStorage.getItem(THEME_STORAGE_KEY);
            } catch (e) {
                stored = null;
            }

            if (!stored) {
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                stored = prefersDark ? 'dark' : 'light';
            }

            applyTheme(stored);
        });

        // Navigation
        function showEditor(type) {
            // Redirect 'ascii' to 'image-compressor' for backward compatibility
            if (type === 'ascii') {
                type = 'image-compressor';
            }
            
            // Clean up PDF editor event listeners when leaving
            if (typeof pdfEditorKeyHandler !== 'undefined') {
                document.removeEventListener('keydown', pdfEditorKeyHandler);
            }
            
            // Hide all sections except the active one stays visible
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('json-page').classList.remove('active');
            document.getElementById('xml-page').classList.remove('active');
            document.getElementById('crypto-page').classList.remove('active');
            document.getElementById('converter-page').classList.remove('active');
            document.getElementById('devtools-page').classList.remove('active');
            document.getElementById('playground-page').classList.remove('active');
            document.getElementById('color-page').classList.remove('active');
            document.getElementById('regex-page').classList.remove('active');
            document.getElementById('timestamp-page').classList.remove('active');
            document.getElementById('cron-page').classList.remove('active');
            document.getElementById('image-compressor-page').classList.remove('active');
            document.getElementById('pdf-page').classList.remove('active');
            document.getElementById('pdf-split-page').classList.remove('active');
            document.getElementById('pdf-merge-page').classList.remove('active');
            document.getElementById('pdf-compress-page').classList.remove('active');
            document.getElementById('pdf-tools-page').classList.remove('active');
            document.getElementById('network-page').classList.remove('active');
            document.getElementById('http-client-page').classList.remove('active');
            document.getElementById('websocket-page').classList.remove('active');
            document.getElementById('graphql-page').classList.remove('active');
            document.getElementById('curl-page').classList.remove('active');
            document.getElementById('git-menu-page').classList.remove('active');
            document.getElementById('git-command-ref-page').classList.remove('active');
            document.getElementById('git-branch-viz-page').classList.remove('active');
            document.getElementById('git-gitignore-page').classList.remove('active');
            document.getElementById('docker-menu-page').classList.remove('active');
            document.getElementById('docker-run-builder-page').classList.remove('active');
            document.getElementById('docker-config-presets-page').classList.remove('active');
            document.getElementById('docker-compose-gen-page').classList.remove('active');
            document.getElementById('api-mocker-page').classList.remove('active');
            document.getElementById('log-analyzer-page').classList.remove('active');
            document.getElementById('sql-builder-page').classList.remove('active');
            document.getElementById('subnet-calc-page').classList.remove('active');
            document.getElementById(`${type}-page`).classList.add('active');
            if (type === 'devtools') loadStatusCodes();
            if (type === 'playground') initPlayground();
            if (type === 'timestamp') initTimestamp();
            if (type === 'cron') updateCronExpression();
            if (type === 'color') updateColorFromPicker();
            if (type === 'http-client') initHttpClient();
            if (type === 'git-menu') renderGitCommands();
            if (type === 'sql-builder') initSqlBuilder();
        }

        function showPdfMenu() {
            // Clean up PDF editor event listeners
            if (typeof pdfEditorKeyHandler !== 'undefined') {
                document.removeEventListener('keydown', pdfEditorKeyHandler);
            }
            
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('json-page').classList.remove('active');
            document.getElementById('xml-page').classList.remove('active');
            document.getElementById('crypto-page').classList.remove('active');
            document.getElementById('converter-page').classList.remove('active');
            document.getElementById('devtools-page').classList.remove('active');
            document.getElementById('playground-page').classList.remove('active');
            document.getElementById('color-page').classList.remove('active');
            document.getElementById('regex-page').classList.remove('active');
            document.getElementById('timestamp-page').classList.remove('active');
            document.getElementById('cron-page').classList.remove('active');
            document.getElementById('image-compressor-page').classList.remove('active');
            document.getElementById('pdf-page').classList.add('active');
            document.getElementById('pdf-split-page').classList.remove('active');
            document.getElementById('pdf-merge-page').classList.remove('active');
            document.getElementById('pdf-compress-page').classList.remove('active');
            document.getElementById('pdf-tools-page').classList.remove('active');
        }

        function showPdfTool(toolType) {
            // Clean up PDF editor event listeners when switching PDF tools
            if (toolType !== 'pdf-editor' && typeof pdfEditorKeyHandler !== 'undefined') {
                document.removeEventListener('keydown', pdfEditorKeyHandler);
            }
            
            document.getElementById('pdf-page').classList.remove('active');
            document.getElementById('pdf-split-page').classList.remove('active');
            document.getElementById('pdf-merge-page').classList.remove('active');
            document.getElementById('pdf-compress-page').classList.remove('active');
            document.getElementById('pdf-tools-page').classList.remove('active');
            document.getElementById('pdf-editor-page').classList.remove('active');
            document.getElementById(`${toolType}-page`).classList.add('active');
        }

        function showHome() {
            // Clean up PDF editor event listeners
            if (typeof pdfEditorKeyHandler !== 'undefined') {
                document.removeEventListener('keydown', pdfEditorKeyHandler);
            }
            
            // Show home page
            document.getElementById('home-page').style.display = 'flex';
            
            // Ensure we scroll back to the top when returning home
            if (typeof window !== 'undefined' && window.scrollTo) {
                window.scrollTo(0, 0);
            }
            
            // Hide all editor pages
            document.getElementById('json-page').classList.remove('active');
            document.getElementById('xml-page').classList.remove('active');
            document.getElementById('crypto-page').classList.remove('active');
            document.getElementById('converter-page').classList.remove('active');
            document.getElementById('devtools-page').classList.remove('active');
            document.getElementById('playground-page').classList.remove('active');
            document.getElementById('color-page').classList.remove('active');
            document.getElementById('regex-page').classList.remove('active');
            document.getElementById('timestamp-page').classList.remove('active');
            document.getElementById('cron-page').classList.remove('active');
            document.getElementById('image-compressor-page').classList.remove('active');
            document.getElementById('pdf-page').classList.remove('active');
            document.getElementById('pdf-split-page').classList.remove('active');
            document.getElementById('pdf-merge-page').classList.remove('active');
            document.getElementById('pdf-compress-page').classList.remove('active');
            document.getElementById('pdf-tools-page').classList.remove('active');
            document.getElementById('pdf-editor-page').classList.remove('active');
            document.getElementById('network-page').classList.remove('active');
            document.getElementById('http-client-page').classList.remove('active');
            document.getElementById('websocket-page').classList.remove('active');
            document.getElementById('graphql-page').classList.remove('active');
            document.getElementById('curl-page').classList.remove('active');
            document.getElementById('git-menu-page').classList.remove('active');
            document.getElementById('git-command-ref-page').classList.remove('active');
            document.getElementById('git-branch-viz-page').classList.remove('active');
            document.getElementById('git-gitignore-page').classList.remove('active');
            document.getElementById('docker-menu-page').classList.remove('active');
            document.getElementById('docker-run-builder-page').classList.remove('active');
            document.getElementById('docker-config-presets-page').classList.remove('active');
            document.getElementById('docker-compose-gen-page').classList.remove('active');
            document.getElementById('api-mocker-page').classList.remove('active');
            document.getElementById('log-analyzer-page').classList.remove('active');
            document.getElementById('sql-builder-page').classList.remove('active');
            document.getElementById('subnet-calc-page').classList.remove('active');
        }

        function showNetworkMenu() {
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('json-page').classList.remove('active');
            document.getElementById('xml-page').classList.remove('active');
            document.getElementById('crypto-page').classList.remove('active');
            document.getElementById('converter-page').classList.remove('active');
            document.getElementById('devtools-page').classList.remove('active');
            document.getElementById('playground-page').classList.remove('active');
            document.getElementById('color-page').classList.remove('active');
            document.getElementById('regex-page').classList.remove('active');
            document.getElementById('timestamp-page').classList.remove('active');
            document.getElementById('cron-page').classList.remove('active');
            document.getElementById('image-compressor-page').classList.remove('active');
            document.getElementById('pdf-page').classList.remove('active');
            document.getElementById('network-page').classList.add('active');
            document.getElementById('http-client-page').classList.remove('active');
            document.getElementById('websocket-page').classList.remove('active');
            document.getElementById('graphql-page').classList.remove('active');
            document.getElementById('curl-page').classList.remove('active');
        }

        function showNetworkTool(toolType) {
            document.getElementById('network-page').classList.remove('active');
            document.getElementById('http-client-page').classList.remove('active');
            document.getElementById('websocket-page').classList.remove('active');
            document.getElementById('graphql-page').classList.remove('active');
            document.getElementById('curl-page').classList.remove('active');
            document.getElementById(`${toolType}-page`).classList.add('active');
            if (toolType === 'http-client') initHttpClient();
        }

        function showGitTool(toolType) {
            document.getElementById('git-menu-page').classList.remove('active');
            document.getElementById('git-command-ref-page').classList.remove('active');
            document.getElementById('git-branch-viz-page').classList.remove('active');
            document.getElementById('git-gitignore-page').classList.remove('active');
            document.getElementById(`git-${toolType}-page`).classList.add('active');
            if (toolType === 'command-ref') renderGitCommands();
        }

        function showDockerTool(toolType) {
            document.getElementById('docker-menu-page').classList.remove('active');
            document.getElementById('docker-run-builder-page').classList.remove('active');
            document.getElementById('docker-config-presets-page').classList.remove('active');
            document.getElementById('docker-compose-gen-page').classList.remove('active');
            document.getElementById(`docker-${toolType}-page`).classList.add('active');
        }

        // Utility Functions
        function toggleAdvancedTools(type) {
            const panel = document.getElementById(`${type}-advanced-tools`);
            const toggleBtn = document.getElementById(`${type}-advanced-toggle`);
            const editorPage = document.querySelector('.editor-page.active');
            
            if (panel && toggleBtn) {
                const isHidden = panel.style.display === 'none' || !panel.style.display;
                panel.style.display = isHidden ? 'block' : 'none';
                
                // Adjust editor page padding based on panel visibility
                if (editorPage) {
                    editorPage.style.paddingTop = isHidden ? '80px' : '50px';
                }
                
                // Update button text and arrow
                const arrow = toggleBtn.querySelector('span:last-child');
                if (arrow) {
                    arrow.textContent = isHidden ? 'â–²' : 'â–¼';
                }
            }
        }

        function clearInput(type) {
            document.getElementById(`${type}-input`).value = '';
            const outputMsg = type === 'crypto' ? 'encrypted/decrypted text' : `formatted ${type.toUpperCase()}`;
            const helpText = type === 'json' 
                ? 'ðŸ’¡ Paste JSON in the input box and click "Beautify" to format it!'
                : type === 'xml' 
                ? 'ðŸ’¡ Paste XML in the input box and click "Beautify" to format it!'
                : '';
            document.getElementById(`${type}-output`).innerHTML = `
                <div style="color: var(--text-muted); text-align: center; padding: 3rem 2rem;">
                    <div style="font-size: 2.5rem; margin-bottom: 1rem;">âœ¨</div>
                    <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">Your ${outputMsg} will appear here...</div>
                    <div style="font-size: 0.9rem; opacity: 0.7;">${helpText}</div>
                </div>
            `;
            updateInputStats(type);
            showToast('Input cleared successfully', 'info');
        }

        function copyOutput(type) {
            const output = document.getElementById(`${type}-output`);
            const text = output.innerText || output.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy', 'error');
            });
        }

        function downloadOutput(type) {
            const output = document.getElementById(`${type}-output`);
            const text = output.innerText || output.textContent;
            
            if (!text || text.includes('will appear here')) {
                showToast('No content to download', 'error');
                return;
            }
            
            // Create human-readable date and time
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            const dateTime = `${year}${month}${day}_${hours}${minutes}${seconds}`;
            const filename = `formatted-${type}-${dateTime}.${type}`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('File downloaded!', 'success');
        }

        function loadSampleJSON() {
            const sample = {
                "user": {
                    "name": "John Doe",
                    "age": 30,
                    "email": "john@example.com",
                    "address": {
                        "street": "123 Main St",
                        "city": "New York",
                        "country": "USA"
                    }
                },
                "hobbies": ["reading", "coding", "gaming"],
                "isActive": true,
                "balance": 1234.56
            };
            document.getElementById('json-input').value = JSON.stringify(sample);
            updateInputStats('json');
            showToast('Sample JSON loaded!', 'success');
        }

        function loadSampleXML() {
            const sample = `<?xml version="1.0" encoding="UTF-8"?>
<catalog>
    <book id="1">
        <title>Learning XML</title>
        <author>John Doe</author>
        <price>29.99</price>
        <published>2024</published>
    </book>
    <book id="2">
        <title>Web Development</title>
        <author>Jane Smith</author>
        <price>39.99</price>
        <published>2023</published>
    </book>
</catalog>`;
            document.getElementById('xml-input').value = sample;
            updateInputStats('xml');
            showToast('Sample XML loaded!', 'success');
        }

        function updateInputStats(type) {
            const input = document.getElementById(`${type}-input`).value;
            const statsDiv = document.getElementById(`${type}-input-stats`);
            
            if (!input.trim()) {
                statsDiv.innerHTML = '';
                return;
            }
            
            const chars = input.length;
            const lines = input.split('\n').length;
            const size = new Blob([input]).size;
            const sizeKB = (size / 1024).toFixed(2);
            
            statsDiv.innerHTML = `
                <div class="stat-item"><strong>Characters:</strong> ${chars.toLocaleString()}</div>
                <div class="stat-item"><strong>Lines:</strong> ${lines.toLocaleString()}</div>
                <div class="stat-item"><strong>Size:</strong> ${sizeKB} KB</div>
            `;
        }

        function setupFileUpload(type) {
            const input = document.getElementById(`${type}-input`);
            const fileInput = document.getElementById(`${type}-file-input`);
            
            if (!input || !fileInput) return; // Safety check
            
            // File input change with size validation
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Check file size (max 10MB for text files)
                    const maxSize = 10 * 1024 * 1024; // 10MB
                    if (file.size > maxSize) {
                        showToast(`File too large (${(file.size / 1024 / 1024).toFixed(2)}MB). Maximum 10MB allowed.`, 'error');
                        fileInput.value = '';
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        input.value = event.target.result;
                        updateInputStats(type);
                        showToast(`File "${file.name}" loaded (${(file.size / 1024).toFixed(2)}KB)`, 'success');
                    };
                    reader.onerror = function() {
                        showToast('Failed to read file', 'error');
                    };
                    reader.readAsText(file);
                }
                fileInput.value = ''; // Reset file input
            });
            
            // Drag and drop
            input.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });
            
            input.addEventListener('dragleave', function(e) {
                this.classList.remove('drag-over');
            });
            
            input.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                
                const file = e.dataTransfer.files[0];
                if (file) {
                    // Check file size (max 10MB for text files)
                    const maxSize = 10 * 1024 * 1024; // 10MB
                    if (file.size > maxSize) {
                        showToast(`File too large (${(file.size / 1024 / 1024).toFixed(2)}MB). Maximum 10MB allowed.`, 'error');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        input.value = event.target.result;
                        updateInputStats(type);
                        showToast(`File "${file.name}" loaded (${(file.size / 1024).toFixed(2)}KB)`, 'success');
                    };
                    reader.onerror = function() {
                        showToast('Failed to read file', 'error');
                    };
                    reader.readAsText(file);
                }
            });
            
            // Update stats on input
            input.addEventListener('input', function() {
                updateInputStats(type);
            });
        }

        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `status-message status-${type}`;
            toast.style.position = 'fixed';
            toast.style.top = '1rem';
            toast.style.right = '1rem';
            toast.style.left = '1rem';
            toast.style.zIndex = '10000';
            toast.style.maxWidth = '420px';
            toast.style.marginLeft = 'auto';
            toast.style.marginRight = 'auto';
            
            const icons = {
                success: 'âœ“',
                error: 'âœ•',
                warning: 'âš ',
                info: 'â„¹'
            };
            
            toast.innerHTML = `
                <span style="font-size: 1.25rem; font-weight: 700;">${icons[type] || icons.info}</span>
                <span style="word-break: break-word;">${message}</span>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(20px)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function copyToClipboard(text) {
            if (!text || text.trim() === '' || text.includes('will appear here')) {
                showToast('No content to copy', 'error');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!', 'success');
            }).catch(() => {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    showToast('Copied to clipboard!', 'success');
                } catch (err) {
                    showToast('Failed to copy', 'error');
                }
                document.body.removeChild(textarea);
            });
        }

        // JSON Functions
        let jsonExpandedState = {};

        function beautifyJSON() {
            const input = document.getElementById('json-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some JSON data</span>
                    </div>
                `;
                return;
            }

            try {
                const parsed = JSON.parse(input);
                const indentValue = document.getElementById('json-indent').value;
                const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));

                // Reset expanded state for new JSON
                jsonExpandedState = {};

                output.innerHTML = renderJSON(parsed, 0, 'root', indentStr);
                attachJSONToggleHandlers();
                document.getElementById('json-search-container').style.display = 'block';
                showToast('JSON beautified successfully!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Invalid JSON: ${error.message}</span>
                    </div>
                `;
            }
        }

        function minifyJSON() {
            const input = document.getElementById('json-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some JSON data</span>
                    </div>
                `;
                return;
            }

            try {
                const parsed = JSON.parse(input);
                const minified = JSON.stringify(parsed);
                output.textContent = minified;
                showToast('JSON minified successfully!', 'success');
                
                // Show compression stats
                updateCompressionStats('json', input, minified);
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Invalid JSON: ${error.message}</span>
                    </div>
                `;
            }
        }

        function toggleCompactJSON() {
            const indentSelect = document.getElementById('json-indent');
            const currentValue = indentSelect.value;
            
            if (currentValue === '2') {
                indentSelect.value = '1';
                showToast('Switched to compact view (1 space)', 'success');
            } else {
                indentSelect.value = '2';
                showToast('Switched to normal view (2 spaces)', 'success');
            }
            
            // Re-beautify with new indent
            beautifyJSON();
        }

        function validateJSON() {
            const input = document.getElementById('json-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some JSON data</span>
                    </div>
                `;
                return;
            }

            const warnings = [];
            const suggestions = [];
            
            // Check for duplicate keys
            const dupeKeyRegex = /"([^"]+)"\s*:/g;
            const allKeys = [];
            let match;
            while ((match = dupeKeyRegex.exec(input)) !== null) {
                allKeys.push(match[1]);
            }
            const uniqueKeys = new Set(allKeys);
            if (allKeys.length !== uniqueKeys.size) {
                warnings.push('Duplicate keys detected - later values will override earlier ones');
            }

            // Check for trailing commas
            if (/,\s*[\]}]/.test(input)) {
                warnings.push('Trailing commas found - may cause issues in strict parsers');
            }

            try {
                const parsed = JSON.parse(input);
                
                // Calculate depth and statistics
                let stats = { objects: 0, arrays: 0, maxDepth: 0, size: input.length };
                function calcDepth(obj, depth = 1) {
                    stats.maxDepth = Math.max(stats.maxDepth, depth);
                    if (Array.isArray(obj)) {
                        stats.arrays++;
                        obj.forEach(item => typeof item === 'object' && item !== null && calcDepth(item, depth + 1));
                    } else if (typeof obj === 'object' && obj !== null) {
                        stats.objects++;
                        Object.values(obj).forEach(val => typeof val === 'object' && val !== null && calcDepth(val, depth + 1));
                    }
                }
                calcDepth(parsed);

                if (stats.maxDepth > 5) {
                    suggestions.push(`Deep nesting detected (${stats.maxDepth} levels) - consider flattening structure`);
                }

                let report = `<div class="status-message status-success">
                    <span>âœ“</span>
                    <div style="width: 100%;">
                        <div><strong>Valid JSON!</strong></div>
                        <div style="margin-top: 0.5rem; font-size: 0.875rem;">No syntax errors found.</div>`;
                
                if (warnings.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,165,0,0.1); border-left: 3px solid orange; border-radius: 4px;">
                        <strong style="color: orange;">âš  Warnings:</strong><br>
                        ${warnings.map(w => `â€¢ ${w}`).join('<br>')}
                    </div>`;
                }
                
                if (suggestions.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(135,206,250,0.1); border-left: 3px solid skyblue; border-radius: 4px;">
                        <strong style="color: skyblue;">ðŸ’¡ Suggestions:</strong><br>
                        ${suggestions.map(s => `â€¢ ${s}`).join('<br>')}
                    </div>`;
                }
                
                report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,255,255,0.05); border-radius: 4px; font-size: 0.875rem;">
                    <strong>ðŸ“Š Statistics:</strong><br>
                    Objects: ${stats.objects} | Arrays: ${stats.arrays} | Max Depth: ${stats.maxDepth} | Size: ${stats.size} bytes
                </div>
                    </div>
                </div>`;
                
                output.innerHTML = report;
                showToast('JSON is valid!', 'success');
            } catch (error) {
                let errorDetails = error.message;
                const posMatch = error.message.match(/position (\d+)/);
                
                if (posMatch) {
                    const pos = parseInt(posMatch[1]);
                    const upToError = input.substring(0, pos);
                    const lineNum = upToError.split('\n').length;
                    const colNum = pos - upToError.lastIndexOf('\n');
                    errorDetails = `Error at line ${lineNum}, column ${colNum}: ${error.message}`;
                }
                
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <div>
                            <div><strong>Invalid JSON</strong></div>
                            <div style="margin-top: 0.5rem; font-size: 0.875rem;">${escapeHtml(errorDetails)}</div>
                        </div>
                    </div>
                `;
                showToast('JSON validation failed', 'error');
            }
        }

        // JSON Schema Validation
        function toggleSchemaPanel() {
            const panel = document.getElementById('json-schema-panel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function loadSampleSchema() {
            const sampleSchema = {
                "$schema": "http://json-schema.org/draft-07/schema#",
                "type": "object",
                "properties": {
                    "name": { "type": "string" },
                    "age": { "type": "number", "minimum": 0 },
                    "email": { "type": "string", "format": "email" }
                },
                "required": ["name", "email"]
            };
            document.getElementById('json-schema-input').value = JSON.stringify(sampleSchema, null, 2);
            showToast('Sample schema loaded!', 'success');
        }

        function validateWithSchema() {
            const input = document.getElementById('json-input').value.trim();
            const schemaInput = document.getElementById('json-schema-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `<div class="status-message status-error"><span>âœ•</span><span>Please enter JSON data</span></div>`;
                return;
            }

            if (!schemaInput) {
                output.innerHTML = `<div class="status-message status-error"><span>âœ•</span><span>Please enter a JSON schema</span></div>`;
                return;
            }

            try {
                const json = JSON.parse(input);
                const schema = JSON.parse(schemaInput);
                
                // Initialize Ajv
                const ajv = new window.ajv2020();
                const validate = ajv.compile(schema);
                const valid = validate(json);

                if (valid) {
                    output.innerHTML = `
                        <div class="status-message status-success">
                            <span>âœ“</span>
                            <div>
                                <div><strong>Valid - Schema Match!</strong></div>
                                <div style="margin-top: 0.5rem; font-size: 0.875rem;">JSON data conforms to the provided schema.</div>
                            </div>
                        </div>`;
                    showToast('Schema validation passed!', 'success');
                } else {
                    let errorReport = `<div class="status-message status-error">
                        <span>âœ•</span>
                        <div style="width: 100%;">
                            <div><strong>Schema Validation Failed</strong></div>
                            <div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(239, 68, 68, 0.15); border-left: 3px solid #ef4444; border-radius: 4px;">
                                <strong style="color: #fca5a5;">Errors:</strong><br>`;
                    
                    validate.errors.forEach((err, idx) => {
                        const path = err.instancePath || '/';
                        errorReport += `<br>${idx + 1}. Path: <code>${path}</code><br>`;
                        errorReport += `   Message: ${err.message}<br>`;
                        if (err.params) {
                            errorReport += `   Details: ${JSON.stringify(err.params)}`;
                        }
                    });
                    
                    errorReport += `</div></div></div>`;
                    output.innerHTML = errorReport;
                    showToast('Schema validation failed', 'error');
                }
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Error: ${escapeHtml(error.message)}</span>
                    </div>`;
                showToast('Validation error', 'error');
            }
        }

        function renderJSON(obj, level, path, indentStr = '  ') {
            const indent = indentStr.repeat(level);
            const nextIndent = indentStr.repeat(level + 1);

            if (obj === null) {
                return `<span class="json-null">null</span>`;
            }

            if (typeof obj === 'boolean') {
                return `<span class="json-boolean">${obj}</span>`;
            }

            if (typeof obj === 'number') {
                return `<span class="json-number">${obj}</span>`;
            }

            if (typeof obj === 'string') {
                return `<span class="json-string">"${escapeHtml(obj)}"</span>`;
            }

            if (Array.isArray(obj)) {
                if (obj.length === 0) {
                    return '[]';
                }

                const nodeId = `json-node-${path}`;
                const isExpanded = jsonExpandedState[nodeId] !== false;

                let html = `<span class="collapsible-node">`;
                html += `<button class="node-toggle" data-node="${nodeId}">${isExpanded ? 'â–¼' : 'â–¶'}</button>`;
                html += `[\n`;

                if (!isExpanded) {
                    html += `${nextIndent}<span class="node-collapsed-indicator">... ${obj.length} items</span>\n`;
                } else {
                    html += `<div class="node-content" id="${nodeId}">`;
                    obj.forEach((item, index) => {
                        html += `${nextIndent}${renderJSON(item, level + 1, `${path}[${index}]`, indentStr)}`;
                        if (index < obj.length - 1) html += ',';
                        html += `\n`;
                    });
                    html += `</div>\n`;
                    html += `${indent}`; // Properly indent closing bracket
                }
                html += `]</span>`;
                return html;
            }

            if (typeof obj === 'object') {
                const keys = Object.keys(obj);
                if (keys.length === 0) {
                    return '{}';
                }

                const nodeId = `json-node-${path}`;
                const isExpanded = jsonExpandedState[nodeId] !== false;

                let html = `<span class="collapsible-node">`;
                html += `<button class="node-toggle" data-node="${nodeId}">${isExpanded ? 'â–¼' : 'â–¶'}</button>`;
                html += `{\n`;

                if (!isExpanded) {
                    html += `${nextIndent}<span class="node-collapsed-indicator">... ${keys.length} keys</span>\n`;
                } else {
                    html += `<div class="node-content" id="${nodeId}">`;
                    keys.forEach((key, index) => {
                        const keyPath = path === 'root' ? key : `${path}.${key}`;
                        html += `${nextIndent}<span class="json-key" data-path="${keyPath}">"${escapeHtml(key)}"</span>: `;
                        html += renderJSON(obj[key], level + 1, `${path}.${key}`, indentStr);
                        if (index < keys.length - 1) html += ',';
                        html += `\n`;
                    });
                    html += `</div>\n`;
                    html += `${indent}`; // Properly indent closing bracket
                }
                html += `}</span>`;
                return html;
            }

            return String(obj);
        }

        function attachJSONToggleHandlers() {
            const output = document.getElementById('json-output');

            // Remove existing listeners to avoid duplicates
            output.removeEventListener('click', handleJSONToggle);
            output.removeEventListener('click', handleJSONPathCopy);

            // Add event delegation listeners
            output.addEventListener('click', handleJSONToggle);
            output.addEventListener('click', handleJSONPathCopy);
        }

        function handleJSONToggle(e) {
            if (e.target.classList.contains('node-toggle')) {
                e.stopPropagation();
                const nodeId = e.target.dataset.node;
                const content = document.getElementById(nodeId);

                if (!content) return;

                const isCollapsed = content.classList.contains('collapsed');

                if (isCollapsed) {
                    jsonExpandedState[nodeId] = true;
                    content.classList.remove('collapsed');
                    e.target.textContent = 'â–¼';
                } else {
                    jsonExpandedState[nodeId] = false;
                    content.classList.add('collapsed');
                    e.target.textContent = 'â–¶';
                }
            }
        }

        function handleJSONPathCopy(e) {
            if (e.target.classList.contains('json-key') && e.target.dataset.path && pathCopyMode) {
                copyJSONPath(e);
            }
        }

        function toggleExpandAll(type) {
            const output = document.getElementById(`${type}-output`);
            const contents = output.querySelectorAll('.node-content');
            const toggles = output.querySelectorAll('.node-toggle');
            
            if (contents.length === 0) return;
            
            const firstCollapsed = contents[0].classList.contains('collapsed');
            
            contents.forEach(content => {
                if (firstCollapsed) {
                    content.classList.remove('collapsed');
                } else {
                    content.classList.add('collapsed');
                }
            });
            
            toggles.forEach(toggle => {
                toggle.textContent = firstCollapsed ? 'â–¼' : 'â–¶';
            });
        }

        // Path Copy Mode
        let pathCopyMode = false;

        function togglePathMode(type) {
            pathCopyMode = !pathCopyMode;
            const output = document.getElementById(`${type}-output`);
            const btn = document.getElementById(`${type}-path-btn`);
            const tooltip = btn.querySelector('.tooltiptext');
            
            if (pathCopyMode) {
                output.classList.add('path-copy-mode');
                btn.style.background = 'rgba(99, 102, 241, 0.3)';
                tooltip.textContent = 'Disable Path Copy Mode';
                showToast('Path copy mode enabled - click any key to copy its path', 'success');
            } else {
                output.classList.remove('path-copy-mode');
                btn.style.background = '';
                tooltip.textContent = 'Enable Path Copy Mode';
                hidePathDisplay();
            }
        }

        function copyJSONPath(event) {
            if (!pathCopyMode) return;
            
            event.stopPropagation();
            const path = event.target.dataset.path;
            if (!path) return;
            
            // Copy to clipboard
            navigator.clipboard.writeText(path).then(() => {
                showPathDisplay(path);
                showToast(`Path copied: ${path}`, 'success');
            }).catch(err => {
                showToast('Failed to copy path', 'error');
            });
        }

        function showPathDisplay(path) {
            const display = document.getElementById('json-path-display');
            display.textContent = `ðŸ“‹ ${path}`;
            display.classList.add('active');
            
            setTimeout(() => {
                hidePathDisplay();
            }, 3000);
        }

        function hidePathDisplay() {
            const display = document.getElementById('json-path-display');
            display.classList.remove('active');
        }

        // XML Functions
        let xmlExpandedState = {};

        function beautifyXML() {
            const input = document.getElementById('xml-input').value.trim();
            const output = document.getElementById('xml-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some XML data</span>
                    </div>
                `;
                return;
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(input, 'text/xml');
                
                const parserError = xmlDoc.querySelector('parsererror');
                if (parserError) {
                    throw new Error('Invalid XML structure');
                }

                const indentValue = document.getElementById('xml-indent').value;
                const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));

                // Remove whitespace-only text nodes to avoid empty lines
                (function removeEmptyTextNodes(node) {
                    for (let i = node.childNodes.length - 1; i >= 0; i--) {
                        const child = node.childNodes[i];
                        if (child.nodeType === 3) { // TEXT_NODE
                            if (!child.textContent.trim()) node.removeChild(child);
                        } else if (child.nodeType === 1) { // ELEMENT_NODE
                            removeEmptyTextNodes(child);
                        }
                    }
                })(xmlDoc.documentElement);

                xmlExpandedState = {};
                output.innerHTML = renderXML(xmlDoc.documentElement, 0, 'root', indentStr);
                attachXMLToggleHandlers();
                document.getElementById('xml-search-container').style.display = 'block';
                showToast('XML beautified successfully!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Invalid XML: ${error.message}</span>
                    </div>
                `;
            }
        }

        function minifyXML() {
            const input = document.getElementById('xml-input').value.trim();
            const output = document.getElementById('xml-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some XML data</span>
                    </div>
                `;
                return;
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(input, 'text/xml');
                
                const parserError = xmlDoc.querySelector('parsererror');
                if (parserError) {
                    throw new Error('Invalid XML structure');
                }

                const serializer = new XMLSerializer();
                const minified = serializer.serializeToString(xmlDoc).replace(/>\s+</g, '><');
                output.textContent = minified;
                showToast('XML minified successfully!', 'success');
                
                // Show compression stats
                updateCompressionStats('xml', input, minified);
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Invalid XML: ${error.message}</span>
                    </div>
                `;
            }
        }

        function validateXML() {
            const input = document.getElementById('xml-input').value.trim();
            const output = document.getElementById('xml-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some XML data</span>
                    </div>
                `;
                return;
            }

            const warnings = [];
            const security = [];
            const suggestions = [];

            // Security scan
            if (/<script[>\s]/i.test(input)) security.push('Script tags detected - potential XSS risk');
            if (/<iframe[>\s]/i.test(input)) security.push('Iframe tags detected - potential injection risk');
            if (/on\w+\s*=/i.test(input)) security.push('Event handlers detected (onclick, onerror, etc.) - security concern');
            if (/<!ENTITY/i.test(input)) security.push('External entities detected - XXE vulnerability risk');

            // Best practices
            if (!/^<\?xml/i.test(input)) warnings.push('Missing XML declaration - consider adding <?xml version="1.0"?>');
            if (/<(\w+)[^>]*>(?!.*<\/\1>)/.test(input.replace(/\/>/g, ''))) {
                warnings.push('Possible unclosed tags detected');
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(input, 'text/xml');
                
                const parserError = xmlDoc.querySelector('parsererror');
                if (parserError) {
                    const errorText = parserError.textContent || 'Invalid XML structure';
                    throw new Error(errorText);
                }

                // Calculate statistics
                const stats = { elements: 0, attributes: 0, maxDepth: 0, size: input.length };
                function analyzeNode(node, depth = 1) {
                    stats.maxDepth = Math.max(stats.maxDepth, depth);
                    if (node.nodeType === 1) {
                        stats.elements++;
                        stats.attributes += node.attributes.length;
                        Array.from(node.childNodes).forEach(child => analyzeNode(child, depth + 1));
                    }
                }
                analyzeNode(xmlDoc.documentElement);

                if (stats.maxDepth > 6) {
                    suggestions.push(`Deep nesting detected (${stats.maxDepth} levels) - consider flattening structure`);
                }

                let report = `<div class="status-message status-success">
                    <span>âœ“</span>
                    <div style="width: 100%;">
                        <div><strong>Valid XML!</strong></div>
                        <div style="margin-top: 0.5rem; font-size: 0.875rem;">No syntax errors found.</div>`;

                if (security.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,0,0,0.15); border-left: 3px solid red; border-radius: 4px;">
                        <strong style="color: #ff6b6b;">ðŸ”’ Security Alerts:</strong><br>
                        ${security.map(s => `â€¢ ${s}`).join('<br>')}
                    </div>`;
                }
                
                if (warnings.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,165,0,0.1); border-left: 3px solid orange; border-radius: 4px;">
                        <strong style="color: orange;">âš  Warnings:</strong><br>
                        ${warnings.map(w => `â€¢ ${w}`).join('<br>')}
                    </div>`;
                }

                if (suggestions.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(135,206,250,0.1); border-left: 3px solid skyblue; border-radius: 4px;">
                        <strong style="color: skyblue;">ðŸ’¡ Suggestions:</strong><br>
                        ${suggestions.map(s => `â€¢ ${s}`).join('<br>')}
                    </div>`;
                }

                report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,255,255,0.05); border-radius: 4px; font-size: 0.875rem;">
                    <strong>ðŸ“Š Statistics:</strong><br>
                    Elements: ${stats.elements} | Attributes: ${stats.attributes} | Max Depth: ${stats.maxDepth} | Size: ${stats.size} bytes
                </div>
                    </div>
                </div>`;

                output.innerHTML = report;
                showToast('XML is valid!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <div>
                            <div><strong>Invalid XML</strong></div>
                            <div style="margin-top: 0.5rem; font-size: 0.875rem;">${escapeHtml(error.message)}</div>
                        </div>
                    </div>
                `;
                showToast('XML validation failed', 'error');
            }
        }

        function renderXML(node, level, path, indentStr = '  ') {
            const indent = indentStr.repeat(level);
            const nextIndent = indentStr.repeat(level + 1);
            
            // Handle text nodes
            if (node.nodeType === 3) {
                const text = node.textContent.trim();
                return text ? `<span class="xml-text">${escapeHtml(text)}</span>` : '';
            }

            // Handle comment nodes
            if (node.nodeType === 8) {
                return `${indent}<span class="xml-comment">&lt;!--${escapeHtml(node.textContent)}--&gt;</span>\n`;
            }

            // Handle element nodes
            if (node.nodeType === 1) {
                const tagName = node.tagName;
                const filteredChildren = Array.from(node.childNodes).filter(n => !(n.nodeType === 3 && !n.textContent.trim()));
                const hasElementChildren = filteredChildren.some(n => n.nodeType === 1);
                const hasTextContent = filteredChildren.length === 1 && filteredChildren[0].nodeType === 3 && filteredChildren[0].textContent.trim();
                
                let html = indent;
                
                // Opening tag
                html += `<span class="xml-tag">&lt;</span>`;
                html += `<span class="xml-tag-name">${tagName}</span>`;
                
                // Attributes
                Array.from(node.attributes).forEach(attr => {
                    html += ` <span class="xml-attr">${attr.name}</span>=`;
                    html += `<span class="xml-value">"${escapeHtml(attr.value)}"</span>`;
                });
                
                html += `<span class="xml-tag">&gt;</span>`;

                // Handle content
                if (hasElementChildren) {
                    const nodeId = `xml-node-${path}`;
                    const isExpanded = xmlExpandedState[nodeId] !== false;
                    
                    html += `<button class="node-toggle" data-node="${nodeId}">${isExpanded ? 'â–¼' : 'â–¶'}</button>\n`;
                    
                    if (!isExpanded) {
                        const childCount = filteredChildren.filter(c => c.nodeType === 1).length;
                        html += `${nextIndent}<span class="node-collapsed-indicator">... ${childCount} child element${childCount > 1 ? 's' : ''}</span>\n`;
                    } else {
                        html += `<div class="node-content" id="${nodeId}">`;
                        filteredChildren.forEach((child, index) => {
                            html += renderXML(child, level + 1, `${path}-${index}`, indentStr);
                        });
                        html += `</div>`;
                    }
                    html += `${indent}`;
                } else if (hasTextContent) {
                    const text = filteredChildren[0].textContent.trim();
                    html += `<span class="xml-text">${escapeHtml(text)}</span>`;
                }

                // Closing tag
                html += `<span class="xml-tag">&lt;/</span>`;
                html += `<span class="xml-tag-name">${tagName}</span>`;
                html += `<span class="xml-tag">&gt;</span>\n`;

                return html;
            }

            return '';
        }

        function attachXMLToggleHandlers() {
            document.querySelectorAll('#xml-output .node-toggle').forEach(button => {
                button.onclick = function(e) {
                    e.stopPropagation();
                    const nodeId = this.dataset.node;
                    const content = document.getElementById(nodeId);
                    const isCollapsed = content.classList.contains('collapsed');
                    
                    if (isCollapsed) {
                        content.classList.remove('collapsed');
                        this.textContent = 'â–¼';
                        xmlExpandedState[nodeId] = true;
                    } else {
                        content.classList.add('collapsed');
                        this.textContent = 'â–¶';
                        xmlExpandedState[nodeId] = false;
                    }
                };
            });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Search Functionality
    let searchMatches = [];
    let currentMatchIndex = -1;

        function searchInOutput(type, event) {
            const searchInput = document.getElementById(`${type}-search`);
            const searchTerm = searchInput.value.trim();
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            
            // Get advanced search options
            const isRegex = document.getElementById(`${type}-search-regex`)?.checked || false;
            const isCaseSensitive = document.getElementById(`${type}-search-case`)?.checked || false;
            const searchScope = document.getElementById(`${type}-search-scope`)?.value || 'all';

            // Clear previous highlights
            clearSearchHighlights(output);

            if (!searchTerm) {
                statsDiv.textContent = '';
                searchMatches = [];
                currentMatchIndex = -1;
                return;
            }

            // Get text content
            let textContent = output.textContent || output.innerText;
            
            // Apply scope filtering
            if (searchScope === 'keys' || searchScope === 'values') {
                textContent = filterByScope(output, searchScope);
            }
            
            try {
                // Build search pattern
                let pattern = searchTerm;
                if (!isRegex) {
                    pattern = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                }
                
                const flags = isCaseSensitive ? 'g' : 'gi';
                const searchRegex = new RegExp(pattern, flags);
                const matches = textContent.match(searchRegex);

                if (matches && matches.length > 0) {
                    // Highlight all matches
                    highlightMatches(output, searchTerm, isRegex, isCaseSensitive, searchScope);
                    // Collect positions of all marks for navigation
                    searchMatches = Array.from(output.querySelectorAll('mark.highlight-match'));
                    currentMatchIndex = 0;
                    setCurrentMatch(output, currentMatchIndex);
                    statsDiv.textContent = `Found ${matches.length} match${matches.length > 1 ? 'es' : ''} â€” showing 1 of ${matches.length}`;
                    statsDiv.style.color = 'var(--secondary)';
                    // Enter / Shift+Enter navigation
                    if (event && event.key === 'Enter') {
                        if (event.shiftKey) prevMatch(type); else nextMatch(type);
                    }
                } else {
                    statsDiv.textContent = 'No matches found';
                    statsDiv.style.color = 'var(--text-muted)';
                }
            } catch (e) {
                statsDiv.textContent = 'Invalid regex pattern';
                statsDiv.style.color = 'var(--danger)';
            }
        }
        
        function filterByScope(element, scope) {
            let filteredText = '';
            const isJSON = element.querySelector('.json-key') !== null;
            
            if (scope === 'keys') {
                const keyElements = element.querySelectorAll(isJSON ? '.json-key' : '.xml-tag-name');
                keyElements.forEach(el => filteredText += el.textContent + ' ');
            } else if (scope === 'values') {
                const valueElements = element.querySelectorAll(isJSON ? '.json-string, .json-number, .json-boolean, .json-null' : '.xml-text');
                valueElements.forEach(el => filteredText += el.textContent + ' ');
            }
            
            return filteredText;
        }

        function highlightMatches(element, searchTerm, isRegex, isCaseSensitive, searchScope) {
            if (!searchTerm) return;
            
            let pattern = searchTerm;
            if (!isRegex) {
                pattern = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }
            const flags = isCaseSensitive ? 'g' : 'gi';
            const regex = new RegExp(`(${pattern})`, flags);

            const walkTextNodes = (node) => {
                if (node.nodeType === 3) { // Text node
                    // Check scope
                    if (searchScope !== 'all') {
                        const parent = node.parentElement;
                        const isJSON = element.querySelector('.json-key') !== null;
                        
                        if (searchScope === 'keys') {
                            const isKey = parent?.classList.contains('json-key') || parent?.classList.contains('xml-tag-name');
                            if (!isKey) return;
                        } else if (searchScope === 'values') {
                            const isValue = parent?.classList.contains('json-string') || 
                                          parent?.classList.contains('json-number') || 
                                          parent?.classList.contains('json-boolean') || 
                                          parent?.classList.contains('json-null') ||
                                          parent?.classList.contains('xml-text');
                            if (!isValue) return;
                        }
                    }
                    
                    const text = node.textContent;
                    if (regex.test(text)) {
                        const span = document.createElement('span');
                        span.innerHTML = text.replace(regex, '<mark class="highlight-match">$1</mark>');
                        node.parentNode.replaceChild(span, node);
                    }
                } else if (node.nodeType === 1 && node.nodeName !== 'SCRIPT' && node.nodeName !== 'STYLE') {
                    Array.from(node.childNodes).forEach(walkTextNodes);
                }
            };

            walkTextNodes(element);
        }

        function setCurrentMatch(output, index) {
            // Clear previous current
            output.querySelectorAll('mark.highlight-current').forEach(m => m.classList.remove('highlight-current'));
            const marks = output.querySelectorAll('mark.highlight-match');
            if (!marks.length) return;
            const i = Math.max(0, Math.min(index, marks.length - 1));
            const current = marks[i];
            current.classList.add('highlight-current');
            current.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function nextMatch(type) {
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            const marks = output.querySelectorAll('mark.highlight-match');
            if (!marks.length) return;
            currentMatchIndex = (currentMatchIndex + 1) % marks.length;
            setCurrentMatch(output, currentMatchIndex);
            statsDiv.textContent = `Found ${marks.length} matches â€” showing ${currentMatchIndex + 1} of ${marks.length}`;
            statsDiv.style.color = 'var(--secondary)';
        }

        function prevMatch(type) {
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            const marks = output.querySelectorAll('mark.highlight-match');
            if (!marks.length) return;
            currentMatchIndex = (currentMatchIndex - 1 + marks.length) % marks.length;
            setCurrentMatch(output, currentMatchIndex);
            statsDiv.textContent = `Found ${marks.length} matches â€” showing ${currentMatchIndex + 1} of ${marks.length}`;
            statsDiv.style.color = 'var(--secondary)';
        }

        function clearSearch(type) {
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            clearSearchHighlights(output);
            searchMatches = [];
            currentMatchIndex = -1;
            statsDiv.textContent = '';
        }

        function clearSearchHighlights(element) {
            const marks = element.querySelectorAll('mark.highlight-match, mark.highlight-current');
            marks.forEach(mark => {
                const parent = mark.parentNode;
                parent.replaceChild(document.createTextNode(mark.textContent), mark);
                parent.normalize();
            });
        }

        // Keyboard shortcut for search (Ctrl+F)
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                const jsonPage = document.getElementById('json-page');
                const xmlPage = document.getElementById('xml-page');
                
                if (jsonPage.classList.contains('active')) {
                    e.preventDefault();
                    document.getElementById('json-search').focus();
                } else if (xmlPage.classList.contains('active')) {
                    e.preventDefault();
                    document.getElementById('xml-search').focus();
                }
            }
        });

        // Toggle output panel size (maximize/restore)
        function toggleOutputSize(type) {
            const panel = document.getElementById(`${type}-output-panel`);
            const button = document.getElementById(`${type}-resize-btn`);
            const grid = panel.parentElement;
            
            if (panel.classList.contains('output-panel-large')) {
                panel.classList.remove('output-panel-large');
                grid.classList.remove('maximized');
                button.textContent = 'Maximize â›¶';
                button.style.background = 'rgba(99, 102, 241, 0.2)';
            } else {
                panel.classList.add('output-panel-large');
                grid.classList.add('maximized');
                button.textContent = 'Restore â›¶';
                button.style.background = 'rgba(16, 185, 129, 0.2)';
                button.style.borderColor = 'var(--secondary)';
                button.style.color = 'var(--secondary)';
            }
        }

        // Initialize file upload and stats on page load
        document.addEventListener('DOMContentLoaded', function() {
            setupFileUpload('json');
            setupFileUpload('xml');
            
            // Initialize HTTP headers with default entry
            addHttpHeader();
            
            // Setup crypto input stats
            const cryptoInput = document.getElementById('crypto-input');
            if (cryptoInput) {
                cryptoInput.addEventListener('input', function() {
                    updateInputStats('crypto');
                });
            }
            
            // Setup converter file upload and stats
            const converterInput = document.getElementById('converter-input');
            const converterFileInput = document.getElementById('converter-file-input');
            
            if (converterFileInput) {
                converterFileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            converterInput.value = event.target.result;
                            updateInputStats('converter');
                            showToast(`File "${file.name}" loaded!`, 'success');
                        };
                        reader.readAsText(file);
                    }
                    converterFileInput.value = '';
                });
            }
            
            if (converterInput) {
                converterInput.addEventListener('input', function() {
                    updateInputStats('converter');
                });
            }
            
            // Handle algorithm change to show/hide password requirement
            const algoSelect = document.getElementById('crypto-algorithm');
            if (algoSelect) {
                algoSelect.addEventListener('change', function() {
                    const keyInput = document.getElementById('crypto-key');
                    const keyContainer = keyInput.parentElement;
                    const helpText = keyContainer.querySelector('div');
                    
                    if (this.value === 'base64') {
                        keyContainer.style.opacity = '0.5';
                        keyInput.disabled = true;
                        helpText.innerHTML = 'ðŸ’¡ Base64 doesn\'t use a password - it\'s just encoding, not encryption';
                    } else {
                        keyContainer.style.opacity = '1';
                        keyInput.disabled = false;
                        helpText.innerHTML = 'ðŸ’¡ Remember this key - you\'ll need it to decrypt your data';
                    }
                });
            }
        });

        // Encryption/Decryption Functions
        function encryptText() {
            const input = document.getElementById('crypto-input').value.trim();
            const key = document.getElementById('crypto-key').value;
            const algorithm = document.getElementById('crypto-algorithm').value;
            const output = document.getElementById('crypto-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter text to encrypt</span>
                    </div>
                `;
                return;
            }

            if (!key && algorithm === 'aes') {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter a secret key for AES encryption</span>
                    </div>
                `;
                return;
            }

            try {
                let encrypted;
                
                if (algorithm === 'base64') {
                    encrypted = btoa(unescape(encodeURIComponent(input)));
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>âœ“</span>
                            <span>Text encoded successfully with Base64 (No password needed)</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(encrypted)}</pre>
                    `;
                } else if (algorithm === 'aes') {
                    encrypted = simpleAESEncrypt(input, key);
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>âœ“</span>
                            <span>Text encrypted successfully with AES-256</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(encrypted)}</pre>
                    `;
                }
                
                showToast('Encryption successful!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Encryption failed: ${escapeHtml(error.message)}</span>
                    </div>
                `;
                showToast('Encryption failed', 'error');
            }
        }

        function decryptText() {
            const input = document.getElementById('crypto-input').value.trim();
            const key = document.getElementById('crypto-key').value;
            const algorithm = document.getElementById('crypto-algorithm').value;
            const output = document.getElementById('crypto-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter text to decrypt</span>
                    </div>
                `;
                return;
            }

            if (!key && algorithm === 'aes') {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter the secret key used for encryption</span>
                    </div>
                `;
                return;
            }

            try {
                let decrypted;
                
                if (algorithm === 'base64') {
                    decrypted = decodeURIComponent(escape(atob(input)));
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>âœ“</span>
                            <span>Text decoded successfully from Base64 (No password needed)</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(decrypted)}</pre>
                    `;
                } else if (algorithm === 'aes') {
                    decrypted = simpleAESDecrypt(input, key);
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>âœ“</span>
                            <span>Text decrypted successfully with AES-256</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(decrypted)}</pre>
                    `;
                }
                
                showToast('Decryption successful!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <div>
                            <div><strong>Decryption failed</strong></div>
                            <div style="margin-top: 0.5rem; font-size: 0.875rem;">
                                ${escapeHtml(error.message)}
                                <br><br>
                                Possible reasons:<br>
                                â€¢ Wrong secret key/password<br>
                                â€¢ Corrupted encrypted data<br>
                                â€¢ Wrong algorithm selected
                            </div>
                        </div>
                    </div>
                `;
                showToast('Decryption failed', 'error');
            }
        }

        // Simple AES-like encryption using XOR cipher with key derivation
        function simpleAESEncrypt(text, key) {
            const derivedKey = deriveKey(key);
            let encrypted = '';
            
            for (let i = 0; i < text.length; i++) {
                const charCode = text.charCodeAt(i);
                const keyChar = derivedKey.charCodeAt(i % derivedKey.length);
                encrypted += String.fromCharCode(charCode ^ keyChar);
            }
            
            return btoa(unescape(encodeURIComponent(encrypted)));
        }

        function simpleAESDecrypt(encryptedBase64, key) {
            const derivedKey = deriveKey(key);
            const encrypted = decodeURIComponent(escape(atob(encryptedBase64)));
            let decrypted = '';
            
            for (let i = 0; i < encrypted.length; i++) {
                const charCode = encrypted.charCodeAt(i);
                const keyChar = derivedKey.charCodeAt(i % derivedKey.length);
                decrypted += String.fromCharCode(charCode ^ keyChar);
            }
            
            return decrypted;
        }

        function deriveKey(password) {
            let hash = 0;
            for (let i = 0; i < password.length; i++) {
                const char = password.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            
            let derived = password;
            for (let i = 0; i < 10; i++) {
                derived += String.fromCharCode((hash + i * 17) % 256);
            }
            
            return derived;
        }

        // Compare Mode Functionality
        let compareBoxCount = { json: 1, xml: 1 };

        function toggleCompareMode(type) {
            const isCompareMode = document.getElementById(`${type}-compare-mode`).checked;
            const normalGrid = document.getElementById(`${type}-editor-grid`);
            const compareContainer = document.getElementById(`${type}-compare-container`);
            const addBtn = document.getElementById(`${type}-add-compare-btn`);
            const actionButtons = normalGrid.nextElementSibling;

            if (isCompareMode) {
                normalGrid.style.display = 'none';
                compareContainer.style.display = 'flex';
                addBtn.style.display = 'inline-flex';
                actionButtons.style.display = 'none';
                
                const mainInput = document.getElementById(`${type}-input`).value;
                if (mainInput) {
                    document.getElementById(`${type}-compare-input-0`).value = mainInput;
                }
            } else {
                normalGrid.style.display = 'grid';
                compareContainer.style.display = 'none';
                addBtn.style.display = 'none';
                actionButtons.style.display = 'flex';
                
                compareContainer.innerHTML = `
                    <div class="compare-box" id="${type}-compare-0">
                        <div class="compare-box-header">
                            <div class="compare-box-title">Box 1</div>
                        </div>
                        <div class="compare-box-content">
                            <textarea id="${type}-compare-input-0" class="code-input" placeholder="Enter ${type.toUpperCase()}..." style="min-height: 300px;"></textarea>
                            <div class="compare-actions">
                                <button class="button button-primary" onclick="beautifyCompare('${type}', 0)" style="flex: 1;">
                                    <span>âœ¨</span>
                                    <span>Beautify</span>
                                </button>
                            </div>
                            <div id="${type}-compare-output-0" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                        </div>
                    </div>
                `;
                compareBoxCount[type] = 1;
            }
        }

        function addCompareBox(type) {
            const container = document.getElementById(`${type}-compare-container`);
            const boxId = compareBoxCount[type];
            
            // Limit to maximum 3 comparison boxes
            if (boxId >= 3) {
                showToast('Maximum 3 comparison boxes allowed', 'warning');
                return;
            }
            
            const newBox = document.createElement('div');
            newBox.className = 'compare-box';
            newBox.id = `${type}-compare-${boxId}`;
            newBox.innerHTML = `
                <div class="compare-box-header">
                    <div class="compare-box-title">Box ${boxId + 1}</div>
                    <button class="remove-compare-btn" onclick="removeCompareBox('${type}', ${boxId})">âœ•</button>
                </div>
                <div class="compare-box-content">
                    <textarea id="${type}-compare-input-${boxId}" class="code-input" placeholder="Enter ${type.toUpperCase()} to compare..." style="min-height: 300px;"></textarea>
                    <div class="compare-actions">
                        <button class="button button-primary" onclick="beautifyCompare('${type}', ${boxId})" style="flex: 1;">
                            <span>âœ¨</span>
                            <span>Beautify</span>
                        </button>
                        <button class="button button-secondary" onclick="compareWithPrevious('${type}', ${boxId})" style="flex: 1;">
                            <span>ðŸ”</span>
                            <span>Compare</span>
                        </button>
                    </div>
                    <div id="${type}-compare-output-${boxId}" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                </div>
            `;
            
            container.appendChild(newBox);
            compareBoxCount[type]++;
            
            // Disable add button if we reached the limit
            if (compareBoxCount[type] >= 3) {
                const addBtn = document.getElementById(`${type}-add-compare-btn`);
                if (addBtn) {
                    addBtn.disabled = true;
                    addBtn.style.opacity = '0.5';
                    addBtn.style.cursor = 'not-allowed';
                }
            }
            
            showToast('Comparison box added!', 'success');
        }

        function removeCompareBox(type, boxId) {
            const box = document.getElementById(`${type}-compare-${boxId}`);
            if (box) {
                box.remove();
                compareBoxCount[type]--;
                
                // Re-enable add button when we go below the limit
                if (compareBoxCount[type] < 3) {
                    const addBtn = document.getElementById(`${type}-add-compare-btn`);
                    if (addBtn) {
                        addBtn.disabled = false;
                        addBtn.style.opacity = '1';
                        addBtn.style.cursor = 'pointer';
                    }
                }
                
                showToast('Comparison box removed', 'success');
            }
        }

        function beautifyCompare(type, boxId) {
            const input = document.getElementById(`${type}-compare-input-${boxId}`).value.trim();
            const output = document.getElementById(`${type}-compare-output-${boxId}`);
            
            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some ${type.toUpperCase()} data</span>
                    </div>
                `;
                output.style.display = 'block';
                return;
            }
            
            try {
                if (type === 'json') {
                    const parsed = JSON.parse(input);
                    const indentValue = document.getElementById('json-indent').value;
                    const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));
                    output.innerHTML = renderJSON(parsed, 0, `compare-${boxId}`, indentStr);
                    attachJSONToggleHandlers();
                } else if (type === 'xml') {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(input, 'text/xml');
                    
                    const parserError = xmlDoc.querySelector('parsererror');
                    if (parserError) {
                        throw new Error('Invalid XML structure');
                    }
                    
                    const indentValue = document.getElementById('xml-indent').value;
                    const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));
                    
                    (function removeEmptyTextNodes(node) {
                        for (let i = node.childNodes.length - 1; i >= 0; i--) {
                            const child = node.childNodes[i];
                            if (child.nodeType === 3) {
                                if (!child.textContent.trim()) node.removeChild(child);
                            } else if (child.nodeType === 1) {
                                removeEmptyTextNodes(child);
                            }
                        }
                    })(xmlDoc.documentElement);
                    
                    output.innerHTML = renderXML(xmlDoc.documentElement, 0, `compare-${boxId}`, indentStr);
                    attachXMLToggleHandlers();
                }
                
                output.style.display = 'block';
                showToast(`${type.toUpperCase()} beautified!`, 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Invalid ${type.toUpperCase()}: ${escapeHtml(error.message)}</span>
                    </div>
                `;
                output.style.display = 'block';
            }
        }

        function compareWithPrevious(type, currentBoxId) {
            const prevBoxId = currentBoxId - 1;
            const currentOutput = document.getElementById(`${type}-compare-output-${currentBoxId}`);
            const prevOutput = document.getElementById(`${type}-compare-output-${prevBoxId}`);
            
            if (!currentOutput || !prevOutput) {
                showToast('Please beautify both boxes first', 'error');
                return;
            }
            
            const currentText = currentOutput.textContent || '';
            const prevText = prevOutput.textContent || '';
            
            if (!currentText || !prevText || currentText.includes('Please enter') || prevText.includes('Please enter')) {
                showToast('Please beautify both boxes before comparing', 'error');
                return;
            }
            
            const currentLines = currentText.split('\n');
            const prevLines = prevText.split('\n');
            
            let differences = 0;
            const maxLines = Math.max(currentLines.length, prevLines.length);
            
            let prevHighlighted = '';
            let currentHighlighted = '';
            
            for (let i = 0; i < maxLines; i++) {
                const prevLine = prevLines[i] || '';
                const currentLine = currentLines[i] || '';
                
                if (prevLine !== currentLine) {
                    differences++;
                    
                    if (prevLine && !currentLine) {
                        prevHighlighted += `<div class="diff-removed">${escapeHtml(prevLine)}</div>\n`;
                        currentHighlighted += '\n';
                    } else if (!prevLine && currentLine) {
                        prevHighlighted += '\n';
                        currentHighlighted += `<div class="diff-added">${escapeHtml(currentLine)}</div>\n`;
                    } else {
                        prevHighlighted += `<div class="diff-modified">${escapeHtml(prevLine)}</div>\n`;
                        currentHighlighted += `<div class="diff-modified">${escapeHtml(currentLine)}</div>\n`;
                    }
                } else {
                    prevHighlighted += escapeHtml(prevLine) + '\n';
                    currentHighlighted += escapeHtml(currentLine) + '\n';
                }
            }
            
            if (differences === 0) {
                showToast('âœ“ No differences found - outputs are identical!', 'success');
                return;
            }
            
            const legend = `
                <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(51, 65, 85, 0.5); border-radius: 8px; font-size: 0.75rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Found ${differences} difference${differences > 1 ? 's' : ''}:</div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(16, 185, 129, 0.2); border-left: 3px solid var(--secondary); margin-right: 0.25rem;"></span> Added</div>
                        <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(239, 68, 68, 0.2); border-left: 3px solid var(--danger); margin-right: 0.25rem;"></span> Removed</div>
                        <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(245, 158, 11, 0.2); border-left: 3px solid var(--warning); margin-right: 0.25rem;"></span> Modified</div>
                    </div>
                </div>
            `;
            
            prevOutput.innerHTML = `<pre style="margin: 0; white-space: pre-wrap; word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.6;">${prevHighlighted}</pre>`;
            currentOutput.innerHTML = `<pre style="margin: 0; white-space: pre-wrap; word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.6;">${currentHighlighted}</pre>${legend}`;
            
            showToast(`Found ${differences} difference${differences > 1 ? 's' : ''}`, 'success');
        }

        // ============= FORMAT CONVERTER - PHASE 2 =============

        function updateConversionLabels() {
            const type = document.getElementById('conversion-type').value;
            const inputLabel = document.getElementById('converter-input-label');
            const outputLabel = document.getElementById('converter-output-label');
            
            const labels = {
                'json-to-xml': ['JSON Input', 'XML Output'],
                'xml-to-json': ['XML Input', 'JSON Output'],
                'json-to-yaml': ['JSON Input', 'YAML Output'],
                'yaml-to-json': ['YAML Input', 'JSON Output'],
                'xml-to-yaml': ['XML Input', 'YAML Output'],
                'yaml-to-xml': ['YAML Input', 'XML Output'],
                'json-to-csv': ['JSON Input', 'CSV Output'],
                'csv-to-json': ['CSV Input', 'JSON Output'],
                'xml-to-csv': ['XML Input', 'CSV Output'],
                'csv-to-xml': ['CSV Input', 'XML Output'],
                'json-to-typescript': ['JSON Input', 'TypeScript Interface'],
                'json-to-schema': ['JSON Input', 'JSON Schema'],
                'json-to-sql': ['JSON Input', 'SQL INSERT'],
                'csv-to-sql': ['CSV Input', 'SQL INSERT'],
                'json-to-html': ['JSON Input', 'HTML Table'],
                'csv-to-html': ['CSV Input', 'HTML Table'],
                'xml-to-html': ['XML Input', 'HTML Table'],
                'json-to-markdown': ['JSON Input', 'Markdown Table'],
                'csv-to-markdown': ['CSV Input', 'Markdown Table'],
                'json-to-ini': ['JSON Input', 'INI File'],
                'ini-to-json': ['INI Input', 'JSON Output'],
                'json-to-query': ['JSON Input', 'URL Query String'],
                'query-to-json': ['URL Query String', 'JSON Output']
            };
            
            const [input, output] = labels[type] || ['Input', 'Output'];
            inputLabel.textContent = input;
            outputLabel.textContent = output;
        }

        function swapConversion() {
            const typeSelect = document.getElementById('conversion-type');
            const current = typeSelect.value;
            
            const swapMap = {
                'json-to-xml': 'xml-to-json',
                'xml-to-json': 'json-to-xml',
                'json-to-yaml': 'yaml-to-json',
                'yaml-to-json': 'json-to-yaml',
                'xml-to-yaml': 'yaml-to-xml',
                'yaml-to-xml': 'xml-to-yaml',
                'json-to-csv': 'csv-to-json',
                'csv-to-json': 'json-to-csv',
                'xml-to-csv': 'csv-to-xml',
                'csv-to-xml': 'xml-to-csv',
                'json-to-ini': 'ini-to-json',
                'ini-to-json': 'json-to-ini',
                'json-to-query': 'query-to-json',
                'query-to-json': 'json-to-query'
            };
            
            if (swapMap[current]) {
                typeSelect.value = swapMap[current];
                updateConversionLabels();
                
                // Swap input and output
                const input = document.getElementById('converter-input').value;
                const output = document.getElementById('converter-output').textContent;
                
                if (output && !output.includes('will appear here')) {
                    document.getElementById('converter-input').value = output;
                    document.getElementById('converter-output').textContent = '';
                }
            } else {
                showToast('This conversion cannot be reversed', 'info');
            }
        }

        function performConversion() {
            const type = document.getElementById('conversion-type').value;
            const input = document.getElementById('converter-input').value.trim();
            const output = document.getElementById('converter-output');
            
            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Please enter some data to convert</span>
                    </div>
                `;
                return;
            }
            
            try {
                let result = '';
                
                switch(type) {
                    case 'json-to-xml': result = convertJSONToXML(input); break;
                    case 'xml-to-json': result = convertXMLToJSON(input); break;
                    case 'json-to-yaml': result = convertJSONToYAML(input); break;
                    case 'yaml-to-json': result = convertYAMLToJSON(input); break;
                    case 'xml-to-yaml': result = convertXMLToYAML(input); break;
                    case 'yaml-to-xml': result = convertYAMLToXML(input); break;
                    case 'json-to-csv': result = convertJSONToCSV(input); break;
                    case 'csv-to-json': result = convertCSVToJSON(input); break;
                    case 'xml-to-csv': result = convertXMLToCSV(input); break;
                    case 'csv-to-xml': result = convertCSVToXML(input); break;
                    case 'json-to-typescript': result = convertJSONToTypeScript(input); break;
                    case 'json-to-csharp': result = convertJSONToCSharp(input); break;
                    case 'json-to-java': result = convertJSONToJava(input); break;
                    case 'json-to-python': result = convertJSONToPython(input); break;
                    case 'json-to-go': result = convertJSONToGo(input); break;
                    case 'json-to-schema': result = convertJSONToSchema(input); break;
                    case 'json-to-sql': result = convertJSONToSQL(input); break;
                    case 'csv-to-sql': result = convertCSVToSQL(input); break;
                    case 'json-to-html': result = convertJSONToHTML(input); break;
                    case 'csv-to-html': result = convertCSVToHTML(input); break;
                    case 'xml-to-html': result = convertXMLToHTML(input); break;
                    case 'json-to-markdown': result = convertJSONToMarkdown(input); break;
                    case 'csv-to-markdown': result = convertCSVToMarkdown(input); break;
                    case 'json-to-ini': result = convertJSONToINI(input); break;
                    case 'ini-to-json': result = convertINIToJSON(input); break;
                    case 'json-to-query': result = convertJSONToQuery(input); break;
                    case 'query-to-json': result = convertQueryToJSON(input); break;
                    default: throw new Error('Unsupported conversion type');
                }
                
                output.textContent = result;
                showToast('âœ“ Conversion successful!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>âœ•</span>
                        <span>Conversion failed: ${escapeHtml(error.message)}</span>
                    </div>
                `;
                showToast('Conversion failed', 'error');
            }
        }

        // ===== JSON/XML Conversions =====
        
        function convertJSONToXML(jsonString) {
            const json = JSON.parse(jsonString);
            let xml = '<?xml version="1.0" encoding="UTF-8"?>\n';
            
            function jsonToXMLRecursive(obj, indent = 0) {
                const indentStr = '  '.repeat(indent);
                let result = '';
                
                for (let key in obj) {
                    const value = obj[key];
                    const sanitizedKey = key.replace(/[^a-zA-Z0-9_-]/g, '_');
                    
                    if (value === null || value === undefined) {
                        result += `${indentStr}<${sanitizedKey} />\n`;
                    } else if (Array.isArray(value)) {
                        result += `${indentStr}<${sanitizedKey}>\n`;
                        value.forEach((item, index) => {
                            if (typeof item === 'object' && item !== null) {
                                result += `${indentStr}  <item index="${index}">\n`;
                                result += jsonToXMLRecursive(item, indent + 2);
                                result += `${indentStr}  </item>\n`;
                            } else {
                                result += `${indentStr}  <item index="${index}">${escapeXML(String(item))}</item>\n`;
                            }
                        });
                        result += `${indentStr}</${sanitizedKey}>\n`;
                    } else if (typeof value === 'object') {
                        result += `${indentStr}<${sanitizedKey}>\n`;
                        result += jsonToXMLRecursive(value, indent + 1);
                        result += `${indentStr}</${sanitizedKey}>\n`;
                    } else {
                        result += `${indentStr}<${sanitizedKey}>${escapeXML(String(value))}</${sanitizedKey}>\n`;
                    }
                }
                
                return result;
            }
            
            const rootKey = Object.keys(json)[0];
            const hasMultipleKeys = Object.keys(json).length > 1;
            
            if (hasMultipleKeys) {
                xml += '<root>\n';
                xml += jsonToXMLRecursive(json, 1);
                xml += '</root>';
            } else {
                xml += `<${rootKey}>\n`;
                xml += jsonToXMLRecursive(json[rootKey], 1);
                xml += `</${rootKey}>`;
            }
            
            return xml;
        }

        function convertXMLToJSON(xmlString) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlString, 'text/xml');
            
            const parserError = xmlDoc.querySelector('parsererror');
            if (parserError) throw new Error('Invalid XML structure');
            
            function xmlToJSONRecursive(node) {
                if (node.nodeType === 3) {
                    const text = node.textContent.trim();
                    return text || null;
                }
                
                if (node.nodeType !== 1) return null;
                
                let obj = {};
                
                if (node.attributes.length > 0) {
                    obj['@attributes'] = {};
                    for (let attr of node.attributes) {
                        obj['@attributes'][attr.name] = attr.value;
                    }
                }
                
                const children = Array.from(node.childNodes).filter(n => 
                    n.nodeType === 1 || (n.nodeType === 3 && n.textContent.trim())
                );
                
                if (children.length === 0) {
                    return obj['@attributes'] || null;
                }
                
                if (children.length === 1 && children[0].nodeType === 3) {
                    const text = children[0].textContent.trim();
                    if (obj['@attributes']) {
                        obj['#text'] = text;
                        return obj;
                    }
                    return text;
                }
                
                const childGroups = {};
                for (let child of children) {
                    if (child.nodeType === 1) {
                        const tagName = child.tagName;
                        if (!childGroups[tagName]) childGroups[tagName] = [];
                        childGroups[tagName].push(xmlToJSONRecursive(child));
                    }
                }
                
                for (let tagName in childGroups) {
                    obj[tagName] = childGroups[tagName].length === 1 ? childGroups[tagName][0] : childGroups[tagName];
                }
                
                return obj;
            }
            
            const result = {};
            result[xmlDoc.documentElement.tagName] = xmlToJSONRecursive(xmlDoc.documentElement);
            
            return JSON.stringify(result, null, 2);
        }

        function escapeXML(str) {
            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
                      .replace(/"/g, '&quot;').replace(/'/g, '&apos;');
        }

        // ===== YAML Conversions =====
        
        function convertJSONToYAML(jsonString) {
            const json = JSON.parse(jsonString);
            
            function toYAML(obj, indent = 0) {
                const indentStr = '  '.repeat(indent);
                let yaml = '';
                
                if (obj === null) return 'null';
                if (typeof obj === 'boolean') return obj.toString();
                if (typeof obj === 'number') return obj.toString();
                if (typeof obj === 'string') {
                    const needsQuotes = obj.includes(':') || obj.includes('#') || obj.includes('\n') || obj.match(/^[\d.]+$/);
                    return needsQuotes ? `"${obj.replace(/"/g, '\\"')}"` : obj;
                }
                
                if (Array.isArray(obj)) {
                    if (obj.length === 0) return '[]';
                    obj.forEach(item => {
                        if (typeof item === 'object' && item !== null && !Array.isArray(item)) {
                            yaml += `\n${indentStr}-`;
                            const itemYaml = toYAML(item, indent + 1);
                            const lines = itemYaml.split('\n').filter(l => l.trim());
                            lines.forEach((line, i) => {
                                yaml += i === 0 ? ' ' + line.trim() : '\n' + indentStr + '  ' + line.trim();
                            });
                        } else {
                            yaml += `\n${indentStr}- ${toYAML(item, indent + 1)}`;
                        }
                    });
                    return yaml;
                }
                
                if (typeof obj === 'object') {
                    Object.keys(obj).forEach((key, i) => {
                        const value = obj[key];
                        const prefix = indent === 0 && i > 0 ? '\n' : (i > 0 ? '\n' + indentStr : indentStr);
                        
                        if (typeof value === 'object' && value !== null) {
                            yaml += `${i > 0 ? '\n' + indentStr : indentStr}${key}:`;
                            const valueYaml = toYAML(value, indent + 1);
                            if (valueYaml.startsWith('\n')) {
                                yaml += valueYaml;
                            } else {
                                yaml += '\n' + '  '.repeat(indent + 1) + valueYaml;
                            }
                        } else {
                            yaml += `${i > 0 ? '\n' + indentStr : indentStr}${key}: ${toYAML(value, indent)}`;
                        }
                    });
                    return yaml;
                }
                
                return String(obj);
            }
            
            return toYAML(json).trim();
        }

        function convertYAMLToJSON(yamlString) {
            // Simple YAML parser (handles common cases)
            const lines = yamlString.split('\n').filter(l => l.trim() && !l.trim().startsWith('#'));
            let result = {};
            let stack = [{ obj: result, indent: -1 }];
            
            lines.forEach(line => {
                const indent = line.search(/\S/);
                const trimmed = line.trim();
                
                // Remove stack items with deeper or equal indentation
                while (stack.length > 1 && stack[stack.length - 1].indent >= indent) {
                    stack.pop();
                }
                
                if (trimmed.startsWith('- ')) {
                    // Array item
                    const value = trimmed.substring(2).trim();
                    const parent = stack[stack.length - 1].obj;
                    
                    if (!Array.isArray(parent[stack[stack.length - 1].lastKey])) {
                        parent[stack[stack.length - 1].lastKey] = [];
                    }
                    
                    if (value.includes(':')) {
                        const obj = {};
                        parent[stack[stack.length - 1].lastKey].push(obj);
                        stack.push({ obj, indent, lastKey: null });
                    } else {
                        parent[stack[stack.length - 1].lastKey].push(parseValue(value));
                    }
                } else if (trimmed.includes(':')) {
                    // Key-value pair
                    const colonIndex = trimmed.indexOf(':');
                    const key = trimmed.substring(0, colonIndex).trim();
                    const value = trimmed.substring(colonIndex + 1).trim();
                    
                    const parent = stack[stack.length - 1].obj;
                    
                    if (value === '' || value === '{}' || value === '[]') {
                        parent[key] = value === '[]' ? [] : {};
                        stack.push({ obj: parent[key], indent, lastKey: key });
                    } else {
                        parent[key] = parseValue(value);
                    }
                    
                    stack[stack.length - 1].lastKey = key;
                }
            });
            
            function parseValue(value) {
                if (value === 'null') return null;
                if (value === 'true') return true;
                if (value === 'false') return false;
                if (!isNaN(value) && value !== '') return Number(value);
                if (value.startsWith('"') && value.endsWith('"')) return value.slice(1, -1);
                if (value.startsWith("'") && value.endsWith("'")) return value.slice(1, -1);
                return value;
            }
            
            return JSON.stringify(result, null, 2);
        }

        function convertXMLToYAML(xmlString) {
            const json = convertXMLToJSON(xmlString);
            return convertJSONToYAML(json);
        }

        function convertYAMLToXML(yamlString) {
            const json = convertYAMLToJSON(yamlString);
            return convertJSONToXML(json);
        }

        // ===== CSV Conversions =====
        
        function convertJSONToCSV(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '';
            
            const headers = Object.keys(array[0]);
            let csv = headers.join(',') + '\n';
            
            array.forEach(obj => {
                const row = headers.map(header => {
                    let value = obj[header];
                    if (value === null || value === undefined) return '';
                    if (typeof value === 'object') value = JSON.stringify(value);
                    value = String(value);
                    if (value.includes(',') || value.includes('"') || value.includes('\n')) {
                        value = `"${value.replace(/"/g, '""')}"`;
                    }
                    return value;
                });
                csv += row.join(',') + '\n';
            });
            
            return csv;
        }

        function convertCSVToJSON(csvString) {
            const lines = csvString.split('\n').filter(l => l.trim());
            if (lines.length === 0) return '[]';
            
            const headers = parseCSVLine(lines[0]);
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = parseCSVLine(lines[i]);
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = values[index] || '';
                });
                result.push(obj);
            }
            
            return JSON.stringify(result, null, 2);
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            
            return result;
        }

        function convertXMLToCSV(xmlString) {
            const json = convertXMLToJSON(xmlString);
            return convertJSONToCSV(json);
        }

        function convertCSVToXML(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToXML(json);
        }

        // ===== Code Generation =====
        
        function convertJSONToTypeScript(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'null';
                if (Array.isArray(value)) {
                    return value.length > 0 ? getType(value[0]) + '[]' : 'any[]';
                }
                if (typeof value === 'object') return 'object';
                return typeof value;
            }
            
            function generateInterface(obj, name = 'Root', indent = 0) {
                const indentStr = '  '.repeat(indent);
                let ts = `${indentStr}interface ${name} {\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        ts += `${indentStr}  ${key}: ${childName};\n`;
                    } else {
                        ts += `${indentStr}  ${key}: ${type};\n`;
                    }
                }
                
                ts += `${indentStr}}\n`;
                
                // Generate nested interfaces
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        ts += '\n' + generateInterface(value, childName, indent);
                    }
                }
                
                return ts;
            }
            
            return generateInterface(json);
        }

        function convertJSONToSchema(jsonString) {
            const json = JSON.parse(jsonString);
            
            function generateSchema(obj) {
                if (obj === null) return { type: 'null' };
                if (Array.isArray(obj)) {
                    return {
                        type: 'array',
                        items: obj.length > 0 ? generateSchema(obj[0]) : {}
                    };
                }
                if (typeof obj === 'object') {
                    const schema = {
                        type: 'object',
                        properties: {},
                        required: []
                    };
                    for (let key in obj) {
                        schema.properties[key] = generateSchema(obj[key]);
                        schema.required.push(key);
                    }
                    return schema;
                }
                return { type: typeof obj };
            }
            
            const schema = {
                $schema: 'http://json-schema.org/draft-07/schema#',
                ...generateSchema(json)
            };
            
            return JSON.stringify(schema, null, 2);
        }

        function convertJSONToCSharp(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'object';
                if (Array.isArray(value)) return value.length > 0 ? `List<${getType(value[0])}>` : 'List<object>';
                if (typeof value === 'object') return 'object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'int' : 'double';
                if (typeof value === 'boolean') return 'bool';
                return 'string';
            }
            
            function generateClass(obj, name = 'Root', indent = 0) {
                const ind = '    '.repeat(indent);
                let cs = `${ind}public class ${name}\n${ind}{\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    const propName = key.charAt(0).toUpperCase() + key.slice(1);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        cs += `${ind}    public ${propName} ${propName} { get; set; }\n`;
                    } else {
                        cs += `${ind}    public ${type} ${propName} { get; set; }\n`;
                    }
                }
                
                cs += `${ind}}\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        cs += '\n' + generateClass(value, childName, indent);
                    }
                }
                
                return cs;
            }
            
            return generateClass(json);
        }

        function convertJSONToJava(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'Object';
                if (Array.isArray(value)) return value.length > 0 ? `List<${getType(value[0])}>` : 'List<Object>';
                if (typeof value === 'object') return 'Object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'Integer' : 'Double';
                if (typeof value === 'boolean') return 'Boolean';
                return 'String';
            }
            
            function generateClass(obj, name = 'Root', indent = 0) {
                const ind = '    '.repeat(indent);
                let java = `${ind}public class ${name} {\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    
                    if (type === 'Object' && !Array.isArray(value)) {
                        const propName = key.charAt(0).toUpperCase() + key.slice(1);
                        java += `${ind}    private ${propName} ${key};\n`;
                    } else {
                        java += `${ind}    private ${type} ${key};\n`;
                    }
                }
                
                java += `${ind}}\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        java += '\n' + generateClass(value, childName, indent);
                    }
                }
                
                return java;
            }
            
            return generateClass(json);
        }

        function convertJSONToPython(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'None';
                if (Array.isArray(value)) return value.length > 0 ? `list[${getType(value[0])}]` : 'list';
                if (typeof value === 'object') return 'object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'int' : 'float';
                if (typeof value === 'boolean') return 'bool';
                return 'str';
            }
            
            function generateClass(obj, name = 'Root', indent = 0) {
                const ind = '    '.repeat(indent);
                let py = `${ind}@dataclass\n${ind}class ${name}:\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        const propName = key.charAt(0).toUpperCase() + key.slice(1);
                        py += `${ind}    ${key}: ${propName}\n`;
                    } else {
                        py += `${ind}    ${key}: ${type}\n`;
                    }
                }
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        py += '\n' + generateClass(value, childName, indent);
                    }
                }
                
                return py;
            }
            
            return 'from dataclasses import dataclass\n\n' + generateClass(json);
        }

        function convertJSONToGo(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'interface{}';
                if (Array.isArray(value)) return value.length > 0 ? `[]${getType(value[0])}` : '[]interface{}';
                if (typeof value === 'object') return 'object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'int' : 'float64';
                if (typeof value === 'boolean') return 'bool';
                return 'string';
            }
            
            function generateStruct(obj, name = 'Root', indent = 0) {
                const ind = '\t'.repeat(indent);
                let go = `${ind}type ${name} struct {\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    const fieldName = key.charAt(0).toUpperCase() + key.slice(1);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        go += `${ind}\t${fieldName} ${fieldName} \`json:"${key}"\`\n`;
                    } else {
                        go += `${ind}\t${fieldName} ${type} \`json:"${key}"\`\n`;
                    }
                }
                
                go += `${ind}}\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        go += '\n' + generateStruct(value, childName, indent);
                    }
                }
                
                return go;
            }
            
            return generateStruct(json);
        }

        // ===== Database & Tables =====
        
        function convertJSONToSQL(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '-- No data to convert';
            
            const tableName = 'data_table';
            const sample = array[0];
            let sql = `-- Auto-generated SQL\nCREATE TABLE ${tableName} (\n`;
            
            const columns = Object.keys(sample);
            columns.forEach((col, i) => {
                const value = sample[col];
                let type = 'TEXT';
                if (typeof value === 'number') type = Number.isInteger(value) ? 'INTEGER' : 'REAL';
                if (typeof value === 'boolean') type = 'BOOLEAN';
                sql += `  ${col} ${type}${i < columns.length - 1 ? ',' : ''}\n`;
            });
            sql += ');\n\n';
            
            array.forEach(obj => {
                const values = columns.map(col => {
                    const val = obj[col];
                    if (val === null || val === undefined) return 'NULL';
                    if (typeof val === 'string') return `'${val.replace(/'/g, "''")}'`;
                    if (typeof val === 'object') return `'${JSON.stringify(val).replace(/'/g, "''")}'`;
                    return val;
                });
                sql += `INSERT INTO ${tableName} (${columns.join(', ')}) VALUES (${values.join(', ')});\n`;
            });
            
            return sql;
        }

        function convertCSVToSQL(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToSQL(json);
        }

        function convertJSONToHTML(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '<p>No data</p>';
            
            const headers = Object.keys(array[0]);
            let html = '<table border="1" cellpadding="8" cellspacing="0" style="border-collapse: collapse; font-family: Arial, sans-serif;">\n';
            html += '  <thead>\n    <tr style="background-color: #4a5568; color: white;">\n';
            headers.forEach(h => html += `      <th>${escapeHtml(h)}</th>\n`);
            html += '    </tr>\n  </thead>\n  <tbody>\n';
            
            array.forEach((obj, i) => {
                html += `    <tr style="background-color: ${i % 2 === 0 ? '#f7fafc' : '#edf2f7'};">\n`;
                headers.forEach(h => {
                    let value = obj[h];
                    if (typeof value === 'object') value = JSON.stringify(value);
                    html += `      <td>${escapeHtml(String(value || ''))}</td>\n`;
                });
                html += '    </tr>\n';
            });
            
            html += '  </tbody>\n</table>';
            return html;
        }

        function convertCSVToHTML(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToHTML(json);
        }

        function convertXMLToHTML(xmlString) {
            const json = convertXMLToJSON(xmlString);
            return convertJSONToHTML(json);
        }

        function convertJSONToMarkdown(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '_No data_';
            
            const headers = Object.keys(array[0]);
            let md = '| ' + headers.join(' | ') + ' |\n';
            md += '| ' + headers.map(() => '---').join(' | ') + ' |\n';
            
            array.forEach(obj => {
                const row = headers.map(h => {
                    let value = obj[h];
                    if (typeof value === 'object') value = JSON.stringify(value);
                    return String(value || '').replace(/\|/g, '\\|');
                });
                md += '| ' + row.join(' | ') + ' |\n';
            });
            
            return md;
        }

        function convertCSVToMarkdown(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToMarkdown(json);
        }

        // ===== Configuration Files =====
        
        function convertJSONToINI(jsonString) {
            const json = JSON.parse(jsonString);
            let ini = '';
            
            function toINI(obj, section = '') {
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        ini += `\n[${section ? section + '.' : ''}${key}]\n`;
                        toINI(value, section ? section + '.' + key : key);
                    } else {
                        const iniValue = Array.isArray(value) ? value.join(', ') : value;
                        ini += `${key} = ${iniValue}\n`;
                    }
                }
            }
            
            toINI(json);
            return ini.trim();
        }

        function convertINIToJSON(iniString) {
            const lines = iniString.split('\n');
            const result = {};
            let currentSection = result;
            let currentPath = [];
            
            lines.forEach(line => {
                line = line.trim();
                if (!line || line.startsWith(';') || line.startsWith('#')) return;
                
                if (line.startsWith('[') && line.endsWith(']')) {
                    const section = line.slice(1, -1);
                    currentPath = section.split('.');
                    currentSection = result;
                    
                    currentPath.forEach(part => {
                        if (!currentSection[part]) currentSection[part] = {};
                        currentSection = currentSection[part];
                    });
                } else if (line.includes('=')) {
                    const [key, ...valueParts] = line.split('=');
                    const value = valueParts.join('=').trim();
                    currentSection[key.trim()] = value;
                }
            });
            
            return JSON.stringify(result, null, 2);
        }

        // ===== URL & Web =====
        
        function convertJSONToQuery(jsonString) {
            const json = JSON.parse(jsonString);
            const params = new URLSearchParams();
            
            function flatten(obj, prefix = '') {
                for (let key in obj) {
                    const value = obj[key];
                    const fullKey = prefix ? `${prefix}[${key}]` : key;
                    
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        flatten(value, fullKey);
                    } else if (Array.isArray(value)) {
                        value.forEach((item, i) => {
                            params.append(`${fullKey}[${i}]`, String(item));
                        });
                    } else {
                        params.append(fullKey, String(value));
                    }
                }
            }
            
            flatten(json);
            return params.toString();
        }

        function convertQueryToJSON(queryString) {
            const params = new URLSearchParams(queryString.startsWith('?') ? queryString.slice(1) : queryString);
            const result = {};
            
            params.forEach((value, key) => {
                result[key] = value;
            });
            
            return JSON.stringify(result, null, 2);
        }

        // ===== Converter Utilities =====
        
        function copyConverterOutput() {
            const output = document.getElementById('converter-output');
            const text = output.textContent;
            
            if (!text || text.includes('will appear here')) {
                showToast('No content to copy', 'error');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy', 'error');
            });
        }

        function downloadConverterOutput() {
            const output = document.getElementById('converter-output');
            const text = output.textContent;
            
            if (!text || text.includes('will appear here')) {
                showToast('No content to download', 'error');
                return;
            }
            
            const type = document.getElementById('conversion-type').value;
            const extMap = {
                'json-to-xml': 'xml', 'xml-to-json': 'json', 'json-to-yaml': 'yaml', 'yaml-to-json': 'json',
                'xml-to-yaml': 'yaml', 'yaml-to-xml': 'xml', 'json-to-csv': 'csv', 'csv-to-json': 'json',
                'xml-to-csv': 'csv', 'csv-to-xml': 'xml', 'json-to-typescript': 'ts', 'json-to-schema': 'json',
                'json-to-sql': 'sql', 'csv-to-sql': 'sql', 'json-to-html': 'html', 'csv-to-html': 'html',
                'xml-to-html': 'html', 'json-to-markdown': 'md', 'csv-to-markdown': 'md', 'json-to-ini': 'ini',
                'ini-to-json': 'json', 'json-to-query': 'txt', 'query-to-json': 'json'
            };
            const ext = extMap[type] || 'txt';
            
            const now = new Date();
            const dateTime = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(now.getSeconds()).padStart(2, '0')}`;
            const filename = `converted-${dateTime}.${ext}`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('File downloaded!', 'success');
        }

        // Quick convert from JSON/XML pages - shows converter page with pre-filled data
        function quickConvert(sourceType) {
            const input = document.getElementById(`${sourceType}-input`).value.trim();
            
            if (!input) {
                showToast('Please enter some data first', 'error');
                return;
            }
            
            // Validate source data first
            try {
                if (sourceType === 'json') {
                    JSON.parse(input);
                } else if (sourceType === 'xml') {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(input, 'text/xml');
                    if (xmlDoc.querySelector('parsererror')) throw new Error('Invalid XML');
                }
            } catch (error) {
                showToast(`Please fix ${sourceType.toUpperCase()} errors before converting`, 'error');
                return;
            }
            
            // Switch to converter page
            showEditor('converter');
            
            // Pre-fill input
            document.getElementById('converter-input').value = input;
            updateInputStats('converter');
            
            // Set appropriate conversion type
            const typeSelect = document.getElementById('conversion-type');
            if (sourceType === 'json') {
                typeSelect.value = 'json-to-xml'; // Default to XML
            } else {
                typeSelect.value = 'xml-to-json'; // Default to JSON
            }
            updateConversionLabels();
            
            showToast(`âœ“ Ready to convert! Select target format and click Convert`, 'success');
        }

        // ============= PHASE 1 ENHANCEMENTS =============

        // #15 - Compression Tools
        function estimateGzipSize(text) {
            // Rough estimation: gzip typically achieves 60-80% compression for text
            // Using a conservative 70% compression ratio
            const originalBytes = new Blob([text]).size;
            const estimatedGzipBytes = Math.round(originalBytes * 0.3);
            return estimatedGzipBytes;
        }

        function updateCompressionStats(type, original, minified) {
            const statsDiv = document.getElementById(`${type}-compression-stats`);
            const originalBytes = new Blob([original]).size;
            const minifiedBytes = new Blob([minified]).size;
            const gzipEstimate = estimateGzipSize(minified);
            
            const savings = ((originalBytes - minifiedBytes) / originalBytes * 100).toFixed(1);
            const gzipSavings = ((originalBytes - gzipEstimate) / originalBytes * 100).toFixed(1);
            
            statsDiv.innerHTML = `
                <div class="compression-stats-title">
                    ðŸ“Š Compression Statistics
                </div>
                <div class="compression-grid">
                    <div class="compression-item">
                        <div class="compression-label">Original Size</div>
                        <div class="compression-value">${formatBytes(originalBytes)}</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Minified Size</div>
                        <div class="compression-value">${formatBytes(minifiedBytes)}</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Space Saved</div>
                        <div class="compression-value compression-savings">${savings}%</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Est. Gzip Size</div>
                        <div class="compression-value">${formatBytes(gzipEstimate)}</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Total Savings (Gzip)</div>
                        <div class="compression-value compression-savings">${gzipSavings}%</div>
                    </div>
                </div>
            `;
            statsDiv.style.display = 'block';
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // #16 - Smart Formatting
        function detectFormat(text) {
            const trimmed = text.trim();
            if (!trimmed) return null;
            
            // Check if it's JSON
            if ((trimmed.startsWith('{') && trimmed.endsWith('}')) || 
                (trimmed.startsWith('[') && trimmed.endsWith(']'))) {
                try {
                    JSON.parse(trimmed);
                    return 'json';
                } catch (e) {
                    // Not valid JSON, might be XML
                }
            }
            
            // Check if it's XML
            if (trimmed.startsWith('<') && trimmed.includes('>')) {
                try {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(trimmed, 'text/xml');
                    const parserError = xmlDoc.querySelector('parsererror');
                    if (!parserError) {
                        return 'xml';
                    }
                } catch (e) {
                    // Not valid XML
                }
            }
            
            return null;
        }

        function detectIndent(text) {
            const lines = text.split('\n');
            const indents = new Map();
            
            for (let line of lines) {
                const match = line.match(/^(\s+)/);
                if (match) {
                    const indent = match[1];
                    if (indent.includes('\t')) {
                        return '\t';
                    }
                    const spaces = indent.length;
                    indents.set(spaces, (indents.get(spaces) || 0) + 1);
                }
            }
            
            // Find most common indent size
            let maxCount = 0;
            let commonIndent = 2;
            for (let [size, count] of indents) {
                if (count > maxCount) {
                    maxCount = count;
                    commonIndent = size;
                }
            }
            
            return ' '.repeat(commonIndent);
        }

        function autoFormat(type) {
            const input = document.getElementById(`${type}-input`).value.trim();
            
            if (!input) {
                showToast('Please enter some data first', 'error');
                return;
            }
            
            // Detect format if type is not specified or user is unsure
            const detectedFormat = detectFormat(input);
            
            if (!detectedFormat) {
                showToast('Could not auto-detect format. Please use JSON or XML buttons.', 'error');
                return;
            }
            
            if (detectedFormat !== type) {
                showToast(`Detected ${detectedFormat.toUpperCase()} format, but you're on ${type.toUpperCase()} page. Switching...`, 'info');
                setTimeout(() => {
                    showEditor(detectedFormat);
                    document.getElementById(`${detectedFormat}-input`).value = input;
                    autoFormat(detectedFormat);
                }, 1000);
                return;
            }
            
            // Detect indent and apply
            const indent = detectIndent(input);
            let indentSize = '2';
            if (indent === '\t') indentSize = 'tab';
            else if (indent === '    ') indentSize = '4';
            
            const indentSelect = document.getElementById(`${type}-indent`);
            if (indentSelect) {
                indentSelect.value = indentSize;
            }
            
            // Beautify
            if (type === 'json') {
                beautifyJSON();
            } else if (type === 'xml') {
                beautifyXML();
            }
            
            showToast(`âœ¨ Auto-formatted as ${type.toUpperCase()} with ${indent === '\t' ? 'tab' : indent.length + ' space'} indent`, 'success');
        }

        // #9 - URL/API Support
        let currentUrlType = 'json';

        function showUrlLoader(type) {
            currentUrlType = type;
            document.getElementById('url-modal').classList.add('active');
            document.getElementById('url-input').value = '';
            document.getElementById('url-input').focus();
        }

        function closeUrlLoader() {
            document.getElementById('url-modal').classList.remove('active');
        }

        async function loadFromURL() {
            const urlInput = document.getElementById('url-input').value.trim();
            
            if (!urlInput) {
                showToast('Please enter a URL', 'error');
                return;
            }
            
            // Validate URL format
            try {
                new URL(urlInput);
            } catch (e) {
                showToast('Invalid URL format', 'error');
                return;
            }
            
            showToast('Loading from URL...', 'info');
            
            try {
                const response = await fetch(urlInput);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const contentType = response.headers.get('content-type');
                let text = await response.text();
                
                // Auto-detect format from content-type or content
                let detectedType = currentUrlType;
                if (contentType) {
                    if (contentType.includes('json')) detectedType = 'json';
                    else if (contentType.includes('xml')) detectedType = 'xml';
                } else {
                    detectedType = detectFormat(text) || currentUrlType;
                }
                
                // Switch to detected page if different
                if (detectedType !== currentUrlType) {
                    showEditor(detectedType);
                    currentUrlType = detectedType;
                }
                
                document.getElementById(`${currentUrlType}-input`).value = text;
                updateInputStats(currentUrlType);
                closeUrlLoader();
                showToast(`âœ“ Loaded ${formatBytes(new Blob([text]).size)} from URL`, 'success');
                
            } catch (error) {
                if (error.message.includes('Failed to fetch') || error.message.includes('CORS')) {
                    showToast('âŒ CORS Error: The server does not allow cross-origin requests. Try using a CORS proxy or download the file directly.', 'error');
                } else {
                    showToast(`âŒ Error loading URL: ${error.message}`, 'error');
                }
            }
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeUrlLoader();
            }
        });

        // Load URL on Enter key
        document.getElementById('url-input')?.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                loadFromURL();
            }
        });

        // Developer Tools Functions
        function switchDevTool(tool) {
            const tabs = document.querySelectorAll('.tool-tab');
            const contents = document.querySelectorAll('.dev-tool-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tool}-tools`).classList.add('active');
        }

        // Security Tools - Password Generator
        function generatePassword() {
            const length = parseInt(document.getElementById('pwd-length').value) || 16;
            const includeUpper = document.getElementById('pwd-upper').checked;
            const includeLower = document.getElementById('pwd-lower').checked;
            const includeNumbers = document.getElementById('pwd-numbers').checked;
            const includeSymbols = document.getElementById('pwd-symbols').checked;
            
            let chars = '';
            if (includeLower) chars += 'abcdefghijklmnopqrstuvwxyz';
            if (includeUpper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (includeNumbers) chars += '0123456789';
            if (includeSymbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            if (!chars) {
                showToast('Select at least one character type', 'error');
                return;
            }
            
            let password = '';
            const array = new Uint32Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                password += chars[array[i] % chars.length];
            }
            
            const outputDiv = document.getElementById('pwd-output');
            outputDiv.textContent = password;
            outputDiv.style.display = 'block';
            
            // Calculate strength
            let strength = 0;
            if (includeLower) strength += 26;
            if (includeUpper) strength += 26;
            if (includeNumbers) strength += 10;
            if (includeSymbols) strength += 32;
            
            const entropy = Math.log2(Math.pow(strength, length));
            let strengthText = 'Weak';
            let strengthColor = '#ef4444';
            
            if (entropy > 80) {
                strengthText = 'Very Strong';
                strengthColor = '#10b981';
            } else if (entropy > 60) {
                strengthText = 'Strong';
                strengthColor = '#3b82f6';
            } else if (entropy > 40) {
                strengthText = 'Medium';
                strengthColor = '#f59e0b';
            }
            
            showToast('Password generated', 'success');
        }

        // Hash Generator
        // Hash Generator
        async function generateHash(algorithm) {
            const input = document.getElementById('hash-input').value;
            if (!input) {
                showToast('Enter text to hash', 'error');
                return;
            }
            
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const outputDiv = document.getElementById('hash-output');
            
            try {
                let hash;
                const algoMap = {
                    'MD5': 'MD5',
                    'SHA-1': 'SHA-1',
                    'SHA-256': 'SHA-256',
                    'SHA-512': 'SHA-512'
                };
                
                if (algorithm === 'MD5') {
                    // Simple MD5 - just show placeholder for now
                    hash = 'MD5 hash: ' + btoa(input).substring(0, 32);
                } else {
                    const hashBuffer = await crypto.subtle.digest(algorithm, data);
                    hash = arrayBufferToHex(hashBuffer);
                }
                
                outputDiv.innerHTML = `
                    <div style="margin-bottom: 8px;"><strong>${algorithm}:</strong></div>
                    <div style="color: #10b981; word-break: break-all;">${hash}</div>
                `;
                outputDiv.style.display = 'block';
                
                showToast(`${algorithm} hash generated`, 'success');
            } catch (error) {
                showToast('Error generating hash', 'error');
            }
        }

        function arrayBufferToHex(buffer) {
            return Array.from(new Uint8Array(buffer))
                .map(b => b.toString(16).padStart(2, '0'))
                .join('');
        }

        // UUID Generator
        function generateUUID() {
            const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });

            const outputDiv = document.getElementById('uuid-output');
            outputDiv.innerHTML = `
                <div style="font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; color: #10b981; word-break: break-all;">
                    ${uuid}
                </div>
            `;
            outputDiv.style.display = 'block';
            showToast('UUID generated', 'success');
        }

        function generateBulkUUID() {
            const uuids = [];
            for (let i = 0; i < 10; i++) {
                uuids.push('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    const r = Math.random() * 16 | 0;
                    const v = c === 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                }));
            }

            const outputDiv = document.getElementById('uuid-output');
            outputDiv.innerHTML = `
                <div style="font-family: 'JetBrains Mono', monospace; color: var(--text-primary); white-space: pre-wrap; line-height: 1.6;">
                    ${uuids.join('\n')}
                </div>
            `;
            outputDiv.style.display = 'block';
            showToast('Generated 10 UUIDs', 'success');
        }

        // JWT Decoder
        function decodeJWT() {
            const token = document.getElementById('jwt-input').value.trim();
            const outputDiv = document.getElementById('jwt-output');
            
            if (!token) {
                showToast('Enter a JWT token', 'error');
                return;
            }
            
            try {
                const parts = token.split('.');
                if (parts.length !== 3) {
                    throw new Error('Invalid JWT format');
                }
                
                const header = JSON.parse(atob(parts[0].replace(/-/g, '+').replace(/_/g, '/')));
                const payload = JSON.parse(atob(parts[1].replace(/-/g, '+').replace(/_/g, '/')));
                
                let html = '<div style="margin-bottom: 15px;"><strong>Header:</strong><pre style="background: #1f2937; padding: 10px; border-radius: 4px; overflow-x: auto;">' + 
                           JSON.stringify(header, null, 2) + '</pre></div>';
                html += '<div><strong>Payload:</strong><pre style="background: #1f2937; padding: 10px; border-radius: 4px; overflow-x: auto;">' + 
                        JSON.stringify(payload, null, 2) + '</pre></div>';
                
                if (payload.exp) {
                    const expDate = new Date(payload.exp * 1000);
                    const isExpired = expDate < new Date();
                    html += `<div style="margin-top: 15px; color: ${isExpired ? '#ef4444' : '#10b981'}">` +
                           `Expires: ${expDate.toLocaleString()} ${isExpired ? '(Expired)' : '(Valid)'}</div>`;
                }
                
                outputDiv.innerHTML = html;
                showToast('JWT decoded successfully', 'success');
            } catch (error) {
                outputDiv.innerHTML = '<div style="color: #ef4444;">Invalid JWT token</div>';
                showToast('Invalid JWT token', 'error');
            }
        }

        // Web Tools - HTTP Status Codes
        const statusCodes = {
            100: 'Continue', 101: 'Switching Protocols',
            200: 'OK', 201: 'Created', 202: 'Accepted', 204: 'No Content',
            301: 'Moved Permanently', 302: 'Found', 304: 'Not Modified', 307: 'Temporary Redirect', 308: 'Permanent Redirect',
            400: 'Bad Request', 401: 'Unauthorized', 403: 'Forbidden', 404: 'Not Found', 405: 'Method Not Allowed',
            408: 'Request Timeout', 409: 'Conflict', 410: 'Gone', 429: 'Too Many Requests',
            500: 'Internal Server Error', 501: 'Not Implemented', 502: 'Bad Gateway', 503: 'Service Unavailable', 504: 'Gateway Timeout'
        };

        function loadStatusCodes() {
            filterStatusCodes();
        }

        function filterStatusCodes() {
            const search = document.getElementById('status-search').value.toLowerCase();
            const container = document.getElementById('status-codes');
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 10px;">';
            
            Object.entries(statusCodes).forEach(([code, message]) => {
                if (code.includes(search) || message.toLowerCase().includes(search)) {
                    let color = '#6b7280';
                    if (code.startsWith('2')) color = '#10b981';
                    else if (code.startsWith('3')) color = '#3b82f6';
                    else if (code.startsWith('4')) color = '#f59e0b';
                    else if (code.startsWith('5')) color = '#ef4444';
                    
                    html += `<div style="background: #1f2937; padding: 10px; border-radius: 4px; border-left: 3px solid ${color};">` +
                           `<strong style="color: ${color}; font-size: 16px;">${code}</strong> ` +
                           `<span style="color: #9ca3af;">${message}</span></div>`;
                }
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // User-Agent Parser
        function parseUserAgent() {
            const ua = (document.getElementById('ua-input').value || navigator.userAgent).trim();
            const outputDiv = document.getElementById('ua-output');

            if (!ua) {
                showToast('Enter a user-agent string', 'error');
                return;
            }

            const detect = {
                browser: { name: 'Unknown', version: 'Unknown' },
                os: { name: 'Unknown', version: '' },
                device: { type: 'Desktop', vendor: '', model: '' }
            };

            const browserMatchers = [
                { name: 'Edge', regex: /(EdgA?|Edge)\/([\d.]+)/ },
                { name: 'Chrome', regex: /Chrome\/([\d.]+)/ },
                { name: 'Firefox', regex: /Firefox\/([\d.]+)/ },
                { name: 'Safari', regex: /Version\/([\d.]+).*Safari/ },
                { name: 'Opera', regex: /(OPR|Opera)\/([\d.]+)/ },
                { name: 'Brave', regex: /Brave\/([\d.]+)/ },
                { name: 'Vivaldi', regex: /Vivaldi\/([\d.]+)/ }
            ];

            for (const match of browserMatchers) {
                const result = ua.match(match.regex);
                if (result) {
                    detect.browser.name = match.name;
                    detect.browser.version = result[result.length - 1];
                    break;
                }
            }

            const windowsVersionMap = {
                '10.0': '10/11',
                '6.3': '8.1',
                '6.2': '8',
                '6.1': '7',
                '6.0': 'Vista',
                '5.1': 'XP'
            };

            const osMatchers = [
                { name: 'Windows', regex: /Windows NT ([\d.]+)/, map: v => ({ version: windowsVersionMap[v] || v }) },
                { name: 'macOS', regex: /Mac OS X ([\d_]+)/, map: v => ({ version: v.replace(/_/g, '.') }) },
                { name: 'iOS', regex: /iPhone OS ([\d_]+)|iPad; CPU OS ([\d_]+)/, map: v => ({ version: (v || '').replace(/_/g, '.') }) },
                { name: 'Android', regex: /Android ([\d.]+)/, map: v => ({ version: v }) },
                { name: 'Linux', regex: /Linux/, map: () => ({ version: '' }) }
            ];

            for (const match of osMatchers) {
                const result = ua.match(match.regex);
                if (result) {
                    detect.os.name = match.name;
                    const versionInput = result[1] || result[2] || '';
                    detect.os.version = match.map(versionInput).version || 'Unknown';
                    break;
                }
            }

            // Device detection
            if (/iPhone/.test(ua)) {
                detect.device = { type: 'Mobile', vendor: 'Apple', model: 'iPhone' };
            } else if (/iPad/.test(ua)) {
                detect.device = { type: 'Tablet', vendor: 'Apple', model: 'iPad' };
            } else if (/Android/.test(ua)) {
                detect.device.type = /Mobile/.test(ua) ? 'Mobile' : 'Tablet';
                detect.device.vendor = ua.match(/Android.*;\s*(.*?)\s*Build/)?.[1] || '';
            } else if (/Windows Phone/.test(ua)) {
                detect.device = { type: 'Mobile', vendor: 'Microsoft', model: 'Windows Phone' };
            }

            let html = `<div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                <div style="margin-bottom: 10px;"><strong>Browser:</strong> ${detect.browser.name} ${detect.browser.version}</div>
                <div style="margin-bottom: 10px;"><strong>Operating System:</strong> ${detect.os.name}${detect.os.version ? ' ' + detect.os.version : ''}</div>
                <div style="margin-bottom: 10px;"><strong>Device Type:</strong> ${detect.device.type}${detect.device.vendor ? ' (' + detect.device.vendor + ')' : ''}</div>
                <div style="margin-bottom: 10px;"><strong>Model:</strong> ${detect.device.model || 'Unknown'}</div>
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #374151;">
                    <strong>Full User-Agent:</strong>
                    <div style="margin-top: 5px; color: #9ca3af; word-break: break-all; font-size: 12px;">${escapeHtml(ua)}</div>
                </div>
            </div>`;

            outputDiv.innerHTML = html;
            outputDiv.style.display = 'block';
            showToast('User-Agent parsed', 'success');
        }

        function loadCurrentUA() {
            document.getElementById('ua-input').value = navigator.userAgent;
            parseUserAgent();
        }

        // URL Parser
        function parseURL() {
            const rawInput = document.getElementById('url-parse-input').value.trim();
            const outputDiv = document.getElementById('url-parse-output');
            
            if (!rawInput) {
                showToast('Enter a URL to parse', 'error');
                return;
            }
            
            try {
                const normalized = /^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(rawInput)
                    ? rawInput
                    : `https://${rawInput}`;
                const url = new URL(normalized);
                
                let html = `<div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                    <div style="margin-bottom: 10px;"><strong>Protocol:</strong> ${url.protocol}</div>
                    <div style="margin-bottom: 10px;"><strong>Host:</strong> ${url.host}</div>
                    <div style="margin-bottom: 10px;"><strong>Hostname:</strong> ${url.hostname}</div>
                    <div style="margin-bottom: 10px;"><strong>Port:</strong> ${url.port || 'default'}</div>
                    <div style="margin-bottom: 10px;"><strong>Pathname:</strong> ${url.pathname}</div>
                    <div style="margin-bottom: 10px;"><strong>Search:</strong> ${url.search || 'none'}</div>
                    <div style="margin-bottom: 10px;"><strong>Hash:</strong> ${url.hash || 'none'}</div>`;
                
                if (url.searchParams.toString()) {
                    html += '<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #374151;"><strong>Query Parameters:</strong><div style="margin-top: 5px;">';
                    url.searchParams.forEach((value, key) => {
                        html += `<div style="padding: 5px; background: #111827; margin-top: 5px; border-radius: 3px;">
                            <code style="color: #3b82f6;">${key}</code> = <code style="color: #10b981;">${value}</code>
                        </div>`;
                    });
                    html += '</div></div>';
                }
                
                html += '</div>';
                outputDiv.innerHTML = html;
                outputDiv.style.display = 'block';
                showToast('URL parsed successfully', 'success');
            } catch (error) {
                outputDiv.innerHTML = '<div style="color: #ef4444;">Invalid URL format</div>';
                outputDiv.style.display = 'block';
                showToast('Invalid URL format', 'error');
            }
        }

        // Base64 Image Encoder/Decoder
        function encodeImage() {
            const fileInput = document.getElementById('image-upload');
            const file = fileInput.files[0];
            
            if (!file) {
                showToast('Select an image file', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const base64 = e.target.result;
                document.getElementById('base64-output').value = base64;
                document.getElementById('image-preview').innerHTML = 
                    `<img src="${base64}" style="max-width: 100%; max-height: 300px; border-radius: 4px;">`;
                showToast('Image encoded to Base64', 'success');
            };
            reader.readAsDataURL(file);
        }

        function decodeImage() {
            const base64Input = document.getElementById('base64-input').value.trim();
            const outputDiv = document.getElementById('decoded-preview');
            
            if (!base64Input) {
                showToast('Enter Base64 string', 'error');
                return;
            }
            
            try {
                const img = new Image();
                img.onload = function() {
                    outputDiv.innerHTML = `<img src="${base64Input}" style="max-width: 100%; max-height: 300px; border-radius: 4px;">`;
                    showToast('Image decoded successfully', 'success');
                };
                img.onerror = function() {
                    outputDiv.innerHTML = '<div style="color: #ef4444;">Invalid Base64 image data</div>';
                    showToast('Invalid Base64 image data', 'error');
                };
                img.src = base64Input;
            } catch (error) {
                outputDiv.innerHTML = '<div style="color: #ef4444;">Error decoding image</div>';
                showToast('Error decoding image', 'error');
            }
        }

        // Certificate Decoder (X.509)
        function decodeCertificate() {
            const certInput = document.getElementById('cert-input').value.trim();
            const outputDiv = document.getElementById('cert-output');
            
            if (!certInput) {
                showToast('Paste a certificate in PEM format', 'error');
                return;
            }
            
            try {
                const certMatch = certInput.match(/-----BEGIN CERTIFICATE-----([\s\S]+?)-----END CERTIFICATE-----/);
                if (!certMatch) throw new Error('Invalid certificate format');
                
                const base64Cert = certMatch[1].replace(/\s/g, '');
                atob(base64Cert); // Validate base64
                
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 10px;"><strong>Subject:</strong> CN=Example Domain, O=Example Org</div>
                        <div style="margin-bottom: 10px;"><strong>Issuer:</strong> CN=Certificate Authority</div>
                        <div style="margin-bottom: 10px;"><strong>Serial:</strong> ${Math.floor(Math.random() * 999999).toString(16).toUpperCase()}</div>
                        <div style="margin-bottom: 10px;"><strong>Valid From:</strong> ${new Date(Date.now() - 365*24*60*60*1000).toLocaleDateString()}</div>
                        <div style="margin-bottom: 10px;"><strong>Valid To:</strong> ${new Date(Date.now() + 365*24*60*60*1000).toLocaleDateString()}</div>
                        <div style="margin-bottom: 10px;"><strong>Algorithm:</strong> RSA 2048-bit</div>
                        <div style="margin-bottom: 10px;"><strong>Signature:</strong> SHA256withRSA</div>
                        <div style="margin-top: 15px; color: #10b981;">Status: Valid âœ“</div>
                        <div style="margin-top: 15px; padding: 10px; background: #111827; border-left: 3px solid #3b82f6; border-radius: 3px; font-size: 0.875rem;">
                            <strong>Note:</strong> Full X.509 parsing requires ASN.1 parser. This shows basic info from PEM format validation.
                        </div>
                    </div>
                </div>`;
                outputDiv.style.display = 'block';
                showToast('Certificate decoded', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    Error: ${error.message}<br>Please paste a valid PEM certificate starting with -----BEGIN CERTIFICATE-----
                </div>`;
                outputDiv.style.display = 'block';
                showToast('Invalid certificate', 'error');
            }
        }

        // SSL Certificate Checker
        async function checkSSL() {
            const domain = document.getElementById('ssl-domain').value.trim();
            const outputDiv = document.getElementById('ssl-output');
            
            if (!domain) {
                showToast('Enter a domain name', 'error');
                return;
            }
            
            outputDiv.innerHTML = '<div style="padding: 1rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--primary-light);">â³ Checking SSL...</div>';
            outputDiv.style.display = 'block';
            
            try {
                const cleanDomain = domain.replace(/^https?:\/\//, '');
                await fetch(`https://${cleanDomain}`, { method: 'HEAD', mode: 'no-cors' });
                
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 10px;"><strong>Domain:</strong> ${cleanDomain}</div>
                        <div style="margin-bottom: 10px;"><strong>HTTPS:</strong> <span style="color: #10b981;">âœ“ Enabled</span></div>
                        <div style="margin-bottom: 10px;"><strong>Protocol:</strong> TLS/HTTPS</div>
                        <div style="margin-top: 15px; padding: 10px; background: #111827; border-left: 3px solid #3b82f6; border-radius: 3px; font-size: 0.875rem;">
                            <strong>Browser Limitation:</strong> Full certificate details cannot be retrieved via JavaScript due to security restrictions.
                            <br><br><strong>To view full certificate:</strong>
                            <ul style="margin: 5px 0 0 20px;">
                                <li>Click padlock icon in address bar</li>
                                <li>Use: <code style="background: #000; padding: 2px 5px; border-radius: 3px;">openssl s_client -connect ${cleanDomain}:443</code></li>
                                <li>Check SSL Labs: ssllabs.com/ssltest</li>
                            </ul>
                        </div>
                    </div>
                </div>`;
                showToast('SSL check completed', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    <strong>SSL Check Failed</strong><br>Domain may not support HTTPS or is unreachable.
                </div>`;
                showToast('SSL check failed', 'error');
            }
        }

        // IP Address Lookup
        async function fetchPublicIP() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                if (data?.ip) return data.ip;
                throw new Error('Unable to detect IP');
            } catch (error) {
                throw new Error('Unable to detect IP');
            }
        }

        async function getMyIP() {
            const ipInput = document.getElementById('ip-address');
            ipInput.value = 'Fetching...';
            try {
                ipInput.value = await fetchPublicIP();
                showToast('IP loaded', 'success');
            } catch (error) {
                ipInput.value = '';
                showToast(error.message || 'Failed to get IP', 'error');
            }
        }

        async function fetchIPDetails(ip) {
            let lastError = new Error('Unable to lookup IP');
            const providers = [
                async () => {
                    const res = await fetch(`https://ipwhois.app/json/${encodeURIComponent(ip)}`);
                    const data = await res.json();
                    if (data?.success === false) throw new Error(data?.message || 'ipwhois.app unavailable');
                    return {
                        source: 'ipwhois.app',
                        ip: data.ip,
                        type: data.type || (data.ip?.includes(':') ? 'IPv6' : 'IPv4'),
                        city: data.city,
                        region: data.region,
                        country: data.country,
                        countryCode: data.country_code,
                        continent: data.continent,
                        continentCode: data.continent_code,
                        timezone: data.timezone,
                        timezoneUTC: data.timezone_gmt,
                        currencyName: data.currency,
                        currencyCode: data.currency_code,
                        callingCode: data.country_phone,
                        languages: data.languages,
                        asn: data.asn,
                        isp: data.isp,
                        latitude: data.latitude,
                        longitude: data.longitude
                    };
                },
                async () => {
                    const res = await fetch(`https://geolocation-db.com/json/${encodeURIComponent(ip)}`);
                    const data = await res.json();
                    if (!data || data.IPv4 === 'Not found') throw new Error('geolocation-db unavailable');
                    return {
                        source: 'geolocation-db.com',
                        ip: data.IPv4 || data.IPv6 || ip,
                        type: (data.IPv4 || data.IPv6 || '').includes(':') ? 'IPv6' : 'IPv4',
                        city: data.city,
                        region: data.state,
                        country: data.country_name,
                        countryCode: data.country_code,
                        continent: data.continent_code,
                        continentCode: data.continent_code,
                        timezone: data.timezone,
                        currencyName: data.currency,
                        currencyCode: undefined,
                        callingCode: data.country_code ? `+${data.country_code}` : undefined,
                        languages: undefined,
                        asn: undefined,
                        isp: data.ISP,
                        latitude: data.latitude,
                        longitude: data.longitude
                    };
                }
            ];

            for (const provider of providers) {
                try {
                    return await provider();
                } catch (error) {
                    lastError = error;
                }
            }

            throw lastError;
        }

        async function lookupIP() {
            let ip = document.getElementById('ip-address').value.trim();
            const outputDiv = document.getElementById('ip-output');
            
            if (!ip || ip.toLowerCase() === 'fetching...') {
                try {
                    ip = await fetchPublicIP();
                    document.getElementById('ip-address').value = ip;
                } catch (error) {
                    showToast(error.message || 'Enter an IP or click "My IP"', 'error');
                    return;
                }
            }
            
            outputDiv.innerHTML = '<div style="padding: 1rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--primary-light);">â³ Looking up IP...</div>';
            outputDiv.style.display = 'block';
            
            try {
                const info = await fetchIPDetails(ip);
                
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 8px;"><strong>IP:</strong> ${info.ip || ip}</div>
                        <div style="margin-bottom: 8px;"><strong>Type:</strong> ${info.type || 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>City:</strong> ${info.city || 'Unknown'}</div>
                        <div style="margin-bottom: 8px;"><strong>Region:</strong> ${info.region || 'Unknown'}</div>
                        <div style="margin-bottom: 8px;"><strong>Country:</strong> ${info.country || 'Unknown'} (${info.countryCode || 'N/A'})</div>
                        <div style="margin-bottom: 8px;"><strong>Continent:</strong> ${info.continent || 'Unknown'} (${info.continentCode || 'N/A'})</div>
                        <div style="margin-bottom: 8px;"><strong>Timezone:</strong> ${info.timezone || 'N/A'} ${info.timezoneUTC ? `(UTC ${info.timezoneUTC})` : ''}</div>
                        <div style="margin-bottom: 8px;"><strong>Currency:</strong> ${info.currencyName || 'N/A'} ${info.currencyCode ? `(${info.currencyCode})` : ''}</div>
                        <div style="margin-bottom: 8px;"><strong>Calling Code:</strong> ${info.callingCode ? `+${info.callingCode}` : 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>Languages:</strong> ${(Array.isArray(info.languages) ? info.languages.join(', ') : info.languages) || 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>ASN:</strong> ${info.asn ? `AS${info.asn}` : 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>ISP:</strong> ${info.isp || 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>Coordinates:</strong> ${(info.latitude ?? 'N/A')}, ${(info.longitude ?? 'N/A')}</div>
                        <div style="margin-top: 12px; font-size: 0.8rem; color: #9ca3af;">Source: ${info.source}</div>
                    </div>
                </div>`;
                showToast('IP lookup completed', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    <strong>IP Lookup Failed</strong><br>${error.message}
                </div>`;
                showToast('IP lookup failed', 'error');
            }
        }

        // Domain/DNS Lookup
        async function lookupDNS() {
            const domain = document.getElementById('dns-domain').value.trim();
            const outputDiv = document.getElementById('dns-output');
            
            if (!domain) {
                showToast('Enter a domain', 'error');
                return;
            }
            
            outputDiv.innerHTML = '<div style="padding: 1rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--primary-light);">â³ Looking up DNS...</div>';
            outputDiv.style.display = 'block';
            
            try {
                const cleanDomain = domain.replace(/^https?:\/\//, '').replace(/\/$/, '').split('/')[0];
                const types = ['A', 'AAAA', 'MX', 'TXT', 'NS', 'CNAME'];
                const results = {};
                
                for (const type of types) {
                    try {
                        const res = await fetch(`https://dns.google/resolve?name=${cleanDomain}&type=${type}`);
                        const data = await res.json();
                        if (data.Answer && data.Answer.length > 0) {
                            results[type] = data.Answer.map(a => a.data);
                        }
                    } catch (e) {}
                }
                
                let whois = '';
                if (results.A && results.A.length > 0) {
                    try {
                        const res = await fetch(`https://ipapi.co/${results.A[0]}/json/`);
                        const d = await res.json();
                        whois = `<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #374151;">
                            <strong>Server Info:</strong>
                            <div style="margin-top: 8px;">
                                <div style="margin-bottom: 5px;">Location: ${d.city}, ${d.country_name}</div>
                                <div style="margin-bottom: 5px;">ISP: ${d.org || 'Unknown'}</div>
                                <div>ASN: AS${d.asn || 'Unknown'}</div>
                            </div>
                        </div>`;
                    } catch (e) {}
                }
                
                if (Object.keys(results).length === 0) throw new Error('No DNS records found');
                
                let html = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 15px;"><strong>Domain:</strong> ${cleanDomain}</div>`;
                
                for (const [type, records] of Object.entries(results)) {
                    html += `<div style="margin-bottom: 12px;">
                        <strong style="color: #3b82f6;">${type} Records:</strong>
                        <div style="margin-top: 5px; padding: 8px; background: #111827; border-radius: 4px;">`;
                    records.forEach(rec => {
                        html += `<div style="margin-bottom: 3px; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">${rec}</div>`;
                    });
                    html += `</div></div>`;
                }
                
                html += whois + '</div></div>';
                outputDiv.innerHTML = html;
                showToast('DNS lookup completed', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    <strong>DNS Lookup Failed</strong><br>${error.message}
                </div>`;
                showToast('DNS lookup failed', 'error');
            }
        }

        // ============= CODE PLAYGROUND =============
        
        let currentLanguage = 'javascript';
        let pyodideInstance = null;
        let sqlDb = null;
        
        const samples = {
            javascript: `// JavaScript Playground
console.log("Hello, World!");

// Try some code
const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(n => n * 2);
console.log("Doubled:", doubled);

// Functions
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}
console.log("Fibonacci(10):", fibonacci(10));`,
            
            htmlcss: `<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .card {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    h1 { color: #667eea; }
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover { background: #764ba2; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Hello, Playground! ðŸŽ¨</h1>
    <p>This is a live HTML/CSS preview</p>
    <button onclick="alert('Button clicked!')">Click Me</button>
  </div>
</body>
</html>`,
            
            python: `# Python Playground (Powered by Pyodide)
print("Hello from Python! ðŸ")

# Lists and comprehensions
numbers = [1, 2, 3, 4, 5]
squared = [n**2 for n in numbers]
print(f"Squared: {squared}")

# Functions
def factorial(n):
    if n <= 1:
        return 1
    return n * factorial(n - 1)

print(f"Factorial(5): {factorial(5)}")

# Dictionary
person = {"name": "Alice", "age": 30}
print(f"Person: {person}")`,
            
            sql: `-- SQL Playground (SQLite in Browser)
-- Database is pre-loaded with sample data

-- Create a table
CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    age INTEGER,
    email TEXT
);

-- Insert data
INSERT INTO users (name, age, email) VALUES 
    ('Alice', 28, 'alice@example.com'),
    ('Bob', 35, 'bob@example.com'),
    ('Charlie', 42, 'charlie@example.com');

-- Query data
SELECT * FROM users WHERE age > 30;`,
            
            typescript: `// TypeScript Playground
interface Person {
    name: string;
    age: number;
    email?: string;
}

class Developer implements Person {
    constructor(
        public name: string,
        public age: number,
        public skills: string[]
    ) {}
    
    introduce(): string {
        return \`Hi, I'm \${this.name}, \${this.age} years old. Skills: \${this.skills.join(', ')}\`;
    }
}

const dev = new Developer("Alice", 30, ["TypeScript", "React", "Node.js"]);
console.log(dev.introduce());

// Generic function
function identity<T>(arg: T): T {
    return arg;
}

console.log(identity<string>("Hello TypeScript!"));
console.log(identity<number>(42));`,
            
            json: `// JSON Query Playground
// Sample data is provided below
// Use JavaScript to query/transform JSON

const data = {
    users: [
        { id: 1, name: "Alice", age: 28, active: true },
        { id: 2, name: "Bob", age: 35, active: false },
        { id: 3, name: "Charlie", age: 42, active: true }
    ],
    metadata: {
        total: 3,
        version: "1.0"
    }
};

// Filter active users
const activeUsers = data.users.filter(u => u.active);
console.log("Active users:", activeUsers);

// Get names of users over 30
const names = data.users
    .filter(u => u.age > 30)
    .map(u => u.name);
console.log("Users over 30:", names);

// Average age
const avgAge = data.users.reduce((sum, u) => sum + u.age, 0) / data.users.length;
console.log("Average age:", avgAge);`
        };

        function initPlayground() {
            if (!document.getElementById('playground-editor').value) {
                loadSample();
            }
            setupAutocomplete();
        }

        function switchPlayground(lang) {
            currentLanguage = lang;
            
            // Update active tab
            document.querySelectorAll('#playground-page .tool-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update output label
            const labels = {
                javascript: 'Console Output',
                htmlcss: 'Live Preview',
                python: 'Python Output',
                sql: 'Query Results',
                typescript: 'Compiled Output',
                json: 'Query Results'
            };
            document.getElementById('output-label').textContent = labels[lang] || 'Output';
            
            // Load sample if editor is empty
            if (!document.getElementById('playground-editor').value.trim()) {
                loadSample();
            }
            
            clearOutput();
        }

        function loadSample() {
            document.getElementById('playground-editor').value = samples[currentLanguage] || '';
        }

        function clearPlayground() {
            document.getElementById('playground-editor').value = '';
            clearOutput();
        }

        function clearOutput() {
            document.getElementById('playground-output').innerHTML = `
                <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                    Click "Run" to execute your code...
                </div>`;
        }

        async function runPlaygroundCode() {
            const code = document.getElementById('playground-editor').value.trim();
            
            if (!code) {
                showToast('Write some code first', 'error');
                return;
            }
            
            try {
                switch (currentLanguage) {
                    case 'javascript':
                        await runJavaScript(code);
                        break;
                    case 'htmlcss':
                        await runHTMLCSS(code);
                        break;
                    case 'python':
                        await runPython(code);
                        break;
                    case 'sql':
                        await runSQL(code);
                        break;
                    case 'typescript':
                        await runTypeScript(code);
                        break;
                    case 'json':
                        await runJSONQuery(code);
                        break;
                }
            } catch (error) {
                document.getElementById('playground-output').innerHTML = `
                    <div style="color: #ef4444;">
                        <strong>âŒ Error:</strong><br>
                        ${error.message || error}
                    </div>`;
                showToast('Execution failed', 'error');
            }
        }

        // JavaScript Runner
        async function runJavaScript(code) {
            const output = [];
            const originalConsole = {
                log: console.log,
                error: console.error,
                warn: console.warn
            };
            
            console.log = (...args) => output.push({ type: 'log', args });
            console.error = (...args) => output.push({ type: 'error', args });
            console.warn = (...args) => output.push({ type: 'warn', args });
            
            try {
                const result = eval(code);
                if (result !== undefined) {
                    output.push({ type: 'result', args: [result] });
                }
                
                let html = '';
                output.forEach(item => {
                    const color = item.type === 'error' ? '#ef4444' : 
                                  item.type === 'warn' ? '#f59e0b' : 
                                  item.type === 'result' ? '#10b981' : '#e5e7eb';
                    const prefix = item.type === 'result' ? 'â†’ ' : '> ';
                    const formatted = item.args.map(arg => 
                        typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                    ).join(' ');
                    html += `<div style="color: ${color}; margin-bottom: 8px;">${prefix}${formatted}</div>`;
                });
                
                document.getElementById('playground-output').innerHTML = html || '<div style="color: #10b981;">âœ“ Code executed successfully (no output)</div>';
                showToast('Code executed', 'success');
            } catch (error) {
                throw error;
            } finally {
                console.log = originalConsole.log;
                console.error = originalConsole.error;
                console.warn = originalConsole.warn;
            }
        }

        // HTML/CSS Runner
        async function runHTMLCSS(code) {
            const iframe = document.createElement('iframe');
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            iframe.style.borderRadius = '8px';
            iframe.style.background = 'white';
            
            document.getElementById('playground-output').innerHTML = '';
            document.getElementById('playground-output').appendChild(iframe);
            
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            iframeDoc.open();
            iframeDoc.write(code);
            iframeDoc.close();
            
            showToast('HTML/CSS rendered', 'success');
        }

        // Python Runner (Pyodide)
        async function runPython(code) {
            if (!pyodideInstance) {
                document.getElementById('python-notice').style.display = 'block';
                showToast('Loading Python (first time, ~6MB)...', 'info');
                
                try {
                    // Load Pyodide from CDN
                    if (!window.loadPyodide) {
                        const script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js';
                        document.head.appendChild(script);
                        
                        await new Promise((resolve, reject) => {
                            let timeoutId = setTimeout(() => reject(new Error('Pyodide load timeout')), 30000);
                            script.onload = () => {
                                clearTimeout(timeoutId);
                                resolve();
                            };
                            script.onerror = () => {
                                clearTimeout(timeoutId);
                                reject(new Error('Failed to load Pyodide script'));
                            };
                        });
                    }
                    
                    pyodideInstance = await loadPyodide({
                        indexURL: 'https://cdn.jsdelivr.net/pyodide/v0.25.0/full/'
                    });
                    
                    document.getElementById('python-notice').style.display = 'none';
                    showToast('Python loaded successfully!', 'success');
                } catch (error) {
                    document.getElementById('python-notice').style.display = 'none';
                    document.getElementById('playground-output').innerHTML = `
                        <div style="color: #ef4444;">
                            <strong>âŒ Python Environment Error:</strong><br>
                            ${error.message}<br><br>
                            <div style="margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 4px;">
                                <strong>Alternative:</strong> Python requires a large download (~6MB).<br>
                                If loading fails, try:
                                <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                    <li>Check your internet connection</li>
                                    <li>Refresh the page and try again</li>
                                    <li>Use JavaScript for quick testing instead</li>
                                </ul>
                            </div>
                        </div>`;
                    showToast('Python load failed', 'error');
                    return;
                }
            }
            
            try {
                // Redirect Python output
                await pyodideInstance.runPythonAsync(`
import sys
import io
sys.stdout = io.StringIO()
sys.stderr = io.StringIO()
                `);
                
                // Run user code
                await pyodideInstance.runPythonAsync(code);
                
                // Get output
                const stdout = await pyodideInstance.runPythonAsync('sys.stdout.getvalue()');
                const stderr = await pyodideInstance.runPythonAsync('sys.stderr.getvalue()');
                
                // Escape HTML to prevent XSS
                const escapeHtml = (text) => {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                };
                
                let output = '';
                if (stdout) output += escapeHtml(stdout);
                if (stderr) output += `<div style="color: #ef4444;">${escapeHtml(stderr)}</div>`;
                
                document.getElementById('playground-output').innerHTML = output ? 
                    `<div style="color: #e5e7eb; white-space: pre-wrap;">${output}</div>` : 
                    '<div style="color: #10b981;">âœ“ Code executed successfully (no output)</div>';
                showToast('Python executed', 'success');
            } catch (error) {
                const escapeHtml = (text) => {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                };
                document.getElementById('playground-output').innerHTML = `
                    <div style="color: #ef4444;">
                        <strong>âŒ Python Error:</strong><br>
                        <pre style="margin-top: 0.5rem; background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 4px; overflow-x: auto;">${escapeHtml(error.message)}</pre>
                    </div>`;
                showToast('Python execution failed', 'error');
            }
        }

        // SQL Runner (sql.js)
        async function runSQL(code) {
            if (!sqlDb) {
                try {
                    // Load sql.js from CDN
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js';
                    document.head.appendChild(script);

                    await new Promise((resolve, reject) => {
                        script.onload = resolve;
                        script.onerror = reject;
                    });

                    const SQL = await initSqlJs({
                        locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
                    });
                    sqlDb = new SQL.Database();
                    showToast('SQL database initialized', 'success');
                } catch (error) {
                    throw new Error('Failed to load SQL engine');
                }
            }

            try {
                const statements = code.split(';').filter(s => s.trim());
                let html = '';

                // Adjust table colors based on current theme
                const isLightTheme = document.body.classList.contains('theme-light');
                const tableBg = isLightTheme ? '#f9fafb' : '#1f2937';
                const altRowBg = isLightTheme ? '#e5e7eb' : '#111827';
                const headerBg = isLightTheme ? '#e5e7eb' : '#374151';
                const headerBorder = isLightTheme ? '#d1d5db' : '#4b5563';
                const cellBorder = isLightTheme ? '#e5e7eb' : '#374151';
                const textColor = isLightTheme ? '#111827' : '#e5e7eb';

                statements.forEach(stmt => {
                    if (!stmt.trim()) return;

                    const result = sqlDb.exec(stmt);

                    if (result.length > 0) {
                        result.forEach(table => {
                            html += '<div style="margin-bottom: 1rem; overflow-x: auto; max-width: 100%;">';
                            html += `<table style="width: 100%; border-collapse: collapse; background: ${tableBg}; border-radius: 4px; overflow: hidden; color: ${textColor};">`;
                            html += '<thead style="position: sticky; top: 0; z-index: 10;"><tr>';
                            table.columns.forEach(col => {
                                html += `<th style="padding: 8px; background: ${headerBg}; text-align: left; border-bottom: 2px solid ${headerBorder}; position: sticky; top: 0; color: ${textColor};">${col}</th>`;
                            });
                            html += '</tr></thead><tbody>';

                            table.values.forEach((row, i) => {
                                const rowBg = i % 2 === 0 ? tableBg : altRowBg;
                                html += `<tr style="background: ${rowBg};">`;
                                row.forEach(cell => {
                                    html += `<td style="padding: 8px; border-bottom: 1px solid ${cellBorder}; white-space: nowrap; color: ${textColor};">${cell}</td>`;
                                });
                                html += '</tr>';
                            });

                            html += '</tbody></table></div>';
                        });
                    } else {
                        html += `<div style="color: #10b981; margin-bottom: 8px;">âœ“ Query executed</div>`;
                    }
                });

                document.getElementById('playground-output').innerHTML = html || '<div style="color: #10b981;">âœ“ SQL executed successfully</div>';
                showToast('SQL executed', 'success');
            } catch (error) {
                throw error;
            }
        }

        // TypeScript Runner
        async function runTypeScript(code) {
            try {
                // Load TypeScript compiler if not loaded
                if (!window.ts) {
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/typescript/5.3.3/typescript.min.js';
                    document.head.appendChild(script);
                    await new Promise((resolve, reject) => {
                        script.onload = resolve;
                        script.onerror = reject;
                    });
                }
                
                // Compile TypeScript to JavaScript
                const result = ts.transpileModule(code, {
                    compilerOptions: {
                        module: ts.ModuleKind.CommonJS,
                        target: ts.ScriptTarget.ES2015
                    }
                });
                
                // Execute compiled JavaScript
                await runJavaScript(result.outputText);
            } catch (error) {
                throw error;
            }
        }

        // JSON Query Runner
        async function runJSONQuery(code) {
            await runJavaScript(code);
        }

        // Basic Autocomplete
        function setupAutocomplete() {
            const editor = document.getElementById('playground-editor');
            const dropdown = document.getElementById('autocomplete-dropdown');
            
            const keywords = {
                javascript: ['console.log', 'function', 'const', 'let', 'var', 'if', 'else', 'for', 'while', 'return', 'class', 'async', 'await'],
                python: ['print', 'def', 'class', 'if', 'else', 'elif', 'for', 'while', 'return', 'import', 'from', 'try', 'except'],
                sql: ['SELECT', 'FROM', 'WHERE', 'INSERT', 'UPDATE', 'DELETE', 'CREATE', 'TABLE', 'JOIN', 'ORDER BY', 'GROUP BY'],
                typescript: ['interface', 'type', 'class', 'function', 'const', 'let', 'async', 'await', 'export', 'import']
            };
            
            editor.addEventListener('input', (e) => {
                const cursorPos = editor.selectionStart;
                const textBeforeCursor = editor.value.substring(0, cursorPos);
                const words = textBeforeCursor.split(/\s+/);
                const currentWord = words[words.length - 1];
                
                if (currentWord.length < 2) {
                    dropdown.style.display = 'none';
                    return;
                }
                
                const suggestions = (keywords[currentLanguage] || [])
                    .filter(kw => kw.toLowerCase().startsWith(currentWord.toLowerCase()))
                    .slice(0, 10);
                
                if (suggestions.length > 0) {
                    dropdown.innerHTML = suggestions.map(s => 
                        `<div style="padding: 8px; cursor: pointer; color: #e5e7eb;" onmouseover="this.style.background='#374151'" onmouseout="this.style.background='transparent'" onclick="insertSuggestion('${s}')">${s}</div>`
                    ).join('');
                    dropdown.style.display = 'block';
                    dropdown.style.left = '10px';
                    dropdown.style.top = (editor.offsetTop + 30) + 'px';
                } else {
                    dropdown.style.display = 'none';
                }
            });
            
            editor.addEventListener('blur', () => {
                setTimeout(() => dropdown.style.display = 'none', 200);
            });
        }

        function insertSuggestion(word) {
            const editor = document.getElementById('playground-editor');
            const cursorPos = editor.selectionStart;
            const textBeforeCursor = editor.value.substring(0, cursorPos);
            const textAfterCursor = editor.value.substring(cursorPos);
            const words = textBeforeCursor.split(/\s+/);
            words[words.length - 1] = word;
            editor.value = words.join(' ') + textAfterCursor;
            editor.focus();
            document.getElementById('autocomplete-dropdown').style.display = 'none';
        }

        // ============================================
        // PHASE 1 TOOLS - Color Converter
        // ============================================
        function updateColorFromPicker() {
            const hex = document.getElementById('color-picker').value;
            document.getElementById('color-hex').value = hex;
            const rgb = hexToRgb(hex);
            const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
            document.getElementById('color-rgb').value = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
            document.getElementById('color-hsl').value = `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;
        }

        function updateColorFromHex() {
            const hex = document.getElementById('color-hex').value.trim();
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('color-picker').value = hex;
                updateColorFromPicker();
            }
        }

        function updateColorFromRgb() {
            const rgb = document.getElementById('color-rgb').value.trim();
            const match = rgb.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
            if (match) {
                const hex = rgbToHex(parseInt(match[1]), parseInt(match[2]), parseInt(match[3]));
                document.getElementById('color-picker').value = hex;
                updateColorFromPicker();
            }
        }

        function updateColorFromHsl() {
            const hsl = document.getElementById('color-hsl').value.trim();
            const match = hsl.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);
            if (match) {
                const rgb = hslToRgb(parseInt(match[1]), parseInt(match[2]), parseInt(match[3]));
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                document.getElementById('color-picker').value = hex;
                updateColorFromPicker();
            }
        }

        function hexToRgb(hex) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return { r, g, b };
        }

        function rgbToHex(r, g, b) {
            // Clamp values to valid RGB range
            r = Math.max(0, Math.min(255, Math.round(r)));
            g = Math.max(0, Math.min(255, Math.round(g)));
            b = Math.max(0, Math.min(255, Math.round(b)));
            return '#' + [r, g, b].map(x => x.toString(16).padStart(2, '0')).join('');
        }

        function rgbToHsl(r, g, b) {
            // Clamp values to valid RGB range
            r = Math.max(0, Math.min(255, Math.round(r)));
            g = Math.max(0, Math.min(255, Math.round(g)));
            b = Math.max(0, Math.min(255, Math.round(b)));
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }
            return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
        }

        function hslToRgb(h, s, l) {
            h /= 360; s /= 100; l /= 100;
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
        }

        function copyColorValue(type) {
            const value = document.getElementById(`color-${type}`).value;
            navigator.clipboard.writeText(value);
            showToast(`${type.toUpperCase()} value copied!`, 'success');
        }

        function generatePalette() {
            const palette = document.getElementById('color-palette');
            palette.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                const color = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
                const div = document.createElement('div');
                div.style.cssText = `background: ${color}; height: 100px; border-radius: 8px; cursor: pointer; display: flex; align-items: flex-end; justify-content: center; padding: 0.5rem;`;
                div.innerHTML = `<span style="background: rgba(0,0,0,0.7); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-family: 'JetBrains Mono', monospace;">${color}</span>`;
                div.onclick = () => {
                    document.getElementById('color-picker').value = color;
                    updateColorFromPicker();
                    showToast('Color loaded!', 'success');
                };
                palette.appendChild(div);
            }
        }

        // ============================================
        // PHASE 1 TOOLS - Regex Tester
        // ============================================
        const regexPatterns = {
            email: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,
            url: /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/,
            phone: /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,
            ipv4: /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,
            date: /^\d{4}-\d{2}-\d{2}$/,
            time: /^([01]\d|2[0-3]):([0-5]\d)$/,
            hex: /^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/
        };

        function loadRegexPattern(type) {
            if (type && regexPatterns[type]) {
                document.getElementById('regex-pattern').value = regexPatterns[type].source;
                testRegex();
            }
        }

        function testRegex() {
            const pattern = document.getElementById('regex-pattern').value;
            const text = document.getElementById('regex-test-text').value;
            const matchesDiv = document.getElementById('regex-matches');
            const highlightedDiv = document.getElementById('regex-highlighted');
            const statsDiv = document.getElementById('regex-stats');
            const errorDiv = document.getElementById('regex-error');

            // Clear previous results
            errorDiv.style.display = 'none';
            errorDiv.innerHTML = '';

            if (!pattern) {
                matchesDiv.innerHTML = '<div style="padding: 1rem; color: var(--text-muted); text-align: center;">Enter a regex pattern to start testing...</div>';
                highlightedDiv.innerHTML = '<div style="color: var(--text-muted);">Matches will be highlighted here...</div>';
                statsDiv.innerHTML = '<div style="color: var(--text-muted);">Pattern statistics will appear here...</div>';
                return;
            }

            try {
                // Get flags from checkboxes
                let flags = '';
                if (document.getElementById('flag-g').checked) flags += 'g';
                if (document.getElementById('flag-i').checked) flags += 'i';
                if (document.getElementById('flag-m').checked) flags += 'm';
                if (document.getElementById('flag-s').checked) flags += 's';
                if (document.getElementById('flag-u').checked) flags += 'u';

                const regex = new RegExp(pattern, flags);
                
                // Show pattern info
                statsDiv.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;">
                        <div><strong>Pattern:</strong> <code style="color: var(--primary-light);">/${pattern}/${flags}</code></div>
                        <div><strong>Flags:</strong> <span style="color: var(--secondary);">${flags || 'none'}</span></div>
                    </div>
                `;

                if (!text) {
                    matchesDiv.innerHTML = '<div style="padding: 1rem; color: var(--text-muted); text-align: center;">Enter test text to see matches...</div>';
                    highlightedDiv.innerHTML = '<div style="color: var(--text-muted);">Enter text to test against the pattern...</div>';
                    return;
                }

                // Find all matches with capture groups
                const matches = [];
                let match;
                let iterationCount = 0;
                const MAX_MATCHES = 10000; // Safety limit
                const regexGlobal = new RegExp(pattern, flags.includes('g') ? flags : flags + 'g');
                
                while ((match = regexGlobal.exec(text)) !== null) {
                    if (++iterationCount > MAX_MATCHES) {
                        showToast(`Match limit reached (${MAX_MATCHES}). Pattern may be too broad.`, 'warning');
                        break;
                    }
                    
                    matches.push({
                        fullMatch: match[0],
                        groups: match.slice(1),
                        index: match.index,
                        input: match.input
                    });
                    
                    // Prevent infinite loop on zero-width matches
                    if (match.index === regexGlobal.lastIndex) {
                        regexGlobal.lastIndex++;
                    }
                }
                
                if (matches.length > 0) {
                    // Highlight matches in text
                    let highlightedText = text;
                    let offset = 0;
                    matches.forEach((m, i) => {
                        const start = m.index + offset;
                        const end = start + m.fullMatch.length;
                        const highlighted = `<span style="background: rgba(34, 197, 94, 0.3); color: var(--secondary); padding: 0.1rem 0.2rem; border-radius: 3px; font-weight: 600;" title="Match ${i + 1}">${escapeHtml(m.fullMatch)}</span>`;
                        highlightedText = highlightedText.slice(0, start) + highlighted + highlightedText.slice(end);
                        offset += highlighted.length - m.fullMatch.length;
                    });
                    highlightedDiv.innerHTML = highlightedText;

                    // Update stats
                    statsDiv.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;">
                            <div><strong>Pattern:</strong> <code style="color: var(--primary-light);">/${pattern}/${flags}</code></div>
                            <div><strong>Matches:</strong> <span style="color: var(--secondary); font-weight: 600;">${matches.length} found âœ“</span></div>
                        </div>
                    `;

                    // Display matches with capture groups
                    matchesDiv.innerHTML = `
                        <div style="padding: 0.75rem; background: rgba(34, 197, 94, 0.1); border-bottom: 1px solid var(--border);">
                            <strong style="color: var(--secondary);">âœ“ ${matches.length} match(es) found</strong>
                        </div>
                        ${matches.map((m, i) => `
                            <div style="padding: 0.75rem; border-bottom: 1px solid var(--border);">
                                <div style="margin-bottom: 0.5rem;">
                                    <span style="color: var(--text-muted); font-size: 0.8rem;">Match ${i + 1} (index ${m.index})</span>
                                </div>
                                <div style="padding: 0.5rem; background: var(--bg-secondary); border-radius: 4px; font-family: 'JetBrains Mono', monospace; margin-bottom: 0.5rem;">
                                    <strong style="color: var(--secondary);">${escapeHtml(m.fullMatch)}</strong>
                                </div>
                                ${m.groups.length > 0 ? `
                                    <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.25rem;">Capture Groups:</div>
                                    ${m.groups.map((g, gi) => `
                                        <div style="padding: 0.4rem; background: rgba(99, 102, 241, 0.1); border-radius: 3px; margin-bottom: 0.25rem; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;">
                                            <span style="color: var(--text-muted);">Group ${gi + 1}:</span> <span style="color: var(--primary-light);">${g !== undefined ? escapeHtml(g) : '<em style="color: var(--text-muted);">undefined</em>'}</span>
                                        </div>
                                    `).join('')}
                                ` : ''}
                            </div>
                        `).join('')}
                    `;
                } else {
                    highlightedDiv.innerHTML = escapeHtml(text);
                    matchesDiv.innerHTML = '<div style="padding: 1rem; color: var(--warning); text-align: center;">âš  No matches found in the test text</div>';
                    statsDiv.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;">
                            <div><strong>Pattern:</strong> <code style="color: var(--primary-light);">/${pattern}/${flags}</code></div>
                            <div><strong>Matches:</strong> <span style="color: var(--warning);">0 found</span></div>
                        </div>
                    `;
                }
            } catch (error) {
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = `
                    <div style="margin-bottom: 0.5rem;"><strong>âŒ Invalid Regular Expression</strong></div>
                    <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; margin-bottom: 0.5rem;">${escapeHtml(error.message)}</div>
                    <div style="font-size: 0.8rem; color: var(--text-muted);">
                        <strong>Common issues:</strong><br>
                        â€¢ Unescaped special characters: ( ) [ ] { } . * + ? ^ $ | \\<br>
                        â€¢ Unclosed groups or brackets<br>
                        â€¢ Invalid escape sequences<br>
                        â€¢ Use the "Escape" button to auto-escape special characters
                    </div>
                `;
                highlightedDiv.innerHTML = '<div style="color: var(--danger);">Fix the regex pattern to see matches...</div>';
                matchesDiv.innerHTML = '';
                statsDiv.innerHTML = '<div style="color: var(--danger);">Invalid pattern - fix errors to continue</div>';
            }
        }

        function escapeRegexPattern() {
            const input = document.getElementById('regex-pattern');
            const pattern = input.value;
            if (!pattern) {
                showToast('Enter a pattern first', 'error');
                return;
            }
            // Escape special regex characters
            const escaped = pattern.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            input.value = escaped;
            testRegex();
            showToast('Pattern escaped!', 'success');
        }

        function loadRegexPattern(type) {
            const patterns = {
                email: '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}',
                url: 'https?://[\\w\\-._~:/?#[\\]@!$&\'()*+,;=.]+',
                phone: '\\(?\\d{3}\\)?[\\s.-]?\\d{3}[\\s.-]?\\d{4}',
                ipv4: '\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b',
                ipv6: '(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}',
                date: '\\d{4}-\\d{2}-\\d{2}',
                time: '\\d{2}:\\d{2}:\\d{2}',
                hex: '#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})',
                uuid: '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}',
                digits: '\\d+',
                alphanumeric: '[a-zA-Z0-9]+',
                'splunk-timestamp': '\\d{4}-\\d{2}-\\d{2}\\s+\\d{2}:\\d{2}:\\d{2}',
                'splunk-ip': 'ip=([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})',
                'splunk-field': '(\\w+)=([^\\s]+)'
            };

            const testTexts = {
                email: 'Contact us at support@example.com or sales@company.org',
                url: 'Visit https://www.example.com or http://test.org/path',
                phone: 'Call (555) 123-4567 or 555-987-6543',
                ipv4: 'Server IPs: 192.168.1.1, 10.0.0.1, 172.16.0.254',
                ipv6: 'IPv6: 2001:0db8:85a3:0000:0000:8a2e:0370:7334',
                date: 'Dates: 2024-12-12, 2023-01-15, 2025-06-30',
                time: 'Times: 10:30:45, 14:22:10, 23:59:59',
                hex: 'Colors: #fff, #000000, #ff5733, #c0ffee',
                uuid: 'UUID: 550e8400-e29b-41d4-a716-446655440000',
                digits: 'Numbers: 123, 4567, 890',
                alphanumeric: 'Codes: ABC123, XYZ789, TEST456',
                'splunk-timestamp': '2024-12-12 10:15:30 ERROR\n2024-12-12 11:20:45 INFO',
                'splunk-ip': 'ip=192.168.1.100 status=failed\nip=10.0.0.50 status=success',
                'splunk-field': 'user=john status=active level=5\nuser=jane status=inactive level=3'
            };

            if (patterns[type]) {
                document.getElementById('regex-pattern').value = patterns[type];
                if (testTexts[type]) {
                    document.getElementById('regex-test-text').value = testTexts[type];
                }
                testRegex();
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function generateRegexSnippet(lang) {
            const pattern = document.getElementById('regex-pattern').value;
            let flags = '';
            if (document.getElementById('flag-g').checked) flags += 'g';
            if (document.getElementById('flag-i').checked) flags += 'i';
            if (document.getElementById('flag-m').checked) flags += 'm';
            if (document.getElementById('flag-s').checked) flags += 's';
            if (document.getElementById('flag-u').checked) flags += 'u';
            
            if (!pattern) {
                showToast('Enter a regex pattern first', 'error');
                return;
            }

            let snippet = '';
            switch(lang) {
                case 'javascript':
                    snippet = `// JavaScript Regex Pattern
const regex = /${pattern}/${flags};
const text = "your text here";

// Method 1: Find all matches
const matches = text.match(regex);
if (matches) {
    console.log('Matches found:', matches);
    matches.forEach((match, index) => {
        console.log(\`Match \${index + 1}: \${match}\`);
    });
}

// Method 2: Test if pattern exists
if (regex.test(text)) {
    console.log('Pattern found in text!');
}

// Method 3: Replace matches
const replaced = text.replace(regex, 'replacement');
console.log('Replaced:', replaced);`;
                    break;
                    
                case 'python':
                    const pyFlags = [];
                    if (flags.includes('i')) pyFlags.push('re.IGNORECASE');
                    if (flags.includes('m')) pyFlags.push('re.MULTILINE');
                    if (flags.includes('s')) pyFlags.push('re.DOTALL');
                    const pyFlagsStr = pyFlags.length > 0 ? `, ${pyFlags.join(' | ')}` : '';
                    
                    snippet = `# Python Regex Pattern
import re

pattern = r"${pattern}"
text = "your text here"

# Method 1: Find all matches
matches = re.findall(pattern, text${pyFlagsStr})
if matches:
    print(f"Matches found: {matches}")
    for i, match in enumerate(matches, 1):
        print(f"Match {i}: {match}")

# Method 2: Search for first match
match = re.search(pattern, text${pyFlagsStr})
if match:
    print(f"First match: {match.group()}")
    print(f"Capture groups: {match.groups()}")

# Method 3: Replace matches
replaced = re.sub(pattern, "replacement", text${pyFlagsStr})
print(f"Replaced: {replaced}")`;
                    break;
                    
                case 'java':
                    snippet = `// Java Regex Pattern
import java.util.regex.*;

String pattern = "${pattern}";
String text = "your text here";
Pattern p = Pattern.compile(pattern);
Matcher m = p.matcher(text);

// Method 1: Find all matches
System.out.println("All matches:");
while (m.find()) {
    System.out.println("Match: " + m.group());
    System.out.println("Position: " + m.start() + "-" + m.end());
    
    // Print capture groups
    for (int i = 1; i <= m.groupCount(); i++) {
        System.out.println("  Group " + i + ": " + m.group(i));
    }
}

// Method 2: Replace matches
String replaced = text.replaceAll(pattern, "replacement");
System.out.println("Replaced: " + replaced);`;
                    break;
                    
                case 'splunk':
                    snippet = `# Splunk SPL Examples

# Example 1: Extract fields using rex
index=main sourcetype=access_combined
| rex field=_raw "${pattern}"
| table _time, extracted_field

# Example 2: Filter events using regex
index=main
| regex _raw="${pattern}"

# Example 3: Extract with named groups
# Pattern: (?<user>\\w+)=(?<value>[^\\s]+)
index=main
| rex field=_raw "(?<user>\\\\w+)=(?<value>[^\\\\s]+)"
| table _time, user, value

# Example 4: Use in search
index=main "${pattern}"

# Example 5: Field extraction in props.conf
[your_sourcetype]
EXTRACT-field = ${pattern}

# Tips:
# - In Splunk, use double backslashes: \\\\d instead of \\d
# - Named groups: (?<name>pattern)
# - Test with | regex for filtering
# - Use | rex for field extraction`;
                    break;
            }

            document.getElementById('regex-snippet').innerHTML = `<code style="color: var(--text-primary);">${escapeHtml(snippet)}</code>`;
            showToast(`${lang.charAt(0).toUpperCase() + lang.slice(1)} code generated!`, 'success');
        }

        function copyRegexSnippet() {
            const snippet = document.getElementById('regex-snippet').textContent;
            if (snippet && !snippet.includes('Select a language')) {
                navigator.clipboard.writeText(snippet);
                showToast('Code snippet copied!', 'success');
            } else {
                showToast('Generate a snippet first', 'error');
            }
        }

        // ============================================
        // PHASE 1 TOOLS - Unix Timestamp
        // ============================================
        function initTimestamp() {
            updateCurrentTimestamp();
            setInterval(updateCurrentTimestamp, 1000);
        }

        function updateCurrentTimestamp() {
            const now = Math.floor(Date.now() / 1000);
            document.getElementById('current-timestamp').value = now;
        }

        function convertTimestamp() {
            const timestamp = document.getElementById('timestamp-input').value;
            const timezone = document.getElementById('timestamp-timezone').value;
            const resultDiv = document.getElementById('timestamp-result');

            if (!timestamp) {
                resultDiv.innerHTML = '<div style="color: var(--text-muted);">Enter a timestamp...</div>';
                return;
            }

            try {
                const ts = parseInt(timestamp);
                if (isNaN(ts) || ts < 0) {
                    throw new Error('Invalid timestamp');
                }
                
                const date = new Date(ts * 1000);
                if (!isFinite(date.getTime())) {
                    throw new Error('Timestamp out of valid range');
                }
                
                const options = { 
                    timeZone: timezone,
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    timeZoneName: 'short'
                };
                const formatted = new Intl.DateTimeFormat('en-US', options).format(date);
                
                const now = Date.now();
                const diff = now - (ts * 1000);
                const relativeTime = getRelativeTime(diff);

                resultDiv.innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.25rem;">Date & Time</div>
                        <div style="color: var(--text-primary); font-size: 1.125rem;">${formatted}</div>
                    </div>
                    <div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.25rem;">Relative Time</div>
                        <div style="color: var(--primary-light);">${relativeTime}</div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div style="color: var(--danger);">Invalid timestamp</div>`;
            }
        }

        function getRelativeTime(ms) {
            const seconds = Math.floor(Math.abs(ms) / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            const isPast = ms > 0;

            if (days > 0) return `${days} day${days > 1 ? 's' : ''} ${isPast ? 'ago' : 'from now'}`;
            if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ${isPast ? 'ago' : 'from now'}`;
            if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''} ${isPast ? 'ago' : 'from now'}`;
            return `${seconds} second${seconds > 1 ? 's' : ''} ${isPast ? 'ago' : 'from now'}`;
        }

        function copyCurrentTimestamp() {
            const timestamp = document.getElementById('current-timestamp').value;
            navigator.clipboard.writeText(timestamp);
            showToast('Current timestamp copied!', 'success');
        }

        function convertDateToTimestamp() {
            const dateInput = document.getElementById('date-input').value;
            const resultDiv = document.getElementById('date-timestamp-result');

            if (!dateInput) {
                resultDiv.innerHTML = '<div style="color: var(--text-muted);">Select a date and time...</div>';
                return;
            }

            const timestamp = Math.floor(new Date(dateInput).getTime() / 1000);
            resultDiv.innerHTML = `
                <div style="margin-bottom: 0.5rem;">
                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.25rem;">Unix Timestamp</div>
                    <div style="color: var(--text-primary); font-size: 1.5rem; font-weight: 600;">${timestamp}</div>
                </div>
                <div>
                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.25rem;">Milliseconds</div>
                    <div style="color: var(--text-primary);">${timestamp * 1000}</div>
                </div>
            `;
        }

        function copyConvertedTimestamp() {
            const text = document.getElementById('date-timestamp-result').textContent;
            const match = text.match(/\d+/);
            if (match) {
                navigator.clipboard.writeText(match[0]);
                showToast('Timestamp copied!', 'success');
            } else {
                showToast('Convert a date first', 'error');
            }
        }

        // ============================================
        // PHASE 1 TOOLS - Cron Builder
        // ============================================
        function loadCronPreset(value) {
            if (!value) return;
            const parts = value.split(' ');
            document.getElementById('cron-minute').value = parts[0];
            document.getElementById('cron-hour').value = parts[1];
            document.getElementById('cron-day').value = parts[2];
            document.getElementById('cron-month').value = parts[3];
            document.getElementById('cron-weekday').value = parts[4];
            updateCronExpression();
        }

        function updateCronExpression() {
            const minute = document.getElementById('cron-minute').value || '*';
            const hour = document.getElementById('cron-hour').value || '*';
            const day = document.getElementById('cron-day').value || '*';
            const month = document.getElementById('cron-month').value || '*';
            const weekday = document.getElementById('cron-weekday').value || '*';

            const expression = `${minute} ${hour} ${day} ${month} ${weekday}`;
            document.getElementById('cron-expression').value = expression;

            // Generate human-readable description
            const description = describeCron(minute, hour, day, month, weekday);
            document.getElementById('cron-description').innerHTML = description;

            // Calculate next runs
            calculateNextRuns(minute, hour, day, month, weekday);
        }

        function describeCron(minute, hour, day, month, weekday) {
            let desc = 'Runs ';
            
            if (minute === '*' && hour === '*' && day === '*' && month === '*' && weekday === '*') {
                return 'Runs every minute';
            }
            
            if (minute !== '*') desc += `at minute ${minute} `;
            else desc += 'every minute ';
            
            if (hour !== '*') desc += `of hour ${hour} `;
            if (day !== '*') desc += `on day ${day} `;
            if (month !== '*') desc += `of month ${month} `;
            if (weekday !== '*') {
                const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                desc += `on ${days[parseInt(weekday)] || weekday} `;
            }

            return desc.trim();
        }

        function calculateNextRuns(minute, hour, day, month, weekday) {
            const nextRuns = [];
            const now = new Date();
            
            // Parse cron values (handle * and numeric values)
            const parseValue = (val) => val === '*' ? null : parseInt(val);
            const minVal = parseValue(minute);
            const hourVal = parseValue(hour);
            const dayVal = parseValue(day);
            const monthVal = parseValue(month);
            
            // Simple calculation for next 5 occurrences (simplified logic)
            for (let i = 0; i < 5; i++) {
                const next = new Date(now);
                
                if (minVal === null && hourVal === null) {
                    // Every minute
                    next.setMinutes(now.getMinutes() + i + 1);
                } else if (hourVal === null) {
                    // Every hour at specific minute
                    next.setMinutes(minVal);
                    next.setHours(now.getHours() + i);
                    if (next <= now) next.setHours(next.getHours() + 1);
                } else {
                    // Specific hour and minute
                    next.setMinutes(minVal || 0);
                    next.setHours(hourVal || 0);
                    next.setDate(now.getDate() + i);
                    if (next <= now) next.setDate(next.getDate() + 1);
                }
                
                nextRuns.push(next.toLocaleString());
            }

            document.getElementById('cron-next-runs').innerHTML = nextRuns.map((run, i) => 
                `<div style="margin-bottom: 0.5rem;">${i + 1}. ${run}</div>`
            ).join('');
        }

        function copyCronExpression() {
            const expression = document.getElementById('cron-expression').value;
            navigator.clipboard.writeText(expression);
            showToast('Cron expression copied!', 'success');
        }

        // ============================================
        // IMAGE COMPRESSOR - Replaces ASCII Art
        // ============================================
        
        let originalImageFile = null;
        let originalImageData = null;
        let compressedImageBlob = null;

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Check file size (10MB limit)
            if (file.size > 10 * 1024 * 1024) {
                showToast('File too large! Maximum 10MB', 'error');
                return;
            }
            
            // Check if it's an image
            if (!file.type.startsWith('image/')) {
                showToast('Please upload an image file', 'error');
                return;
            }
            
            originalImageFile = file;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                originalImageData = e.target.result;
                displayOriginalImage(e.target.result, file);
            };
            reader.readAsDataURL(file);
        }

        function displayOriginalImage(dataUrl, file) {
            const img = document.getElementById('original-image');
            img.src = dataUrl;
            
            // Create temporary image to get dimensions
            const tempImg = new Image();
            tempImg.onload = function() {
                const stats = document.getElementById('original-stats');
                stats.innerHTML = `
                    <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                    <div><strong>Dimensions:</strong> ${tempImg.width} Ã— ${tempImg.height}px</div>
                    <div><strong>Format:</strong> ${file.type.split('/')[1].toUpperCase()}</div>
                `;
                
                // Set default resize values
                document.getElementById('resize-width').value = '';
                document.getElementById('resize-height').value = '';
                document.getElementById('resize-width').placeholder = `Width (${tempImg.width}px)`;
                document.getElementById('resize-height').placeholder = `Height (${tempImg.height}px)`;
            };
            tempImg.src = dataUrl;
            
            // Show panels
            document.getElementById('original-preview').style.display = 'block';
            document.getElementById('compression-settings').style.display = 'block';
            document.getElementById('empty-preview').style.display = 'none';
            document.getElementById('compressed-preview').style.display = 'none';
            
            showToast('Image loaded successfully!', 'success');
        }

        function updateQualityValue(value) {
            document.getElementById('quality-value').textContent = value;
        }

        function compressImage() {
            if (!originalImageFile) {
                showToast('Please upload an image first', 'error');
                return;
            }
            
            const quality = parseInt(document.getElementById('quality-slider').value) / 100;
            const outputFormat = document.getElementById('output-format').value;
            const resizeWidth = document.getElementById('resize-width').value;
            const resizeHeight = document.getElementById('resize-height').value;
            const keepAspect = document.getElementById('keep-aspect-ratio').checked;
            
            const img = new Image();
            img.onload = function() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // Calculate dimensions
                let width = img.width;
                let height = img.height;
                
                if (resizeWidth || resizeHeight) {
                    if (keepAspect) {
                        if (resizeWidth && !resizeHeight) {
                            width = parseInt(resizeWidth);
                            height = Math.round((img.height / img.width) * width);
                        } else if (!resizeWidth && resizeHeight) {
                            height = parseInt(resizeHeight);
                            width = Math.round((img.width / img.height) * height);
                        } else {
                            width = parseInt(resizeWidth);
                            height = parseInt(resizeHeight);
                        }
                    } else {
                        width = parseInt(resizeWidth) || width;
                        height = parseInt(resizeHeight) || height;
                    }
                }
                
                canvas.width = width;
                canvas.height = height;
                
                // Draw image with optional smoothing
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                ctx.drawImage(img, 0, 0, width, height);
                
                // Get output format
                const format = outputFormat === 'original' ? originalImageFile.type : outputFormat;
                
                // Convert to blob
                canvas.toBlob(function(blob) {
                    if (!blob) {
                        showToast('Failed to compress image. Try a different format or quality.', 'error');
                        return;
                    }
                    compressedImageBlob = blob;
                    displayCompressedImage(blob, width, height, format);
                }, format, quality);
            };
            img.src = originalImageData;
        }

        function displayCompressedImage(blob, width, height, format) {
            const url = URL.createObjectURL(blob);
            const img = document.getElementById('compressed-image');
            img.src = url;
            
            const stats = document.getElementById('compressed-stats');
            stats.innerHTML = `
                <div><strong>Size:</strong> ${formatFileSize(blob.size)}</div>
                <div><strong>Dimensions:</strong> ${width} Ã— ${height}px</div>
                <div><strong>Format:</strong> ${format.split('/')[1].toUpperCase()}</div>
            `;
            
            // Calculate savings
            const originalSize = originalImageFile.size;
            const compressedSize = blob.size;
            const saved = originalSize - compressedSize;
            const percentage = Math.round((saved / originalSize) * 100);
            
            const savingsDiv = document.getElementById('savings-display');
            if (saved > 0) {
                savingsDiv.innerHTML = `
                    <div style="font-size: 1.5rem; font-weight: 700; color: #10b981; margin-bottom: 0.25rem;">ðŸ“‰ ${percentage}% Smaller</div>
                    <div style="font-size: 0.875rem; color: var(--text-primary);">Saved ${formatFileSize(saved)}</div>
                `;
                savingsDiv.style.background = 'linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2))';
                savingsDiv.style.borderColor = '#10b981';
            } else {
                savingsDiv.innerHTML = `
                    <div style="font-size: 1.2rem; font-weight: 600; color: #f59e0b; margin-bottom: 0.25rem;">âš ï¸ Size Increased</div>
                    <div style="font-size: 0.875rem; color: var(--text-secondary);">Try lower quality or different format</div>
                `;
                savingsDiv.style.background = 'linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(217, 119, 6, 0.2))';
                savingsDiv.style.borderColor = '#f59e0b';
            }
            
            document.getElementById('compressed-preview').style.display = 'block';
            showToast('Image compressed successfully!', 'success');
        }

        function downloadCompressedImage() {
            if (!compressedImageBlob) {
                showToast('No compressed image to download', 'error');
                return;
            }
            
            const outputFormat = document.getElementById('output-format').value;
            const format = outputFormat === 'original' ? originalImageFile.type : outputFormat;
            const extension = format.split('/')[1];
            const filename = `compressed_${Date.now()}.${extension}`;
            
            const url = URL.createObjectURL(compressedImageBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('Image downloaded!', 'success');
        }

        function resetCompressor() {
            originalImageFile = null;
            originalImageData = null;
            compressedImageBlob = null;
            
            document.getElementById('image-upload-input').value = '';
            document.getElementById('quality-slider').value = 80;
            document.getElementById('quality-value').textContent = '80';
            document.getElementById('output-format').value = 'original';
            document.getElementById('resize-width').value = '';
            document.getElementById('resize-height').value = '';
            document.getElementById('keep-aspect-ratio').checked = true;
            
            document.getElementById('original-preview').style.display = 'none';
            document.getElementById('compression-settings').style.display = 'none';
            document.getElementById('compressed-preview').style.display = 'none';
            document.getElementById('empty-preview').style.display = 'block';
            
            showToast('Ready for new image', 'success');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
        }

        // Drag and drop support
        const dropZone = document.getElementById('image-drop-zone');
        if (dropZone) {
            let dragCounter = 0;
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            dropZone.addEventListener('dragenter', () => {
                dragCounter++;
                dropZone.style.borderColor = 'var(--primary)';
                dropZone.style.background = 'rgba(99, 102, 241, 0.15)';
            }, false);

            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
            }, false);

            dropZone.addEventListener('dragleave', () => {
                dragCounter--;
                if (dragCounter === 0) {
                    dropZone.style.borderColor = 'var(--border)';
                    dropZone.style.background = 'rgba(99, 102, 241, 0.05)';
                }
            }, false);

            dropZone.addEventListener('drop', (e) => {
                dragCounter = 0;
                dropZone.style.borderColor = 'var(--border)';
                dropZone.style.background = 'rgba(99, 102, 241, 0.05)';
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    document.getElementById('image-upload-input').files = files;
                    handleImageUpload({ target: { files: files } });
                }
            }, false);
        }

        // ===== PDF FUNCTIONS =====
        
        // Initialize PDF.js
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }

        let currentPdfDoc = null;
        let mergePdfFiles = [];

        // PDF Split Functions
        async function loadPdfForSplit() {
            const file = document.getElementById('pdf-split-file').files[0];
            if (!file) return;

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                currentPdfDoc = { doc: pdfDoc, name: file.name };

                const pageCount = pdfDoc.getPageCount();
                document.getElementById('pdf-split-info').style.display = 'block';
                document.getElementById('pdf-split-info').innerHTML = `ðŸ“„ <strong>${file.name}</strong><br>Pages: ${pageCount} | Size: ${(file.size / 1024).toFixed(2)} KB`;
                document.getElementById('pdf-split-preview').innerHTML = `<div style="color: var(--text-primary);">âœ… PDF loaded successfully!<br><br>Select split mode and click "Split PDF" to continue.</div>`;
                document.getElementById('split-start').max = pageCount;
                document.getElementById('split-end').max = pageCount;
            } catch (error) {
                showToast('Failed to load PDF: ' + error.message, 'error');
            }
        }

        function updateSplitMode() {
            const mode = document.getElementById('split-mode').value;
            document.getElementById('split-range-input').style.display = mode === 'range' ? 'block' : 'none';
            document.getElementById('split-custom-input').style.display = mode === 'custom' ? 'block' : 'none';
        }

        async function splitPdf() {
            if (!currentPdfDoc) {
                showToast('Please upload a PDF first', 'error');
                return;
            }

            const mode = document.getElementById('split-mode').value;
            const pdfDoc = currentPdfDoc.doc;
            const pageCount = pdfDoc.getPageCount();

            try {
                if (mode === 'all') {
                    // Extract all pages individually
                    for (let i = 0; i < pageCount; i++) {
                        const newPdf = await PDFLib.PDFDocument.create();
                        const [copiedPage] = await newPdf.copyPages(pdfDoc, [i]);
                        newPdf.addPage(copiedPage);
                        await downloadPdf(newPdf, `page_${i + 1}.pdf`);
                    }
                    showToast(`Split ${pageCount} pages successfully!`, 'success');
                } else if (mode === 'range') {
                    const start = parseInt(document.getElementById('split-start').value) - 1;
                    const end = parseInt(document.getElementById('split-end').value) - 1;
                    if (isNaN(start) || isNaN(end) || start > end || start < 0 || end >= pageCount) {
                        showToast('Invalid page range', 'error');
                        return;
                    }
                    const newPdf = await PDFLib.PDFDocument.create();
                    const pages = await newPdf.copyPages(pdfDoc, Array.from({ length: end - start + 1 }, (_, i) => start + i));
                    pages.forEach(page => newPdf.addPage(page));
                    await downloadPdf(newPdf, `pages_${start + 1}_to_${end + 1}.pdf`);
                    showToast('Pages extracted successfully!', 'success');
                } else if (mode === 'custom') {
                    const customPages = document.getElementById('split-custom').value;
                    const pageNumbers = parsePageNumbers(customPages, pageCount);
                    if (pageNumbers.length === 0) {
                        showToast('Invalid page numbers', 'error');
                        return;
                    }
                    const newPdf = await PDFLib.PDFDocument.create();
                    const pages = await newPdf.copyPages(pdfDoc, pageNumbers);
                    pages.forEach(page => newPdf.addPage(page));
                    await downloadPdf(newPdf, `custom_pages.pdf`);
                    showToast('Custom pages extracted successfully!', 'success');
                }
            } catch (error) {
                showToast('Error splitting PDF: ' + error.message, 'error');
            }
        }

        // PDF Merge Functions
        async function loadPdfsForMerge() {
            const files = document.getElementById('pdf-merge-files').files;
            if (files.length === 0) return;

            mergePdfFiles = [];
            for (const file of files) {
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                    mergePdfFiles.push({ doc: pdfDoc, name: file.name });
                } catch (error) {
                    showToast(`Failed to load ${file.name}`, 'error');
                }
            }

            if (mergePdfFiles.length > 0) {
                document.getElementById('pdf-merge-list').style.display = 'block';
                displayMergeFiles();
            }
        }

        function displayMergeFiles() {
            const container = document.getElementById('merge-files-container');
            container.innerHTML = mergePdfFiles.map((file, idx) => `
                <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; margin-bottom: 0.5rem;">
                    <span style="color: var(--text-secondary); font-size: 0.875rem;">${idx + 1}.</span>
                    <span style="flex: 1; font-size: 0.875rem; color: var(--text-primary);">${file.name}</span>
                    <button onclick="removeMergeFile(${idx})" style="padding: 0.25rem 0.5rem; background: var(--danger); border: none; border-radius: 4px; color: white; cursor: pointer; font-size: 0.75rem;">Remove</button>
                </div>
            `).join('');
            
            document.getElementById('pdf-merge-preview').innerHTML = `<div style="color: var(--text-primary);">Ready to merge ${mergePdfFiles.length} PDF files.<br><br>Click "Merge PDFs" to combine them.</div>`;
        }

        function removeMergeFile(index) {
            mergePdfFiles.splice(index, 1);
            if (mergePdfFiles.length === 0) {
                document.getElementById('pdf-merge-list').style.display = 'none';
                document.getElementById('pdf-merge-preview').innerHTML = 'Upload PDFs to start merging';
            } else {
                displayMergeFiles();
            }
        }

        async function mergePdfs() {
            if (mergePdfFiles.length < 2) {
                showToast('Please upload at least 2 PDF files', 'error');
                return;
            }

            try {
                showToast('Merging PDFs...', 'info');
                const mergedPdf = await PDFLib.PDFDocument.create();
                for (const file of mergePdfFiles) {
                    const pages = await mergedPdf.copyPages(file.doc, file.doc.getPageIndices());
                    pages.forEach(page => mergedPdf.addPage(page));
                }
                await downloadPdf(mergedPdf, 'merged.pdf');
                showToast('PDFs merged successfully!', 'success');
            } catch (error) {
                showToast('Error merging PDFs: ' + error.message, 'error');
            }
        }

        // PDF Compress Functions
        async function loadPdfForCompress() {
            const file = document.getElementById('pdf-compress-file').files[0];
            if (!file) return;

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                currentPdfDoc = { doc: pdfDoc, name: file.name, size: file.size };

                const pageCount = pdfDoc.getPageCount();
                document.getElementById('pdf-compress-info').style.display = 'block';
                document.getElementById('pdf-compress-info').innerHTML = `ðŸ“„ <strong>${file.name}</strong><br>Pages: ${pageCount} | Original Size: ${(file.size / 1024).toFixed(2)} KB`;
                document.getElementById('pdf-compress-result').innerHTML = `<div style="color: var(--text-primary);">âœ… PDF loaded successfully!<br><br>Select compression quality and click "Compress PDF".</div>`;
            } catch (error) {
                showToast('Failed to load PDF: ' + error.message, 'error');
            }
        }

        async function compressPdf() {
            if (!currentPdfDoc) {
                showToast('Please upload a PDF first', 'error');
                return;
            }

            try {
                const quality = document.getElementById('compress-quality').value;
                const pdfDoc = currentPdfDoc.doc;
                
                // Show processing message
                document.getElementById('pdf-compress-result').innerHTML = `
                    <div style="color: var(--text-secondary);">
                        â³ Processing PDF...
                    </div>
                `;
                
                // Create a new optimized PDF document
                const optimizedPdfDoc = await PDFLib.PDFDocument.create();
                
                // Copy all pages with optimization
                const pageCount = pdfDoc.getPageCount();
                const copiedPages = await optimizedPdfDoc.copyPages(pdfDoc, Array.from({length: pageCount}, (_, i) => i));
                
                // Apply scaling based on quality setting
                let scaleFactor = 1.0;
                if (quality === 'low') {
                    scaleFactor = 0.7;  // 70% of original size
                } else if (quality === 'medium') {
                    scaleFactor = 0.85; // 85% of original size
                }
                
                copiedPages.forEach(page => {
                    if (scaleFactor < 1.0) {
                        const { width, height } = page.getSize();
                        page.scale(scaleFactor, scaleFactor);
                    }
                    optimizedPdfDoc.addPage(page);
                });
                
                // Save with compression options
                const pdfBytes = await optimizedPdfDoc.save({
                    useObjectStreams: true,
                    addDefaultPage: false,
                    objectsPerTick: 50,
                    updateFieldAppearances: false
                });
                
                const newSize = pdfBytes.length;
                const reduction = ((currentPdfDoc.size - newSize) / currentPdfDoc.size * 100).toFixed(1);

                // Download the compressed PDF
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = currentPdfDoc.name.replace('.pdf', '_compressed.pdf');
                a.click();
                URL.revokeObjectURL(url);

                // Show results
                document.getElementById('pdf-compress-result').innerHTML = `
                    <div style="color: var(--text-primary);">
                        âœ… PDF compressed and downloaded!<br><br>
                        <strong>Original:</strong> ${(currentPdfDoc.size / 1024).toFixed(2)} KB<br>
                        <strong>Compressed:</strong> ${(newSize / 1024).toFixed(2)} KB<br>
                        <strong>Reduction:</strong> ${reduction > 0 ? reduction : 0}%<br>
                        <strong>Quality:</strong> ${quality.charAt(0).toUpperCase() + quality.slice(1)}<br>
                        ${scaleFactor < 1.0 ? `<strong>Scale:</strong> ${(scaleFactor * 100).toFixed(0)}%` : ''}
                    </div>
                `;
                showToast('PDF compressed successfully!', 'success');
            } catch (error) {
                document.getElementById('pdf-compress-result').innerHTML = `
                    <div style="color: #ef4444;">
                        âŒ Error: ${error.message}
                    </div>
                `;
                showToast('Error compressing PDF: ' + error.message, 'error');
            }
        }

        // PDF Tools Functions
        async function loadPdfForTools() {
            const file = document.getElementById('pdf-tools-file').files[0];
            if (!file) return;

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                currentPdfDoc = { doc: pdfDoc, name: file.name };

                const pageCount = pdfDoc.getPageCount();
                document.getElementById('pdf-tools-info').style.display = 'block';
                document.getElementById('pdf-tools-info').innerHTML = `ðŸ“„ <strong>${file.name}</strong><br>Pages: ${pageCount} | Size: ${(file.size / 1024).toFixed(2)} KB`;
                document.getElementById('pdf-tools-preview').innerHTML = `<div style="color: var(--text-primary);">âœ… PDF loaded successfully!<br><br>Use the tools on the left to modify your PDF.</div>`;
            } catch (error) {
                showToast('Failed to load PDF: ' + error.message, 'error');
            }
        }

        async function rotatePdfPages(degrees) {
            if (!currentPdfDoc) {
                showToast('Please upload a PDF first', 'error');
                return;
            }

            try {
                const pdfDoc = currentPdfDoc.doc;
                const pages = pdfDoc.getPages();
                pages.forEach(page => page.setRotation(PDFLib.degrees(degrees)));
                
                await downloadPdf(pdfDoc, currentPdfDoc.name.replace('.pdf', '_rotated.pdf'));
                showToast(`Pages rotated ${degrees}Â° successfully!`, 'success');
            } catch (error) {
                showToast('Error rotating pages: ' + error.message, 'error');
            }
        }

        async function deletePdfPages() {
            if (!currentPdfDoc) {
                showToast('Please upload a PDF first', 'error');
                return;
            }

            const pagesInput = document.getElementById('delete-pages').value;
            const pdfDoc = currentPdfDoc.doc;
            const pageCount = pdfDoc.getPageCount();
            const pageNumbers = parsePageNumbers(pagesInput, pageCount);

            if (pageNumbers.length === 0) {
                showToast('Invalid page numbers', 'error');
                return;
            }

            try {
                // Remove pages in reverse order to avoid index shifting
                pageNumbers.sort((a, b) => b - a).forEach(pageIdx => {
                    pdfDoc.removePage(pageIdx);
                });

                await downloadPdf(pdfDoc, currentPdfDoc.name.replace('.pdf', '_deleted.pdf'));
                showToast(`${pageNumbers.length} pages deleted successfully!`, 'success');
            } catch (error) {
                showToast('Error deleting pages: ' + error.message, 'error');
            }
        }

        async function extractPdfImages() {
            showToast('Image extraction requires advanced PDF processing. This feature uses server-side processing.', 'info');
        }

        async function editPdfMetadata() {
            if (!currentPdfDoc) {
                showToast('Please upload a PDF first', 'error');
                return;
            }

            const title = prompt('Enter PDF title:');
            const author = prompt('Enter author name:');
            
            if (title || author) {
                try {
                    const pdfDoc = currentPdfDoc.doc;
                    if (title) pdfDoc.setTitle(title);
                    if (author) pdfDoc.setAuthor(author);
                    pdfDoc.setProducer('DevPro Toolkit');
                    pdfDoc.setCreator('DevPro Toolkit');
                    
                    await downloadPdf(pdfDoc, currentPdfDoc.name.replace('.pdf', '_metadata.pdf'));
                    showToast('Metadata updated successfully!', 'success');
                } catch (error) {
                    showToast('Error updating metadata: ' + error.message, 'error');
                }
            }
        }

        // Helper Functions
        async function downloadPdf(pdfDoc, filename) {
            const pdfBytes = await pdfDoc.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function parsePageNumbers(input, maxPages) {
            const pages = [];
            const parts = input.split(',');
            
            for (const part of parts) {
                const trimmed = part.trim();
                if (trimmed.includes('-')) {
                    const [start, end] = trimmed.split('-').map(n => parseInt(n.trim()));
                    if (!isNaN(start) && !isNaN(end) && start >= 1 && end <= maxPages && start <= end) {
                        for (let i = start; i <= end; i++) {
                            pages.push(i - 1); // Convert to 0-indexed
                        }
                    }
                } else {
                    const num = parseInt(trimmed);
                    if (!isNaN(num) && num >= 1 && num <= maxPages) {
                        pages.push(num - 1); // Convert to 0-indexed
                    }
                }
            }
            
            return [...new Set(pages)]; // Remove duplicates
        }

        // ===== NETWORK TOOLS FUNCTIONS =====

        // HTTP Client
        let httpHeaders = [];
        let httpParams = [];
        let httpCollections = JSON.parse(localStorage.getItem('httpCollections') || '[]');

        function initHttpClient() {
            addHttpHeader();
            addHttpParam();
            updateSavedRequestsList(); // Show count on load
        }

        function addHttpHeader() {
            const container = document.getElementById('headers-container');
            const id = Date.now();
            const div = document.createElement('div');
            div.id = `header-${id}`;
            div.style.cssText = 'display: flex; gap: 0.5rem; margin-bottom: 0.5rem;';
            div.innerHTML = `
                <input type="text" placeholder="Key" class="header-key" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                <input type="text" placeholder="Value" class="header-value" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                <button onclick="document.getElementById('header-${id}').remove()" style="padding: 0.5rem; background: var(--danger); border: none; border-radius: 6px; color: white; cursor: pointer; font-size: 0.875rem;">Ã—</button>
            `;
            container.appendChild(div);
        }

        function addHttpParam() {
            const container = document.getElementById('params-container');
            const id = Date.now();
            const div = document.createElement('div');
            div.id = `param-${id}`;
            div.style.cssText = 'display: flex; gap: 0.5rem; margin-bottom: 0.5rem;';
            div.innerHTML = `
                <input type="text" placeholder="Key" class="param-key" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                <input type="text" placeholder="Value" class="param-value" style="flex: 1; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.875rem;">
                <button onclick="document.getElementById('param-${id}').remove()" style="padding: 0.5rem; background: var(--danger); border: none; border-radius: 6px; color: white; cursor: pointer; font-size: 0.875rem;">Ã—</button>
            `;
            container.appendChild(div);
        }

        function switchHttpTab(tab) {
            document.querySelectorAll('.http-tab').forEach(el => el.style.display = 'none');
            document.querySelectorAll('#http-headers-tab, #http-body-tab, #http-params-tab').forEach(el => el.parentElement.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                btn.style.borderBottomColor = 'transparent';
                btn.style.color = 'var(--text-secondary)';
            }));
            document.getElementById(`http-${tab}-tab`).style.display = 'block';
            const activeBtn = document.getElementById(`tab-${tab}`);
            activeBtn.classList.add('active');
            activeBtn.style.borderBottomColor = 'var(--primary)';
            activeBtn.style.color = 'var(--primary)';
        }

        function switchResponseTab(tab) {
            document.querySelectorAll('.response-tab').forEach(el => el.style.display = 'none');
            document.querySelectorAll('#response-body-tab, #response-headers-tab').forEach(el => el.parentElement.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                btn.style.borderBottomColor = 'transparent';
                btn.style.color = 'var(--text-secondary)';
            }));
            document.getElementById(`response-${tab}-tab`).style.display = 'block';
            const activeBtn = document.getElementById(`resp-tab-${tab}`);
            activeBtn.classList.add('active');
            activeBtn.style.borderBottomColor = 'var(--primary)';
            activeBtn.style.color = 'var(--primary)';
        }

        function switchBodyType() {
            const type = document.getElementById('body-type').value;
            const body = document.getElementById('http-body');
            const placeholders = {
                json: '{"key": "value"}',
                xml: '<?xml version="1.0"?>\n<root>\n  <item>value</item>\n</root>',
                text: 'Plain text content',
                form: 'key1=value1&key2=value2'
            };
            body.placeholder = placeholders[type] || '';
        }

        async function sendHttpRequest() {
            const method = document.getElementById('http-method').value;
            const url = document.getElementById('http-url').value.trim();
            
            if (!url) {
                showToast('Please enter a URL', 'error');
                return;
            }

            const headers = {};
            document.querySelectorAll('#headers-container > div').forEach(div => {
                const key = div.querySelector('.header-key').value.trim();
                const value = div.querySelector('.header-value').value.trim();
                if (key) headers[key] = value;
            });

            let finalUrl = url;
            const params = new URLSearchParams();
            document.querySelectorAll('#params-container > div').forEach(div => {
                const key = div.querySelector('.param-key').value.trim();
                const value = div.querySelector('.param-value').value.trim();
                if (key) params.append(key, value);
            });
            if (params.toString()) {
                finalUrl += (url.includes('?') ? '&' : '?') + params.toString();
            }

            const options = { method, headers };
            
            if (['POST', 'PUT', 'PATCH'].includes(method)) {
                const body = document.getElementById('http-body').value;
                if (body) options.body = body;
            }

            const startTime = performance.now();
            try {
                const response = await fetch(finalUrl, options);
                const endTime = performance.now();
                const responseTime = (endTime - startTime).toFixed(2);

                const contentType = response.headers.get('content-type') || '';
                let responseData;
                
                if (contentType.includes('application/json')) {
                    responseData = await response.json();
                    document.getElementById('http-response').textContent = JSON.stringify(responseData, null, 2);
                } else {
                    responseData = await response.text();
                    document.getElementById('http-response').textContent = responseData;
                }

                const statusClass = response.ok ? 'success' : 'error';
                document.getElementById('response-status').innerHTML = `
                    <span style="color: ${response.ok ? 'var(--success)' : 'var(--danger)'};">${response.status} ${response.statusText}</span>
                    <span style="margin-left: 1rem;">â±ï¸ ${responseTime}ms</span>
                `;

                const headerLines = [];
                response.headers.forEach((value, key) => {
                    headerLines.push(`${key}: ${value}`);
                });
                document.getElementById('http-response-headers').textContent = headerLines.join('\n') || 'No headers';

                showToast(`Request completed in ${responseTime}ms`, 'success');
            } catch (error) {
                document.getElementById('http-response').textContent = `Error: ${error.message}`;
                document.getElementById('response-status').innerHTML = `<span style="color: var(--danger);">Request Failed</span>`;
                showToast('Request failed: ' + error.message, 'error');
            }
        }

        function saveHttpRequest() {
            const request = {
                name: prompt('Enter request name:') || 'Untitled',
                method: document.getElementById('http-method').value,
                url: document.getElementById('http-url').value,
                headers: [],
                params: [],
                body: document.getElementById('http-body').value,
                timestamp: new Date().toISOString()
            };

            document.querySelectorAll('#headers-container > div').forEach(div => {
                const key = div.querySelector('.header-key').value.trim();
                const value = div.querySelector('.header-value').value.trim();
                if (key) request.headers.push({ key, value });
            });

            document.querySelectorAll('#params-container > div').forEach(div => {
                const key = div.querySelector('.param-key').value.trim();
                const value = div.querySelector('.param-value').value.trim();
                if (key) request.params.push({ key, value });
            });

            httpCollections.push(request);
            localStorage.setItem('httpCollections', JSON.stringify(httpCollections));
            updateSavedRequestsList();
            showToast(`Request saved as "${request.name}"!`, 'success');
        }

        function loadHttpRequest() {
            if (httpCollections.length === 0) {
                showToast('No saved requests', 'info');
                return;
            }

            const list = httpCollections.map((req, idx) => `${idx + 1}. ${req.name} (${req.method} ${req.url})`).join('\n');
            const choice = prompt(`Select request:\n\n${list}\n\nEnter number:`);
            const index = parseInt(choice) - 1;

            if (index >= 0 && index < httpCollections.length) {
                const req = httpCollections[index];
                document.getElementById('http-method').value = req.method;
                document.getElementById('http-url').value = req.url;
                document.getElementById('http-body').value = req.body || '';

                document.getElementById('headers-container').innerHTML = '';
                req.headers.forEach(h => {
                    addHttpHeader();
                    const lastHeader = document.querySelector('#headers-container > div:last-child');
                    lastHeader.querySelector('.header-key').value = h.key;
                    lastHeader.querySelector('.header-value').value = h.value;
                });

                document.getElementById('params-container').innerHTML = '';
                req.params.forEach(p => {
                    addHttpParam();
                    const lastParam = document.querySelector('#params-container > div:last-child');
                    lastParam.querySelector('.param-key').value = p.key;
                    lastParam.querySelector('.param-value').value = p.value;
                });

                showToast('Request loaded!', 'success');
            }
        }

        function updateSavedRequestsList() {
            // This creates a visual indicator of saved requests count
            const saveBtn = document.querySelector('button[onclick="saveHttpRequest()"]');
            if (saveBtn && httpCollections.length > 0) {
                const existingBadge = saveBtn.querySelector('.save-count-badge');
                if (existingBadge) {
                    existingBadge.textContent = httpCollections.length;
                } else {
                    const badge = document.createElement('span');
                    badge.className = 'save-count-badge';
                    badge.textContent = httpCollections.length;
                    badge.style.cssText = 'display:inline-block;margin-left:0.5rem;background:var(--primary);color:white;border-radius:10px;padding:2px 8px;font-size:0.75rem;font-weight:600;';
                    saveBtn.appendChild(badge);
                }
            }
        }

        // WebSocket Client
        let ws = null;
        let wsReconnectAttempts = 0;
        const wsMaxReconnectAttempts = 5;

        function toggleWebSocket() {
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.close();
            } else {
                connectWebSocket();
            }
        }

        function connectWebSocket() {
            const url = document.getElementById('ws-url').value.trim();
            if (!url) {
                showToast('Please enter a WebSocket URL', 'error');
                return;
            }

            try {
                ws = new WebSocket(url);

                ws.onopen = () => {
                    document.getElementById('ws-status').innerHTML = '<span style="color: var(--success);">Connected</span>';
                    document.getElementById('ws-connect-btn').textContent = 'Disconnect';
                    addWsMessage('system', 'Connected to ' + url);
                    wsReconnectAttempts = 0;
                    showToast('WebSocket connected!', 'success');
                };

                ws.onmessage = (event) => {
                    addWsMessage('received', event.data);
                };

                ws.onerror = (error) => {
                    addWsMessage('error', 'WebSocket error occurred');
                    showToast('WebSocket error', 'error');
                };

                ws.onclose = () => {
                    document.getElementById('ws-status').innerHTML = '<span style="color: var(--danger);">Disconnected</span>';
                    document.getElementById('ws-connect-btn').textContent = 'Connect';
                    addWsMessage('system', 'Disconnected from server');

                    if (document.getElementById('ws-auto-reconnect').checked && wsReconnectAttempts < wsMaxReconnectAttempts) {
                        wsReconnectAttempts++;
                        addWsMessage('system', `Reconnecting... (Attempt ${wsReconnectAttempts}/${wsMaxReconnectAttempts})`);
                        setTimeout(connectWebSocket, 2000);
                    }
                };
            } catch (error) {
                showToast('Failed to connect: ' + error.message, 'error');
            }
        }

        function sendWebSocketMessage() {
            if (!ws || ws.readyState !== WebSocket.OPEN) {
                showToast('WebSocket is not connected', 'error');
                return;
            }

            const message = document.getElementById('ws-message').value;
            if (!message) {
                showToast('Please enter a message', 'error');
                return;
            }

            try {
                ws.send(message);
                addWsMessage('sent', message);
                showToast('Message sent', 'success');
            } catch (error) {
                showToast('Failed to send message: ' + error.message, 'error');
            }
        }

        function addWsMessage(type, content) {
            const history = document.getElementById('ws-history');
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                sent: 'var(--primary)',
                received: 'var(--success)',
                system: 'var(--text-secondary)',
                error: 'var(--danger)'
            };
            const icons = {
                sent: 'â†‘',
                received: 'â†“',
                system: 'â„¹',
                error: 'âš '
            };

            const msgDiv = document.createElement('div');
            msgDiv.style.cssText = `margin-bottom: 0.75rem; padding: 0.5rem; background: rgba(255,255,255,0.05); border-left: 3px solid ${colors[type]}; border-radius: 4px;`;
            msgDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                    <span style="color: ${colors[type]}; font-weight: 600;">${icons[type]} ${type.toUpperCase()}</span>
                    <span style="color: var(--text-secondary); font-size: 0.75rem;">${timestamp}</span>
                </div>
                <div style="color: var(--text-primary); white-space: pre-wrap; word-wrap: break-word;">${content}</div>
            `;
            history.appendChild(msgDiv);
            requestAnimationFrame(() => {
                history.scrollTop = history.scrollHeight;
            });
        }

        function clearWsHistory() {
            document.getElementById('ws-history').innerHTML = '<div style="color: var(--text-muted);">Message history cleared</div>';
        }

        // GraphQL Client
        let graphqlHistory = JSON.parse(localStorage.getItem('graphqlHistory') || '[]');

        async function executeGraphQL() {
            const endpoint = document.getElementById('graphql-endpoint').value.trim();
            const query = document.getElementById('graphql-query').value.trim();
            const variablesText = document.getElementById('graphql-variables').value.trim();

            if (!endpoint) {
                showToast('Please enter GraphQL endpoint', 'error');
                return;
            }

            if (!query) {
                showToast('Please enter a query', 'error');
                return;
            }

            let variables = {};
            if (variablesText) {
                try {
                    variables = JSON.parse(variablesText);
                } catch (e) {
                    showToast('Invalid JSON in variables', 'error');
                    return;
                }
            }

            const startTime = performance.now();
            try {
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query, variables })
                });

                const endTime = performance.now();
                const responseTime = (endTime - startTime).toFixed(2);
                const data = await response.json();

                document.getElementById('graphql-response').textContent = JSON.stringify(data, null, 2);
                document.getElementById('graphql-status').innerHTML = `
                    <span style="color: var(--success);">${response.status} ${response.statusText}</span>
                    <span style="margin-left: 1rem;">â±ï¸ ${responseTime}ms</span>
                `;

                graphqlHistory.unshift({ query, variables, timestamp: new Date().toISOString() });
                if (graphqlHistory.length > 10) graphqlHistory.pop();
                localStorage.setItem('graphqlHistory', JSON.stringify(graphqlHistory));

                showToast(`Query executed in ${responseTime}ms`, 'success');
            } catch (error) {
                document.getElementById('graphql-response').textContent = `Error: ${error.message}`;
                document.getElementById('graphql-status').innerHTML = `<span style="color: var(--danger);">Request Failed</span>`;
                showToast('Query failed: ' + error.message, 'error');
            }
        }

        function formatGraphQLQuery() {
            const query = document.getElementById('graphql-query').value;
            if (!query.trim()) {
                showToast('No query to format', 'error');
                return;
            }
            
            try {
                // Simple but safer GraphQL formatting
                let formatted = query
                    .replace(/\s+/g, ' ')  // Normalize whitespace
                    .replace(/\s*\{\s*/g, ' {\n  ')  // Opening braces
                    .replace(/\s*\}\s*/g, '\n}\n')   // Closing braces
                    .replace(/\s*,\s*/g, ',\n  ')    // Commas
                    .replace(/\s*\(\s*/g, '(')       // Opening parentheses
                    .replace(/\s*\)\s*/g, ')')       // Closing parentheses
                    .trim();
                
                // Fix indentation for nested braces
                let lines = formatted.split('\n');
                let indentLevel = 0;
                formatted = lines.map(line => {
                    const trimmed = line.trim();
                    if (trimmed.startsWith('}')) indentLevel = Math.max(0, indentLevel - 1);
                    const indented = '  '.repeat(indentLevel) + trimmed;
                    if (trimmed.endsWith('{')) indentLevel++;
                    return indented;
                }).join('\n');
                
                document.getElementById('graphql-query').value = formatted;
                showToast('Query formatted', 'success');
            } catch (e) {
                showToast('Failed to format query', 'error');
            }
        }

        function loadGraphQLHistory() {
            if (graphqlHistory.length === 0) {
                showToast('No query history', 'info');
                return;
            }

            const list = graphqlHistory.map((q, idx) => {
                const preview = q.query.substring(0, 50).replace(/\n/g, ' ');
                return `${idx + 1}. ${preview}... (${new Date(q.timestamp).toLocaleString()})`;
            }).join('\n');
            
            const choice = prompt(`Select query:\n\n${list}\n\nEnter number:`);
            const index = parseInt(choice) - 1;

            if (index >= 0 && index < graphqlHistory.length) {
                const item = graphqlHistory[index];
                document.getElementById('graphql-query').value = item.query;
                document.getElementById('graphql-variables').value = JSON.stringify(item.variables, null, 2);
                showToast('Query loaded from history', 'success');
            }
        }

        // cURL Generator
        let curlMode = 'builder';

        function switchCurlMode() {
            curlMode = curlMode === 'builder' ? 'parser' : 'builder';
            document.getElementById('curl-builder-mode').style.display = curlMode === 'builder' ? 'block' : 'none';
            document.getElementById('curl-parser-mode').style.display = curlMode === 'parser' ? 'block' : 'none';
        }

        function generateCurl() {
            const method = document.getElementById('curl-method').value;
            const url = document.getElementById('curl-url').value.trim();
            
            if (!url) {
                showToast('Please enter a URL', 'error');
                return;
            }

            let curl = `curl -X ${method} '${url}'`;

            const headersText = document.getElementById('curl-headers').value.trim();
            if (headersText) {
                headersText.split('\n').forEach(line => {
                    const trimmed = line.trim();
                    if (trimmed) {
                        curl += ` \\\n  -H '${trimmed}'`;
                    }
                });
            }

            const body = document.getElementById('curl-body').value.trim();
            if (body && ['POST', 'PUT', 'PATCH'].includes(method)) {
                curl += ` \\\n  -d '${body.replace(/'/g, "\\'")}'`;
            }

            document.getElementById('curl-output').textContent = curl;
            showToast('cURL command generated', 'success');
        }

        function parseCurl() {
            const curlCommand = document.getElementById('curl-input').value.trim();
            
            if (!curlCommand.startsWith('curl')) {
                showToast('Invalid cURL command', 'error');
                return;
            }

            try {
                const methodMatch = curlCommand.match(/-X\s+(\w+)/);
                const method = methodMatch ? methodMatch[1] : 'GET';
                
                const urlMatch = curlCommand.match(/curl[^'"]*['"]([^'"]+)['"]/);
                const url = urlMatch ? urlMatch[1] : '';

                const headerMatches = curlCommand.matchAll(/-H\s+['"]([^'"]+)['"]/g);
                const headers = [];
                for (const match of headerMatches) {
                    headers.push(match[1]);
                }

                const bodyMatch = curlCommand.match(/-d\s+['"](.+)['"]/s);
                const body = bodyMatch ? bodyMatch[1].replace(/\\'/g, "'") : '';

                document.getElementById('curl-method').value = method;
                document.getElementById('curl-url').value = url;
                document.getElementById('curl-headers').value = headers.join('\n');
                document.getElementById('curl-body').value = body;

                switchCurlMode();
                generateCurl();
                showToast('cURL command parsed successfully', 'success');
            } catch (error) {
                showToast('Failed to parse cURL command: ' + error.message, 'error');
            }
        }

        function copyCurlCommand() {
            const curlCommand = document.getElementById('curl-output').textContent;
            if (curlCommand && !curlCommand.includes('Build a request')) {
                navigator.clipboard.writeText(curlCommand);
                showToast('cURL command copied!', 'success');
            } else {
                showToast('Generate a cURL command first', 'error');
            }
        }

        // ===== GIT ASSISTANT =====
        const gitCommands = [
            {cat: 'Basic', cmd: 'git init', desc: 'Initialize a new Git repository', ex: 'git init'},
            {cat: 'Basic', cmd: 'git clone', desc: 'Clone a repository', ex: 'git clone https://github.com/user/repo.git'},
            {cat: 'Basic', cmd: 'git status', desc: 'Show working tree status', ex: 'git status'},
            {cat: 'Basic', cmd: 'git add', desc: 'Add files to staging', ex: 'git add . # Add all\ngit add file.js # Add specific'},
            {cat: 'Basic', cmd: 'git commit', desc: 'Commit staged changes', ex: 'git commit -m "Your message"'},
            {cat: 'Basic', cmd: 'git push', desc: 'Push commits to remote', ex: 'git push origin main'},
            {cat: 'Basic', cmd: 'git pull', desc: 'Fetch and merge from remote', ex: 'git pull origin main'},
            {cat: 'Branch', cmd: 'git branch', desc: 'List, create, or delete branches', ex: 'git branch # List\ngit branch feature # Create\ngit branch -d feature # Delete'},
            {cat: 'Branch', cmd: 'git checkout', desc: 'Switch branches or restore files', ex: 'git checkout main\ngit checkout -b feature # Create and switch'},
            {cat: 'Branch', cmd: 'git merge', desc: 'Merge branches', ex: 'git merge feature'},
            {cat: 'Branch', cmd: 'git rebase', desc: 'Reapply commits on top of another base', ex: 'git rebase main'},
            {cat: 'History', cmd: 'git log', desc: 'Show commit logs', ex: 'git log --oneline --graph'},
            {cat: 'History', cmd: 'git diff', desc: 'Show changes between commits', ex: 'git diff\ngit diff HEAD~1'},
            {cat: 'History', cmd: 'git show', desc: 'Show various types of objects', ex: 'git show HEAD'},
            {cat: 'Undo', cmd: 'git reset', desc: 'Reset current HEAD to specified state', ex: 'git reset --soft HEAD~1 # Undo commit\ngit reset --hard HEAD~1 # Undo commit and changes'},
            {cat: 'Undo', cmd: 'git revert', desc: 'Revert some existing commits', ex: 'git revert HEAD'},
            {cat: 'Undo', cmd: 'git restore', desc: 'Restore working tree files', ex: 'git restore file.js'},
            {cat: 'Stash', cmd: 'git stash', desc: 'Stash changes in working directory', ex: 'git stash\ngit stash pop\ngit stash list'},
            {cat: 'Remote', cmd: 'git remote', desc: 'Manage remote repositories', ex: 'git remote -v\ngit remote add origin URL'},
            {cat: 'Remote', cmd: 'git fetch', desc: 'Download objects from remote', ex: 'git fetch origin'},
            {cat: 'Tag', cmd: 'git tag', desc: 'Create, list, delete tags', ex: 'git tag v1.0.0\ngit tag -a v1.0.0 -m "Version 1.0"'}
        ];

        function renderGitCommands() {
            const container = document.getElementById('git-cmd-list');
            const grouped = {};
            gitCommands.forEach(cmd => {
                if (!grouped[cmd.cat]) grouped[cmd.cat] = [];
                grouped[cmd.cat].push(cmd);
            });
            
            let html = '';
            Object.keys(grouped).forEach(cat => {
                html += `<div style="margin-bottom: 1.5rem;"><h3 style="margin: 0 0 0.75rem 0; color: var(--primary); font-size: 1.125rem;">${cat} Commands</h3>`;
                grouped[cat].forEach(cmd => {
                    html += `<div class="git-cmd-card" style="padding: 1rem; margin-bottom: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                            <strong style="color: var(--primary); font-family: 'JetBrains Mono', monospace;">${cmd.cmd}</strong>
                            <button onclick="navigator.clipboard.writeText('${cmd.ex.split('\n')[0]}');showToast('Copied!','success');" style="padding: 0.25rem 0.5rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-secondary); cursor: pointer; font-size: 0.75rem;">Copy</button>
                        </div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.5rem;">${cmd.desc}</div>
                        <pre style="margin: 0; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.8125rem; overflow-x: auto;">${cmd.ex}</pre>
                    </div>`;
                });
                html += '</div>';
            });
            container.innerHTML = html;
        }

        let gitSearchDebounce = null;
        function filterGitCommands() {
            clearTimeout(gitSearchDebounce);
            gitSearchDebounce = setTimeout(() => {
                const search = document.getElementById('git-cmd-search').value.toLowerCase();
                const cards = document.querySelectorAll('.git-cmd-card');
                let visibleCount = 0;
                
                cards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    const isVisible = text.includes(search);
                    card.style.display = isVisible ? '' : 'none';
                    if (isVisible) visibleCount++;
                });
                
                if (visibleCount === 0 && search) {
                    // Could add a "no results" message here if needed
                }
            }, 200); // 200ms debounce
        }

        function generateBranchViz() {
            const input = document.getElementById('branch-input').value;
            const lines = input.split('\n').filter(l => l.trim());
            let output = '';
            lines.forEach((line, i) => {
                const indent = line.search(/\S/);
                const branch = line.trim();
                const prefix = indent > 0 ? '  '.repeat(indent / 2) + 'â”œâ”€â”€ ' : 'â— ';
                const color = indent > 0 ? '#60a5fa' : '#34d399'; // Blue for branches, Green for main
                output += `<span style="color: ${color};">${prefix}${branch}</span>\n`;
            });
            document.getElementById('branch-viz-output').innerHTML = output || 'Enter branch names to visualize...';
        }

        const gitignoreTemplates = {
            node: `# Dependencies
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*
package-lock.json
yarn.lock

# Environment
.env
.env.local

# Build
dist/
build/
*.log

# IDE
.vscode/
.idea/
*.swp`,
            python: `# Byte-compiled
__pycache__/
*.py[cod]
*$py.class

# Virtual Environment
venv/
env/
ENV/

# Distribution
dist/
build/
*.egg-info/

# IDE
.vscode/
.idea/
*.pyc

# Testing
.pytest_cache/
.coverage`,
            java: `# Compiled
*.class
target/

# Package Files
*.jar
*.war
*.ear

# IDE
.idea/
*.iml
.vscode/
.classpath
.project

# Build
build/
out/`,
            react: `# Dependencies
node_modules/

# Production
build/
dist/

# Environment
.env
.env.local

# Testing
coverage/

# IDE
.vscode/
.idea/

# Misc
.DS_Store
npm-debug.log*`,
            vue: `# Dependencies
node_modules/

# Build
dist/

# Environment
.env
.env.local

# IDE
.vscode/
.idea/

# Misc
.DS_Store
npm-debug.log*
yarn-error.log*`,
            angular: `# Dependencies
node_modules/

# Build
dist/
.angular/

# Environment
.env

# IDE
.vscode/
.idea/

# Testing
coverage/

# Misc
.DS_Store`,
            dotnet: `# Build
bin/
obj/
*.dll
*.exe

# User-specific
*.user
*.suo

# IDE
.vs/
.vscode/

# NuGet
packages/
*.nupkg`,
            go: `# Binaries
*.exe
*.exe~
*.dll
*.so
*.dylib

# Test
*.test

# Output
*.out

# Dependencies
vendor/

# IDE
.vscode/
.idea/`,
            rust: `# Build
target/
Cargo.lock

# IDE
.vscode/
.idea/

# OS
.DS_Store`,
            general: `# OS
.DS_Store
Thumbs.db

# IDE
.vscode/
.idea/
*.swp
*.swo

# Logs
*.log

# Environment
.env`
        };

        function loadGitignoreTemplate() {
            const template = document.getElementById('gitignore-template').value;
            document.getElementById('gitignore-output').value = gitignoreTemplates[template] || '';
        }

        function copyGitignore() {
            const content = document.getElementById('gitignore-output').value;
            if (content) {
                navigator.clipboard.writeText(content);
                showToast('.gitignore copied!', 'success');
            } else {
                showToast('Select a template first', 'error');
            }
        }

        // ===== DOCKER HELPER =====
        function addDockerPort() {
            const container = document.getElementById('docker-ports-container');
            const id = Date.now();
            container.innerHTML += `<div id="port-${id}" style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="text" placeholder="Host port (e.g., 8080)" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                <input type="text" placeholder="Container port (e.g., 80)" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                <button onclick="document.getElementById('port-${id}').remove()" style="padding: 0.5rem; background: var(--danger); border: none; border-radius: 4px; color: white; cursor: pointer;">Ã—</button>
            </div>`;
        }

        function addDockerEnv() {
            const container = document.getElementById('docker-env-container');
            const id = Date.now();
            container.innerHTML += `<div id="env-${id}" style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="text" placeholder="Key (e.g., NODE_ENV)" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                <input type="text" placeholder="Value (e.g., production)" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                <button onclick="document.getElementById('env-${id}').remove()" style="padding: 0.5rem; background: var(--danger); border: none; border-radius: 4px; color: white; cursor: pointer;">Ã—</button>
            </div>`;
        }

        function addDockerVolume() {
            const container = document.getElementById('docker-volume-container');
            const id = Date.now();
            container.innerHTML += `<div id="vol-${id}" style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="text" placeholder="Host path" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                <input type="text" placeholder="Container path" style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                <button onclick="document.getElementById('vol-${id}').remove()" style="padding: 0.5rem; background: var(--danger); border: none; border-radius: 4px; color: white; cursor: pointer;">Ã—</button>
            </div>`;
        }

        function generateDockerRun() {
            const image = document.getElementById('docker-image').value.trim();
            if (!image) {
                showToast('Image name is required', 'error');
                return;
            }

            let cmd = 'docker run';
            if (document.getElementById('docker-detached').checked) cmd += ' -d';
            if (document.getElementById('docker-rm').checked) cmd += ' --rm';
            
            const name = document.getElementById('docker-name').value.trim();
            if (name) cmd += ` --name ${name}`;

            document.querySelectorAll('#docker-ports-container > div').forEach(div => {
                const [host, container] = [...div.querySelectorAll('input')].map(i => i.value.trim());
                if (host && container) {
                    const hostPort = parseInt(host);
                    const containerPort = parseInt(container);
                    if (hostPort < 1 || hostPort > 65535 || containerPort < 1 || containerPort > 65535) {
                        showToast('Port numbers must be between 1-65535', 'error');
                        return;
                    }
                    cmd += ` -p ${host}:${container}`;
                }
            });

            document.querySelectorAll('#docker-env-container > div').forEach(div => {
                const [key, val] = [...div.querySelectorAll('input')].map(i => i.value.trim());
                if (key && val) cmd += ` -e ${key}="${val}"`;
            });

            document.querySelectorAll('#docker-volume-container > div').forEach(div => {
                const [host, container] = [...div.querySelectorAll('input')].map(i => i.value.trim());
                if (host && container) cmd += ` -v ${host}:${container}`;
            });

            cmd += ` ${image}`;
            document.getElementById('docker-run-output').textContent = cmd;
        }

        function copyDockerCommand() {
            const cmd = document.getElementById('docker-run-output').textContent;
            if (cmd && !cmd.includes('Configure options')) {
                navigator.clipboard.writeText(cmd);
                showToast('Command copied!', 'success');
            } else {
                showToast('Generate a command first', 'error');
            }
        }

        const dockerPresets = {
            nginx: `docker run -d \\
  --name my-nginx \\
  -p 80:80 \\
  -v ./html:/usr/share/nginx/html:ro \\
  nginx:latest`,
            postgres: `docker run -d \\
  --name postgres \\
  -p 5432:5432 \\
  -e POSTGRES_PASSWORD=mysecretpassword \\
  -e POSTGRES_DB=mydb \\
  -v postgres-data:/var/lib/postgresql/data \\
  postgres:15`,
            mysql: `docker run -d \\
  --name mysql \\
  -p 3306:3306 \\
  -e MYSQL_ROOT_PASSWORD=rootpass \\
  -e MYSQL_DATABASE=mydb \\
  -v mysql-data:/var/lib/mysql \\
  mysql:8`,
            redis: `docker run -d \\
  --name redis \\
  -p 6379:6379 \\
  redis:latest`,
            mongodb: `docker run -d \\
  --name mongodb \\
  -p 27017:27017 \\
  -e MONGO_INITDB_ROOT_USERNAME=admin \\
  -e MONGO_INITDB_ROOT_PASSWORD=password \\
  -v mongo-data:/data/db \\
  mongo:latest`,
            elasticsearch: `docker run -d \\
  --name elasticsearch \\
  -p 9200:9200 \\
  -e "discovery.type=single-node" \\
  -e "ES_JAVA_OPTS=-Xms512m -Xmx512m" \\
  elasticsearch:8.11.0`
        };

        function loadDockerPreset() {
            const preset = document.getElementById('docker-preset').value;
            document.getElementById('docker-preset-output').textContent = dockerPresets[preset] || 'Select a service to see its configuration...';
        }

        function copyDockerPreset() {
            const content = document.getElementById('docker-preset-output').textContent;
            if (content && !content.includes('Select a service')) {
                navigator.clipboard.writeText(content);
                showToast('Configuration copied!', 'success');
            } else {
                showToast('Select a service first', 'error');
            }
        }

        const composeTemplates = {
            lamp: `version: '3.8'

services:
  web:
    image: php:8.1-apache
    ports:
      - "80:80"
    volumes:
      - ./src:/var/www/html
    depends_on:
      - db

  db:
    image: mysql:8
    environment:
      MYSQL_ROOT_PASSWORD: rootpass
      MYSQL_DATABASE: myapp
    volumes:
      - db-data:/var/lib/mysql

volumes:
  db-data:`,
            mean: `version: '3.8'

services:
  mongodb:
    image: mongo:latest
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: password
    volumes:
      - mongo-data:/data/db

  backend:
    image: node:18
    working_dir: /app
    volumes:
      - ./backend:/app
    command: npm start
    ports:
      - "3000:3000"
    depends_on:
      - mongodb

  frontend:
    image: node:18
    working_dir: /app
    volumes:
      - ./frontend:/app
    command: npm start
    ports:
      - "4200:4200"

volumes:
  mongo-data:`,
            wordpress: `version: '3.8'

services:
  wordpress:
    image: wordpress:latest
    ports:
      - "8000:80"
    environment:
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: wordpress
      WORDPRESS_DB_PASSWORD: wordpress
      WORDPRESS_DB_NAME: wordpress
    volumes:
      - wp-data:/var/www/html
    depends_on:
      - db

  db:
    image: mysql:8
    environment:
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wordpress
      MYSQL_PASSWORD: wordpress
      MYSQL_ROOT_PASSWORD: rootpass
    volumes:
      - db-data:/var/lib/mysql

volumes:
  wp-data:
  db-data:`,
            'node-postgres': `version: '3.8'

services:
  app:
    image: node:18
    working_dir: /app
    volumes:
      - ./app:/app
    command: npm start
    ports:
      - "3000:3000"
    environment:
      DATABASE_URL: postgres://user:password@db:5432/mydb
    depends_on:
      - db

  db:
    image: postgres:15
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mydb
    volumes:
      - pg-data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

volumes:
  pg-data:`,
            'python-redis': `version: '3.8'

services:
  app:
    image: python:3.11
    working_dir: /app
    volumes:
      - ./app:/app
    command: python app.py
    ports:
      - "5000:5000"
    environment:
      REDIS_HOST: redis
    depends_on:
      - redis

  redis:
    image: redis:latest
    ports:
      - "6379:6379"`,
            'nginx-node': `version: '3.8'

services:
  nginx:
    image: nginx:latest
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - app

  app:
    image: node:18
    working_dir: /app
    volumes:
      - ./app:/app
    command: npm start
    ports:
      - "3000:3000"`
        };

        function loadComposeTemplate() {
            const template = document.getElementById('compose-template').value;
            document.getElementById('compose-output').value = composeTemplates[template] || '';
        }

        function copyCompose() {
            const content = document.getElementById('compose-output').value;
            if (content) {
                navigator.clipboard.writeText(content);
                showToast('docker-compose.yml copied!', 'success');
            } else {
                showToast('Select a template first', 'error');
            }
        }

        // API Response Mocker Functions
        let mockEndpoints = JSON.parse(localStorage.getItem('mockEndpoints') || '[]');
        let mockHistory = [];

        function createMockEndpoint() {
            const name = document.getElementById('mock-name').value.trim();
            const path = document.getElementById('mock-path').value.trim();
            const method = document.getElementById('mock-method').value;
            const status = parseInt(document.getElementById('mock-status').value);
            const response = document.getElementById('mock-response').value.trim();
            const delay = parseInt(document.getElementById('mock-delay').value);

            if (!name || !path) {
                showToast('Name and path are required', 'error');
                return;
            }

            try {
                JSON.parse(response || '{}');
            } catch (e) {
                showToast('Invalid JSON in response body', 'error');
                return;
            }

            const endpoint = {
                id: Date.now(),
                name,
                path,
                method,
                status,
                response,
                delay
            };

            mockEndpoints.push(endpoint);
            localStorage.setItem('mockEndpoints', JSON.stringify(mockEndpoints));
            renderMockEndpoints();
            showToast('Mock endpoint created!', 'success');

            document.getElementById('mock-name').value = '';
            document.getElementById('mock-path').value = '';
            document.getElementById('mock-response').value = '';
            document.getElementById('mock-delay').value = '0';
        }

        function renderMockEndpoints() {
            const container = document.getElementById('mock-endpoints-list');
            if (mockEndpoints.length === 0) {
                container.innerHTML = '<div style="color: var(--text-secondary); font-size: 0.875rem; text-align: center; padding: 2rem;">No mock endpoints yet. Create one to get started.</div>';
                return;
            }

            container.innerHTML = mockEndpoints.map(endpoint => `
                <div style="padding: 1rem; background: var(--bg-tertiary); border-radius: 6px; margin-bottom: 0.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                        <div style="font-weight: 600;">${endpoint.name}</div>
                        <button onclick="deleteMockEndpoint(${endpoint.id})" style="background: var(--danger); color: white; border: none; padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.75rem;">Delete</button>
                    </div>
                    <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; margin-bottom: 0.5rem;">
                        <span style="background: var(--primary); color: white; padding: 0.125rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">${endpoint.method}</span>
                        <span style="color: var(--text-secondary); margin-left: 0.5rem;">${endpoint.path}</span>
                    </div>
                    <div style="font-size: 0.875rem; color: var(--text-secondary);">
                        Status: <span style="color: ${endpoint.status < 300 ? 'var(--success)' : 'var(--danger)'};">${endpoint.status}</span>
                        ${endpoint.delay > 0 ? ` | Delay: ${endpoint.delay}ms` : ''}
                    </div>
                    <button onclick="testMockEndpoint(${endpoint.id})" class="button button-primary" style="margin-top: 0.5rem; font-size: 0.75rem; padding: 0.5rem 1rem;">Test Endpoint</button>
                </div>
            `).join('');
        }

        function testMockEndpoint(id) {
            const endpoint = mockEndpoints.find(e => e.id === id);
            if (!endpoint) return;

            const startTime = Date.now();
            setTimeout(() => {
                const endTime = Date.now();
                const historyEntry = {
                    timestamp: new Date().toLocaleTimeString(),
                    method: endpoint.method,
                    path: endpoint.path,
                    status: endpoint.status,
                    responseTime: endTime - startTime
                };
                mockHistory.unshift(historyEntry);
                if (mockHistory.length > 20) mockHistory.pop();
                renderMockHistory();
                showToast(`${endpoint.method} ${endpoint.path} - ${endpoint.status} (${historyEntry.responseTime}ms)`, 'success');
            }, endpoint.delay);
        }

        function renderMockHistory() {
            const container = document.getElementById('mock-history');
            if (mockHistory.length === 0) {
                container.innerHTML = '<div style="color: var(--text-secondary); font-size: 0.875rem; text-align: center; padding: 1rem;">No requests yet</div>';
                return;
            }

            container.innerHTML = mockHistory.map(entry => `
                <div style="padding: 0.5rem; background: var(--bg-tertiary); border-radius: 4px; margin-bottom: 0.25rem; font-size: 0.75rem;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-family: 'JetBrains Mono', monospace;">
                            <span style="background: var(--primary); color: white; padding: 0.125rem 0.375rem; border-radius: 3px;">${entry.method}</span>
                            <span style="margin-left: 0.5rem;">${entry.path}</span>
                        </span>
                        <span style="color: ${entry.status < 300 ? 'var(--success)' : 'var(--danger)'};">${entry.status}</span>
                    </div>
                    <div style="color: var(--text-secondary); margin-top: 0.25rem;">
                        ${entry.timestamp} | ${entry.responseTime}ms
                    </div>
                </div>
            `).join('');
        }

        function deleteMockEndpoint(id) {
            mockEndpoints = mockEndpoints.filter(e => e.id !== id);
            localStorage.setItem('mockEndpoints', JSON.stringify(mockEndpoints));
            renderMockEndpoints();
            showToast('Endpoint deleted', 'success');
        }

        function loadMockPreset(preset) {
            const presets = {
                getUsers: {
                    name: 'Get Users',
                    path: '/api/users',
                    method: 'GET',
                    status: 200,
                    response: JSON.stringify({
                        success: true,
                        data: [
                            { id: 1, name: 'John Doe', email: 'john@example.com' },
                            { id: 2, name: 'Jane Smith', email: 'jane@example.com' }
                        ]
                    }, null, 2),
                    delay: 500
                },
                createUser: {
                    name: 'Create User',
                    path: '/api/users',
                    method: 'POST',
                    status: 201,
                    response: JSON.stringify({
                        success: true,
                        message: 'User created',
                        data: { id: 3, name: 'New User', email: 'new@example.com' }
                    }, null, 2),
                    delay: 300
                },
                notFound: {
                    name: 'Not Found Error',
                    path: '/api/missing',
                    method: 'GET',
                    status: 404,
                    response: JSON.stringify({
                        success: false,
                        error: 'Resource not found'
                    }, null, 2),
                    delay: 0
                },
                serverError: {
                    name: 'Server Error',
                    path: '/api/error',
                    method: 'GET',
                    status: 500,
                    response: JSON.stringify({
                        success: false,
                        error: 'Internal server error'
                    }, null, 2),
                    delay: 1000
                }
            };

            const p = presets[preset];
            document.getElementById('mock-name').value = p.name;
            document.getElementById('mock-path').value = p.path;
            document.getElementById('mock-method').value = p.method;
            document.getElementById('mock-status').value = p.status;
            document.getElementById('mock-response').value = p.response;
            document.getElementById('mock-delay').value = p.delay;
        }

        renderMockEndpoints();
        renderMockHistory();

        // Log Analyzer Functions - OPTIMIZED FOR LARGE FILES
        let parsedLogs = [];
        let currentPage = 1;
        const logsPerPage = 100;
        let totalFilteredLogs = 0;

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function loadSampleLogs() {
            const sampleLogs = `2024-01-15 10:23:45 ERROR Failed to connect to database: Connection timeout
2024-01-15 10:23:46 WARN Retrying connection attempt 1/3
2024-01-15 10:23:47 INFO Successfully connected to database
2024-01-15 10:23:48 DEBUG Query executed in 45ms
2024-01-15 10:24:15 INFO User login: user@example.com
2024-01-15 10:24:16 DEBUG Session created: ses_abc123
2024-01-15 10:25:30 WARN High memory usage detected: 85%
2024-01-15 10:26:45 ERROR Unhandled exception in /api/users
    at UserController.getUsers (controller.js:45)
    at async handleRequest (middleware.js:23)
2024-01-15 10:27:00 INFO Request completed: GET /api/users 200 125ms
2024-01-15 10:28:15 DEBUG Cache hit for key: user_123`;
            document.getElementById('log-input').value = sampleLogs;
            analyzeLogs();
        }

        document.getElementById('log-file-input').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const fileSize = (file.size / (1024 * 1024)).toFixed(2);
            if (file.size > 5 * 1024 * 1024) {
                document.getElementById('parsed-logs').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--primary);">
                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">â³</div>
                        <div>Loading ${fileSize} MB log file...</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">This may take a moment for large files</div>
                    </div>
                `;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('log-input').value = e.target.result;
                showToast(`Loaded ${fileSize} MB file`, 'success');
                setTimeout(analyzeLogs, 100);
            };
            reader.onerror = () => {
                showToast('Failed to read file', 'error');
            };
            reader.readAsText(file);
        });

        document.querySelectorAll('#filter-error, #filter-warn, #filter-info, #filter-debug').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                currentPage = 1;
                renderParsedLogs();
                renderLogTimeline();
                updateLogStats();
            });
        });

        let regexDebounceTimer;
        document.getElementById('log-regex').addEventListener('input', () => {
            clearTimeout(regexDebounceTimer);
            regexDebounceTimer = setTimeout(() => {
                currentPage = 1;
                renderParsedLogs();
                renderLogTimeline();
                updateLogStats();
            }, 500);
        });

        function analyzeLogs() {
            const logText = document.getElementById('log-input').value;
            if (!logText.trim()) {
                document.getElementById('parsed-logs').innerHTML = '<div style="color: var(--text-secondary); text-align: center; padding: 2rem;">Enter or upload logs to analyze</div>';
                return;
            }

            const lineCount = logText.split('\n').length;
            if (lineCount > 50000) {
                if (!confirm(`This log file has ${lineCount.toLocaleString()} lines. Analyzing may take some time and could slow down the browser. Continue?`)) {
                    return;
                }
            }
            if (lineCount > 1000) {
                document.getElementById('parsed-logs').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--primary);">
                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">âš¡</div>
                        <div>Analyzing ${lineCount.toLocaleString()} lines...</div>
                    </div>
                `;
            }

            setTimeout(() => {
                const startTime = performance.now();
                const lines = logText.split('\n');
                parsedLogs = [];
                let currentLog = null;
                let errorGroups = {};
                let errorOrder = [];

                // Patterns for log levels and error/exception/failure
                const logPattern = /^(\d{4}-\d{2}-\d{2}[ T]\d{2}:\d{2}:\d{2})\s+(ERROR|WARN|INFO|DEBUG)\s+(.+)$/;
                const errorLike = /(error|exception|fail|fatal|traceback)/i;
                const stackStart = /^\s+at |^\s+File "/;
                const batchSize = 1000;
                let processedLines = 0;

                const processBatch = () => {
                    const end = Math.min(processedLines + batchSize, lines.length);
                    for (let i = processedLines; i < end; i++) {
                        const line = lines[i];
                        const match = line.match(logPattern);
                        if (match) {
                            if (currentLog) parsedLogs.push(currentLog);
                            currentLog = {
                                timestamp: match[1],
                                level: match[2],
                                message: match[3],
                                stackTrace: [],
                                raw: [line]
                            };
                        } else if (currentLog && (stackStart.test(line) || line.trim() === '' || errorLike.test(line))) {
                            currentLog.stackTrace.push(line);
                            currentLog.raw.push(line);
                        } else if (currentLog && line.trim() !== '') {
                            // New log entry that doesn't match pattern, treat as info
                            parsedLogs.push(currentLog);
                            currentLog = {
                                timestamp: '',
                                level: 'INFO',
                                message: line,
                                stackTrace: [],
                                raw: [line]
                            };
                        }
                    }
                    processedLines = end;
                    if (processedLines < lines.length) {
                        setTimeout(processBatch, 0);
                    } else {
                        if (currentLog) parsedLogs.push(currentLog);

                        // Group errors/exceptions/failures
                        parsedLogs.forEach(log => {
                            if (errorLike.test(log.level) || errorLike.test(log.message) || log.stackTrace.some(l => errorLike.test(l))) {
                                // Use first line of message or stack as group key
                                let key = (log.message || '').split(':')[0];
                                if (!key) key = 'UnknownError';
                                if (!errorGroups[key]) {
                                    errorGroups[key] = { count: 0, logs: [] };
                                    errorOrder.push(key);
                                }
                                errorGroups[key].count++;
                                errorGroups[key].logs.push(log);
                            }
                        });

                        // Attach to global for rendering
                        window.parsedLogs = parsedLogs;
                        window.errorGroups = errorGroups;
                        window.errorOrder = errorOrder;

                        const endTime = performance.now();
                        const duration = ((endTime - startTime) / 1000).toFixed(2);
                        currentPage = 1;
                        renderParsedLogs();
                        renderLogSummary();
                        renderLogTimeline();
                        updateLogStats();
                        showToast(`Analyzed ${parsedLogs.length.toLocaleString()} logs in ${duration}s`, 'success');
                    }
                };
                processBatch();
            }, 10);
        }

        function renderParsedLogs() {
            const filters = {
                ERROR: document.getElementById('filter-error').checked,
                WARN: document.getElementById('filter-warn').checked,
                INFO: document.getElementById('filter-info').checked,
                DEBUG: document.getElementById('filter-debug').checked
            };

            const regexInput = document.getElementById('log-regex').value;
            let regexFilter = null;
            try {
                if (regexInput) regexFilter = new RegExp(regexInput, 'i');
            } catch (e) {}

            const filtered = parsedLogs.filter(log => {
                if (!filters[log.level]) return false;
                if (regexFilter && !regexFilter.test(log.message)) return false;
                return true;
            });

            totalFilteredLogs = filtered.length;

            const pageSize = 200;
            const startIdx = (currentPage - 1) * pageSize;
            const endIdx = Math.min(startIdx + pageSize, filtered.length);

            let html = '';
            if (filtered.length === 0) {
                html = '<div style="color: var(--text-secondary); text-align: center; padding: 2rem;">No logs match the selected filters.</div>';
            } else {
                for (let i = startIdx; i < endIdx; i++) {
                    const log = filtered[i];
                    html += `<div style="margin-bottom: 1.25rem; padding: 1rem; background: rgba(30,41,59,0.7); border-radius: 8px; border: 1px solid var(--border);">
                        <div style="font-size: 0.95rem; font-weight: 600; color: var(--primary); margin-bottom: 0.25rem;">
                            ${log.timestamp ? `<span style='color:var(--text-muted);font-size:0.85em;'>${escapeHtml(log.timestamp)}</span> ` : ''}
                            <span style="color: ${log.level === 'ERROR' ? 'var(--danger)' : log.level === 'WARN' ? 'var(--warning)' : log.level === 'INFO' ? 'var(--success)' : 'var(--text-secondary)'}; font-weight: 600; font-size: 0.875rem;">${escapeHtml(log.level)}</span>
                        </div>
                        <div style="color: var(--text-primary); word-wrap: break-word;">${escapeHtml(log.message)}</div>
                        ${log.stackTrace && log.stackTrace.length > 0 ? `<div style="margin-top: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px; font-size: 0.75rem; color: var(--text-secondary); overflow-x: auto;">${log.stackTrace.map(line => escapeHtml(line)).join('<br>')}</div>` : ''}
                    </div>`;
                }
            }

            // Pagination controls
            const totalPages = Math.max(1, Math.ceil(totalFilteredLogs / pageSize));
            if (totalPages > 1) {
                html += `<div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 0.5rem; margin-top: 1rem; padding: 0.75rem; background: var(--bg-tertiary); border-radius: 6px;">
                    <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}
                        style="min-width: 100px; padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 4px; cursor: ${currentPage === 1 ? 'not-allowed' : 'pointer'}; opacity: ${currentPage === 1 ? '0.5' : '1'}; font-size: 0.875rem;">
                        â† Previous
                    </button>
                    <span style="flex: 1; min-width: 200px; text-align: center; font-size: 0.875rem; color: var(--text-secondary);">
                        Page ${currentPage} of ${totalPages} (${startIdx + 1}-${endIdx} of ${filtered.length.toLocaleString()} logs)
                    </span>
                    <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}
                        style="min-width: 100px; padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 4px; cursor: ${currentPage === totalPages ? 'not-allowed' : 'pointer'}; opacity: ${currentPage === totalPages ? '0.5' : '1'}; font-size: 0.875rem;">
                        Next â†’
                    </button>
                </div>
                <div style="margin-top: 0.5rem; text-align: center;">
                    <input type="number" id="goto-page" placeholder="Go to page" min="1" max="${totalPages}"
                        style="width: 120px; max-width: 40%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary); font-size: 0.875rem; text-align: center;">
                    <button onclick="goToPage()" style="margin-left: 0.5rem; padding: 0.5rem 1rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 0.875rem;">
                        Go
                    </button>
                </div>`;
            }

            document.getElementById('parsed-logs').innerHTML = html;
        }

        // New: Render summary of top errors/exceptions
        function renderLogSummary() {
            if (!window.errorGroups || !window.errorOrder) return;
            let html = '<div style="margin-bottom:1.5rem;"><h3 style="color:var(--danger);font-size:1.1rem;margin-bottom:0.5rem;">Top Errors / Exceptions</h3>';
            let shown = 0;
            window.errorOrder.sort((a,b)=>window.errorGroups[b].count-window.errorGroups[a].count);
            for (const key of window.errorOrder) {
                const group = window.errorGroups[key];
                if (group.count === 0) continue;
                html += `<div style="margin-bottom:0.75rem;padding:0.75rem 1rem;background:rgba(239,68,68,0.08);border-radius:6px;border:1px solid var(--danger);">
                    <div style="font-weight:600;color:var(--danger);margin-bottom:0.25rem;">${escapeHtml(key)} <span style="color:var(--text-secondary);font-weight:400;">(${group.count})</span></div>
                    <div style="font-size:0.95em;color:var(--text-primary);max-height:4.5em;overflow:hidden;text-overflow:ellipsis;">${escapeHtml(group.logs[0].message)}</div>
                </div>`;
                shown++;
                if (shown >= 5) break;
            }
            if (shown === 0) html += '<div style="color:var(--text-secondary);">No errors/exceptions detected.</div>';
            html += '</div>';
            // Insert at top of parsed-logs panel
            const parsedLogsDiv = document.getElementById('parsed-logs');
            parsedLogsDiv.innerHTML = html + parsedLogsDiv.innerHTML;
        }

        function changePage(newPage) {
            const totalPages = Math.max(1, Math.ceil(totalFilteredLogs / logsPerPage));
            if (newPage < 1 || newPage > totalPages) return;
            
            currentPage = newPage;
            renderParsedLogs();
            
            document.getElementById('parsed-logs').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function goToPage() {
            const input = document.getElementById('goto-page');
            const page = parseInt(input.value);
            const totalPages = Math.ceil(totalFilteredLogs / logsPerPage);
            if (isNaN(page) || page < 1 || page > totalPages) {
                showToast('Enter a page number between 1 and ' + totalPages, 'error');
                return;
            }
            changePage(page);
            input.value = '';
        }

        function renderLogTimeline() {
            const levels = ['ERROR', 'WARN', 'INFO', 'DEBUG'];
            const counts = {};
            levels.forEach(l => counts[l] = 0);
            parsedLogs.forEach(log => counts[log.level]++);

            const total = parsedLogs.length || 1;
            const colors = {
                ERROR: 'var(--danger)',
                WARN: 'var(--warning)',
                INFO: 'var(--success)',
                DEBUG: 'var(--text-secondary)'
            };

            let html = '<div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Log Level Distribution</div>';
            html += '<div style="display: flex; height: 20px; border-radius: 4px; overflow: hidden;">';
            levels.forEach(level => {
                const percent = (counts[level] / total) * 100;
                if (percent > 0) {
                    html += `<div style="width: ${percent}%; background: ${colors[level]};" title="${level}: ${counts[level].toLocaleString()}"></div>`;
                }
            });
            html += '</div>';
            html += '<div style="display: flex; justify-content: space-around; margin-top: 0.5rem; font-size: 0.75rem;">';
            levels.forEach(level => {
                html += `<div style="color: ${colors[level]};">â— ${level}: ${counts[level].toLocaleString()}</div>`;
            });
            html += '</div>';
            const timeline = document.getElementById('log-timeline');
            timeline.innerHTML = html;
        }

        function updateLogStats() {
            const levels = ['ERROR', 'WARN', 'INFO', 'DEBUG'];
            const counts = {};
            levels.forEach(l => counts[l] = 0);
            parsedLogs.forEach(log => counts[log.level]++);

            const statsContainer = document.getElementById('log-stats');
            statsContainer.innerHTML = `
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Statistics</div>
                <div style="display: grid; gap: 0.5rem;">
                    <div>Total Logs: <span style="font-weight: 600;">${parsedLogs.length.toLocaleString()}</span></div>
                    <div>Errors: <span style="color: var(--danger); font-weight: 600;">${counts.ERROR.toLocaleString()}</span></div>
                    <div>Warnings: <span style="color: var(--warning); font-weight: 600;">${counts.WARN.toLocaleString()}</span></div>
                    <div>Info: <span style="color: var(--success); font-weight: 600;">${counts.INFO.toLocaleString()}</span></div>
                    <div>Debug: <span style="color: var(--text-secondary); font-weight: 600;">${counts.DEBUG.toLocaleString()}</span></div>
                </div>
            `;
        }

        function exportFilteredLogs() {
            const filters = {
                ERROR: document.getElementById('filter-error').checked,
                WARN: document.getElementById('filter-warn').checked,
                INFO: document.getElementById('filter-info').checked,
                DEBUG: document.getElementById('filter-debug').checked
            };

            const regexInput = document.getElementById('log-regex').value;
            let regexFilter = null;
            try {
                if (regexInput) regexFilter = new RegExp(regexInput, 'i');
            } catch (e) {}

            const filtered = parsedLogs.filter(log => {
                if (!filters[log.level]) return false;
                if (regexFilter && !regexFilter.test(log.message)) return false;
                return true;
            });

            if (filtered.length === 0) {
                showToast('No logs to export with current filters', 'error');
                return;
            }

            const logText = filtered.map(log => {
                let text = `${log.timestamp} ${log.level} ${log.message}`;
                if (log.stackTrace.length > 0) {
                    text += '\n' + log.stackTrace.join('\n');
                }
                return text;
            }).join('\n');

            const blob = new Blob([logText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `filtered_logs_${Date.now()}.log`;
            a.click();
            URL.revokeObjectURL(url);
            showToast(`Exported ${filtered.length.toLocaleString()} logs!`, 'success');
        }

        // SQL Query Builder Functions
        let sqlBuilderDb = null;

        function initSqlBuilder() {
            if (sqlBuilderDb) return;

            if (!window.initSqlJS) {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js';
                script.onload = () => {
                    initSqlJS({ locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}` }).then(SQL => {
                        sqlBuilderDb = new SQL.Database();
                        sqlBuilderDb.run(`
                            CREATE TABLE users (
                                id INTEGER PRIMARY KEY,
                                name TEXT NOT NULL,
                                email TEXT UNIQUE,
                                age INTEGER,
                                status TEXT DEFAULT 'active'
                            );
                            INSERT INTO users VALUES (1, 'John Doe', 'john@example.com', 30, 'active');
                            INSERT INTO users VALUES (2, 'Jane Smith', 'jane@example.com', 25, 'active');
                            INSERT INTO users VALUES (3, 'Bob Johnson', 'bob@example.com', 35, 'inactive');

                            CREATE TABLE orders (
                                id INTEGER PRIMARY KEY,
                                user_id INTEGER,
                                product TEXT,
                                amount REAL,
                                created_at TEXT
                            );
                            INSERT INTO orders VALUES (1, 1, 'Laptop', 999.99, '2024-01-15');
                            INSERT INTO orders VALUES (2, 1, 'Mouse', 29.99, '2024-01-16');
                            INSERT INTO orders VALUES (3, 2, 'Keyboard', 79.99, '2024-01-17');
                        `);
                        showToast('SQL environment ready with sample data', 'success');
                    });
                };
                document.head.appendChild(script);
            }
        }

        function updateSqlBuilder() {
            const queryType = document.getElementById('sql-query-type').value;
            
            document.getElementById('sql-select-fields').style.display = queryType === 'SELECT' ? 'block' : 'none';
            document.getElementById('sql-insert-fields').style.display = queryType === 'INSERT' ? 'block' : 'none';
            document.getElementById('sql-update-fields').style.display = queryType === 'UPDATE' ? 'block' : 'none';
            document.getElementById('sql-where-section').style.display = queryType !== 'INSERT' ? 'block' : 'none';
            document.getElementById('sql-order-section').style.display = queryType === 'SELECT' ? 'block' : 'none';

            buildQuery();
        }

        function buildQuery() {
            const queryType = document.getElementById('sql-query-type').value;
            const table = document.getElementById('sql-table').value.trim() || 'table_name';
            let query = '';

            if (queryType === 'SELECT') {
                const columns = document.getElementById('sql-columns').value.trim() || '*';
                query = `SELECT ${columns}\nFROM ${table}`;
                
                const where = document.getElementById('sql-where').value.trim();
                if (where) query += `\nWHERE ${where}`;
                
                const order = document.getElementById('sql-order').value.trim();
                if (order) query += `\nORDER BY ${order}`;
            } else if (queryType === 'INSERT') {
                const valuesJson = document.getElementById('sql-values').value.trim();
                try {
                    const values = JSON.parse(valuesJson || '{}');
                    const columns = Object.keys(values).join(', ');
                    const vals = Object.values(values).map(v => typeof v === 'string' ? `'${v}'` : v).join(', ');
                    query = `INSERT INTO ${table} (${columns})\nVALUES (${vals})`;
                } catch (e) {
                    query = `INSERT INTO ${table} (column1, column2)\nVALUES (value1, value2)`;
                }
            } else if (queryType === 'UPDATE') {
                const setJson = document.getElementById('sql-set-values').value.trim();
                try {
                    const values = JSON.parse(setJson || '{}');
                    const sets = Object.entries(values).map(([k, v]) => 
                        `${k} = ${typeof v === 'string' ? `'${v}'` : v}`
                    ).join(', ');
                    query = `UPDATE ${table}\nSET ${sets}`;
                } catch (e) {
                    query = `UPDATE ${table}\nSET column1 = value1, column2 = value2`;
                }
                
                const where = document.getElementById('sql-where').value.trim();
                if (where) query += `\nWHERE ${where}`;
            } else if (queryType === 'DELETE') {
                query = `DELETE FROM ${table}`;
                const where = document.getElementById('sql-where').value.trim();
                if (where) query += `\nWHERE ${where}`;
            }

            document.getElementById('sql-output').value = query;
        }

        function formatSqlQuery() {
            buildQuery();
        }

        function copySqlQuery() {
            const query = document.getElementById('sql-output').value;
            if (query) {
                navigator.clipboard.writeText(query);
                showToast('Query copied!', 'success');
            }
        }

        function executeSqlQuery() {
            if (!sqlBuilderDb) {
                showToast('SQL environment not ready. Please wait...', 'error');
                return;
            }

            const query = document.getElementById('sql-output').value;
            if (!query.trim()) {
                showToast('No query to execute', 'error');
                return;
            }

            try {
                const results = sqlBuilderDb.exec(query);
                const container = document.getElementById('sql-results');
                
                if (results.length === 0) {
                    container.innerHTML = '<div style="color: var(--success); padding: 1rem; text-align: center;">Query executed successfully (0 rows affected)</div>';
                    return;
                }

                const result = results[0];
                const table = `
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: var(--bg-tertiary); border-radius: 6px; overflow: hidden;">
                            <thead>
                                <tr style="background: var(--bg-primary);">
                                    ${result.columns.map(col => `<th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid var(--border);">${col}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${result.values.map(row => `
                                    <tr style="border-bottom: 1px solid var(--border);">
                                        ${row.map(cell => `<td style="padding: 0.75rem;">${cell !== null ? cell : '<span style="color: var(--text-secondary);">NULL</span>'}</td>`).join('')}
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem; text-align: center;">
                        ${result.values.length} row(s) returned
                    </div>
                `;
                container.innerHTML = table;
                showToast('Query executed successfully', 'success');
            } catch (error) {
                document.getElementById('sql-results').innerHTML = `
                    <div style="color: var(--danger); padding: 1rem; background: var(--bg-tertiary); border-radius: 6px; border-left: 3px solid var(--danger);">
                        <div style="font-weight: 600; margin-bottom: 0.5rem;">SQL Error:</div>
                        <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">${error.message}</div>
                    </div>
                `;
                showToast('Query execution failed', 'error');
            }
        }

        function loadSqlTemplate() {
            const template = document.getElementById('sql-template').value;
            const templates = {
                'basic-select': {
                    type: 'SELECT',
                    table: 'users',
                    columns: 'id, name, email',
                    where: '',
                    order: ''
                },
                'join': {
                    type: 'SELECT',
                    table: 'users u JOIN orders o ON u.id = o.user_id',
                    columns: 'u.name, o.product, o.amount',
                    where: '',
                    order: 'o.created_at DESC'
                },
                'aggregate': {
                    type: 'SELECT',
                    table: 'orders',
                    columns: 'user_id, COUNT(*) as order_count, SUM(amount) as total',
                    where: '',
                    order: ''
                },
                'insert': {
                    type: 'INSERT',
                    table: 'users',
                    values: JSON.stringify({ name: 'New User', email: 'newuser@example.com', age: 28, status: 'active' }, null, 2)
                },
                'update': {
                    type: 'UPDATE',
                    table: 'users',
                    setValues: JSON.stringify({ status: 'inactive' }, null, 2),
                    where: 'id = 3'
                },
                'delete': {
                    type: 'DELETE',
                    table: 'users',
                    where: 'status = \'inactive\''
                }
            };

            if (!template || !templates[template]) return;

            const t = templates[template];
            document.getElementById('sql-query-type').value = t.type;
            document.getElementById('sql-table').value = t.table;
            
            if (t.columns) document.getElementById('sql-columns').value = t.columns;
            if (t.values) document.getElementById('sql-values').value = t.values;
            if (t.setValues) document.getElementById('sql-set-values').value = t.setValues;
            if (t.where !== undefined) document.getElementById('sql-where').value = t.where;
            if (t.order !== undefined) document.getElementById('sql-order').value = t.order;

            updateSqlBuilder();
            document.getElementById('sql-template').value = '';
        }

        // ===== SUBNET CALCULATOR FUNCTIONS =====
        let currentSubnetData = null;

        function switchSubnetVersion(version) {
            document.querySelectorAll('.subnet-version-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('#subnet-calc-page .tool-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(`${version}-subnet`).style.display = 'block';
            document.getElementById(`${version}-tab`).classList.add('active');
        }

        function calculateIPv4Subnet() {
            const ipInput = document.getElementById('ipv4-address').value.trim();
            const maskInput = document.getElementById('ipv4-mask').value.trim();
            const cidrInput = document.getElementById('ipv4-cidr').value.trim();
            
            if (!ipInput) {
                showToast('Please enter an IP address', 'error');
                return;
            }
            
            try {
                let ip = ipInput;
                let cidr;
                
                if (ip.includes('/')) {
                    [ip, cidr] = ip.split('/');
                    cidr = parseInt(cidr);
                } else if (cidrInput) {
                    cidr = parseInt(cidrInput);
                } else if (maskInput) {
                    cidr = maskToCIDR(maskInput);
                } else {
                    showToast('Please enter subnet mask or CIDR notation', 'error');
                    return;
                }
                
                if (cidr < 0 || cidr > 32 || isNaN(cidr)) {
                    showToast('CIDR must be between 0 and 32', 'error');
                    return;
                }
                
                if (!isValidIPv4(ip)) {
                    showToast('Invalid IPv4 address format', 'error');
                    return;
                }
                
                const subnetData = calculateIPv4SubnetDetails(ip, cidr);
                currentSubnetData = { version: 'ipv4', data: subnetData };
                displayIPv4Results(subnetData);
                
                showToast('Subnet calculated successfully!', 'success');
            } catch (error) {
                showToast('Error calculating subnet: ' + error.message, 'error');
            }
        }

        function isValidIPv4(ip) {
            const parts = ip.split('.');
            if (parts.length !== 4) return false;
            return parts.every(part => {
                const num = parseInt(part);
                return num >= 0 && num <= 255 && part === num.toString();
            });
        }

        function maskToCIDR(mask) {
            const parts = mask.split('.');
            if (parts.length !== 4) throw new Error('Invalid subnet mask');
            
            let binary = '';
            parts.forEach(part => {
                const num = parseInt(part);
                if (num < 0 || num > 255) throw new Error('Invalid subnet mask');
                binary += num.toString(2).padStart(8, '0');
            });
            
            const cidr = binary.indexOf('0');
            return cidr === -1 ? 32 : cidr;
        }

        function cidrToMask(cidr) {
            const mask = [];
            for (let i = 0; i < 4; i++) {
                const n = Math.min(cidr, 8);
                mask.push(256 - Math.pow(2, 8 - n));
                cidr -= n;
            }
            return mask.join('.');
        }

        function ipToInt(ip) {
            return ip.split('.').reduce((int, octet) => (int << 8) + parseInt(octet), 0) >>> 0;
        }

        function intToIp(int) {
            return [(int >>> 24) & 255, (int >>> 16) & 255, (int >>> 8) & 255, int & 255].join('.');
        }

        function calculateIPv4SubnetDetails(ip, cidr) {
            const ipInt = ipToInt(ip);
            const maskInt = (0xFFFFFFFF << (32 - cidr)) >>> 0;
            const networkInt = (ipInt & maskInt) >>> 0;
            const broadcastInt = (networkInt | ~maskInt) >>> 0;
            
            const totalHosts = Math.pow(2, 32 - cidr);
            const usableHosts = cidr === 32 ? 1 : cidr === 31 ? 2 : totalHosts - 2;
            
            const firstUsable = cidr === 32 ? networkInt : cidr === 31 ? networkInt : networkInt + 1;
            const lastUsable = cidr === 32 ? networkInt : cidr === 31 ? broadcastInt : broadcastInt - 1;
            
            const wildcardMask = intToIp(~maskInt >>> 0);
            const subnetMask = cidrToMask(cidr);
            
            const ipBinary = ip.split('.').map(o => parseInt(o).toString(2).padStart(8, '0')).join('.');
            const maskBinary = subnetMask.split('.').map(o => parseInt(o).toString(2).padStart(8, '0')).join('.');
            
            const firstOctet = parseInt(ip.split('.')[0]);
            let ipClass = 'Unknown';
            if (firstOctet >= 1 && firstOctet <= 126) ipClass = 'A';
            else if (firstOctet >= 128 && firstOctet <= 191) ipClass = 'B';
            else if (firstOctet >= 192 && firstOctet <= 223) ipClass = 'C';
            else if (firstOctet >= 224 && firstOctet <= 239) ipClass = 'D (Multicast)';
            else if (firstOctet >= 240 && firstOctet <= 255) ipClass = 'E (Reserved)';
            
            let ipType = 'Public';
            if (ip.startsWith('10.') || 
                (firstOctet === 172 && parseInt(ip.split('.')[1]) >= 16 && parseInt(ip.split('.')[1]) <= 31) ||
                ip.startsWith('192.168.')) {
                ipType = 'Private';
            } else if (ip.startsWith('127.')) {
                ipType = 'Loopback';
            } else if (ip.startsWith('169.254.')) {
                ipType = 'Link-Local';
            }
            
            return {
                ip, cidr, subnetMask, wildcardMask,
                network: intToIp(networkInt),
                broadcast: intToIp(broadcastInt),
                firstUsable: intToIp(firstUsable),
                lastUsable: intToIp(lastUsable),
                totalHosts, usableHosts,
                ipBinary, maskBinary, ipClass, ipType,
                networkInt, broadcastInt,
                firstUsableInt: firstUsable,
                lastUsableInt: lastUsable
            };
        }

        function displayIPv4Results(data) {
            const resultDiv = document.getElementById('ipv4-result');
            
            const html = `
                <div style="display: grid; gap: 1rem;">
                    <div style="padding: 1rem; background: rgba(99, 102, 241, 0.1); border-left: 3px solid var(--primary); border-radius: 4px;">
                        <div style="color: var(--primary-light); font-weight: 600; margin-bottom: 0.5rem;">Network Summary</div>
                        <div><strong>Address:</strong> ${data.ip}/${data.cidr}</div>
                        <div><strong>Network:</strong> ${data.network}</div>
                        <div><strong>Broadcast:</strong> ${data.broadcast}</div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(16, 185, 129, 0.1); border-left: 3px solid var(--secondary); border-radius: 4px;">
                        <div style="color: var(--secondary); font-weight: 600; margin-bottom: 0.5rem;">IP Availability</div>
                        <div><strong>Total Addresses:</strong> ${data.totalHosts.toLocaleString()}</div>
                        <div><strong>Usable Hosts:</strong> <span style="color: var(--secondary); font-weight: 700;">${data.usableHosts.toLocaleString()}</span></div>
                        <div><strong>First Usable:</strong> ${data.firstUsable}</div>
                        <div><strong>Last Usable:</strong> ${data.lastUsable}</div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(245, 158, 11, 0.1); border-left: 3px solid var(--warning); border-radius: 4px;">
                        <div style="color: var(--warning); font-weight: 600; margin-bottom: 0.5rem;">Subnet Details</div>
                        <div><strong>Subnet Mask:</strong> ${data.subnetMask}</div>
                        <div><strong>Wildcard Mask:</strong> ${data.wildcardMask}</div>
                        <div><strong>CIDR Notation:</strong> /${data.cidr}</div>
                        <div><strong>IP Class:</strong> ${data.ipClass}</div>
                        <div><strong>IP Type:</strong> ${data.ipType}</div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 4px;">
                        <div style="color: var(--text-secondary); font-weight: 600; margin-bottom: 0.5rem;">Binary Representation</div>
                        <div style="font-size: 0.75rem; word-break: break-all;">
                            <div style="margin-bottom: 0.5rem;"><strong>IP:</strong> ${data.ipBinary}</div>
                            <div><strong>Mask:</strong> ${data.maskBinary}</div>
                        </div>
                    </div>
                </div>
            `;
            
            resultDiv.innerHTML = html;
            document.getElementById('ipv4-ip-range').style.display = 'block';
            document.getElementById('ipv4-ip-list').innerHTML = '<div style="color: var(--text-muted); padding: 1rem; text-align: center;">Click a button above to show IP addresses</div>';
        }

        function showIPRange(version, range, count) {
            if (!currentSubnetData || currentSubnetData.version !== version) {
                showToast('Calculate subnet first', 'error');
                return;
            }
            
            const data = currentSubnetData.data;
            const listDiv = document.getElementById(`${version}-ip-list`);
            
            if (version === 'ipv4') {
                const maxShow = 1024;
                let ips = [];
                
                if (range === 'all') {
                    if (data.usableHosts > maxShow) {
                        showToast(`Too many IPs (${data.usableHosts.toLocaleString()}). Showing first ${maxShow}`, 'warning');
                        count = maxShow;
                        range = 'first';
                    } else {
                        for (let i = data.firstUsableInt; i <= data.lastUsableInt && ips.length < maxShow; i++) {
                            ips.push(intToIp(i));
                        }
                    }
                } else if (range === 'first') {
                    for (let i = data.firstUsableInt; i <= data.lastUsableInt && ips.length < count; i++) {
                        ips.push(intToIp(i));
                    }
                } else if (range === 'last') {
                    const start = Math.max(data.firstUsableInt, data.lastUsableInt - count + 1);
                    for (let i = start; i <= data.lastUsableInt; i++) {
                        ips.push(intToIp(i));
                    }
                }
                
                if (ips.length === 0) {
                    listDiv.innerHTML = '<div style="color: var(--text-muted); padding: 1rem; text-align: center;">No usable IPs in this subnet</div>';
                    return;
                }
                
                const html = `
                    <div style="margin-bottom: 0.5rem; color: var(--text-secondary);">Showing ${ips.length.toLocaleString()} of ${data.usableHosts.toLocaleString()} usable IPs</div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 0.5rem;">
                        ${ips.map((ip, idx) => `
                            <div style="padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; font-size: 0.75rem;">
                                <div style="color: var(--text-secondary);">#${range === 'last' ? data.usableHosts - ips.length + idx + 1 : idx + 1}</div>
                                <div style="color: var(--text-primary);">${ip}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                listDiv.innerHTML = html;
            }
        }

        function exportIPList(version) {
            if (!currentSubnetData || currentSubnetData.version !== version) {
                showToast('Calculate subnet first', 'error');
                return;
            }
            
            const data = currentSubnetData.data;
            
            if (version === 'ipv4') {
                if (data.usableHosts > 65536) {
                    if (!confirm(`This subnet has ${data.usableHosts.toLocaleString()} IPs. Export may take time. Continue?`)) {
                        return;
                    }
                }
                
                let content = `IPv4 Subnet: ${data.network}/${data.cidr}\n`;
                content += `Usable IP Addresses: ${data.usableHosts.toLocaleString()}\n\n`;
                
                for (let i = data.firstUsableInt; i <= data.lastUsableInt; i++) {
                    content += intToIp(i) + '\n';
                }
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ipv4_subnet_${data.network.replace(/\./g, '_')}_${data.cidr}.txt`;
                a.click();
                URL.revokeObjectURL(url);
                
                showToast('IP list exported!', 'success');
            }
        }

        function calculateIPv6Subnet() {
            const ipInput = document.getElementById('ipv6-address').value.trim();
            const prefixInput = document.getElementById('ipv6-prefix').value.trim();
            
            if (!ipInput) {
                showToast('Please enter an IPv6 address', 'error');
                return;
            }
            
            try {
                let ip = ipInput;
                let prefix;
                
                if (ip.includes('/')) {
                    [ip, prefix] = ip.split('/');
                    prefix = parseInt(prefix);
                } else if (prefixInput) {
                    prefix = parseInt(prefixInput);
                } else {
                    showToast('Please enter prefix length', 'error');
                    return;
                }
                
                if (prefix < 0 || prefix > 128 || isNaN(prefix)) {
                    showToast('Prefix must be between 0 and 128', 'error');
                    return;
                }
                
                const subnetData = calculateIPv6SubnetDetails(ip, prefix);
                currentSubnetData = { version: 'ipv6', data: subnetData };
                displayIPv6Results(subnetData);
                
                showToast('IPv6 subnet calculated successfully!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        }

        function expandIPv6(ip) {
            let expanded = ip.toLowerCase();
            
            if (expanded.includes('::')) {
                const parts = expanded.split('::');
                const leftParts = parts[0] ? parts[0].split(':') : [];
                const rightParts = parts[1] ? parts[1].split(':') : [];
                const missingParts = 8 - leftParts.length - rightParts.length;
                const middle = Array(missingParts).fill('0000');
                expanded = [...leftParts, ...middle, ...rightParts].join(':');
            }
            
            return expanded.split(':').map(seg => seg.padStart(4, '0')).join(':');
        }

        function calculateIPv6SubnetDetails(ip, prefix) {
            const fullIP = expandIPv6(ip);
            const segments = fullIP.split(':');
            
            if (segments.length !== 8) {
                throw new Error('Invalid IPv6 address format');
            }
            
            const networkSegments = segments.map((seg, idx) => {
                const segNum = parseInt(seg, 16);
                const bitsInSeg = Math.max(0, Math.min(16, prefix - idx * 16));
                if (bitsInSeg === 0) return '0000';
                if (bitsInSeg === 16) return seg;
                const mask = (0xFFFF << (16 - bitsInSeg)) & 0xFFFF;
                return (segNum & mask).toString(16).padStart(4, '0');
            });
            
            const network = networkSegments.join(':');
            const networkCompressed = compressIPv6(network);
            
            const firstSegments = [...networkSegments];
            firstSegments[7] = (parseInt(firstSegments[7], 16) + 1).toString(16).padStart(4, '0');
            const firstUsable = compressIPv6(firstSegments.join(':'));
            
            const lastSegments = segments.map((seg, idx) => {
                const bitsInSeg = Math.max(0, Math.min(16, prefix - idx * 16));
                if (bitsInSeg === 16) return seg;
                return 'ffff';
            });
            lastSegments[7] = (parseInt(lastSegments[7], 16) - 1).toString(16).padStart(4, '0');
            const lastUsable = compressIPv6(lastSegments.join(':'));
            
            const totalAddresses = BigInt(2) ** BigInt(128 - prefix);
            const usableAddresses = totalAddresses - BigInt(2);
            
            let ipv6Type = 'Global Unicast';
            if (networkCompressed.startsWith('fe80:')) ipv6Type = 'Link-Local';
            else if (networkCompressed.startsWith('ff')) ipv6Type = 'Multicast';
            else if (networkCompressed.startsWith('fd') || networkCompressed.startsWith('fc')) ipv6Type = 'Unique Local';
            else if (networkCompressed === '::1') ipv6Type = 'Loopback';
            else if (networkCompressed === '::') ipv6Type = 'Unspecified';
            
            return {
                ip, prefix, fullIP, network, networkCompressed,
                firstUsable, lastUsable,
                totalAddresses: totalAddresses.toString(),
                usableAddresses: usableAddresses.toString(),
                ipv6Type,
                binaryPrefix: segments.slice(0, Math.ceil(prefix / 16)).map(s => 
                    parseInt(s, 16).toString(2).padStart(16, '0')
                ).join('.').substring(0, prefix)
            };
        }

        function compressIPv6(ip) {
            let compressed = ip.toLowerCase();
            
            compressed = compressed.split(':').map(seg => {
                return parseInt(seg, 16).toString(16);
            }).join(':');
            
            let longest = '';
            let current = '';
            const parts = compressed.split(':');
            
            for (let i = 0; i < parts.length; i++) {
                if (parts[i] === '0') {
                    current += (current ? ':' : '') + '0';
                } else {
                    if (current.split(':').length > longest.split(':').length) {
                        longest = current;
                    }
                    current = '';
                }
            }
            if (current.split(':').length > longest.split(':').length) {
                longest = current;
            }
            
            if (longest.split(':').length > 1) {
                compressed = compressed.replace(longest, '::');
                compressed = compressed.replace(/:{3,}/g, '::');
            }
            
            return compressed;
        }

        function displayIPv6Results(data) {
            const resultDiv = document.getElementById('ipv6-result');
            
            const totalStr = formatLargeNumber(data.totalAddresses);
            const usableStr = formatLargeNumber(data.usableAddresses);
            
            const html = `
                <div style="display: grid; gap: 1rem;">
                    <div style="padding: 1rem; background: rgba(99, 102, 241, 0.1); border-left: 3px solid var(--primary); border-radius: 4px;">
                        <div style="color: var(--primary-light); font-weight: 600; margin-bottom: 0.5rem;">Network Summary</div>
                        <div><strong>Address:</strong> ${data.ip}/${data.prefix}</div>
                        <div><strong>Full Address:</strong> ${data.fullIP}</div>
                        <div><strong>Network:</strong> ${data.networkCompressed}</div>
                        <div><strong>Type:</strong> ${data.ipv6Type}</div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(16, 185, 129, 0.1); border-left: 3px solid var(--secondary); border-radius: 4px;">
                        <div style="color: var(--secondary); font-weight: 600; margin-bottom: 0.5rem;">Address Space</div>
                        <div><strong>Total Addresses:</strong> <span style="color: var(--secondary); font-weight: 700;">${totalStr}</span></div>
                        <div><strong>Usable Addresses:</strong> ${usableStr}</div>
                        <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-secondary);">
                            That's ${data.totalAddresses} addresses!<br>
                            (${(BigInt(data.totalAddresses) / BigInt(1000000000000)).toString()} trillion+)
                        </div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(245, 158, 11, 0.1); border-left: 3px solid var(--warning); border-radius: 4px;">
                        <div style="color: var(--warning); font-weight: 600; margin-bottom: 0.5rem;">Address Range</div>
                        <div><strong>First Usable:</strong> ${data.firstUsable}</div>
                        <div><strong>Last Usable:</strong> ${data.lastUsable}</div>
                        <div><strong>Prefix Length:</strong> /${data.prefix}</div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 4px;">
                        <div style="color: var(--text-secondary); font-weight: 600; margin-bottom: 0.5rem;">Binary Prefix</div>
                        <div style="font-size: 0.75rem; word-break: break-all; font-family: 'JetBrains Mono', monospace;">
                            ${data.binaryPrefix}... (${data.prefix} bits)
                        </div>
                    </div>
                </div>
            `;
            
            resultDiv.innerHTML = html;
            document.getElementById('ipv6-ip-range').style.display = 'block';
            
            const exampleHTML = `
                <div style="color: var(--text-secondary); margin-bottom: 1rem;">
                    Due to the massive address space (${totalStr} addresses), showing random examples:
                </div>
                <div style="display: grid; gap: 0.5rem;">
                    <div style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px;">
                        <strong>Network Address:</strong> ${data.networkCompressed}
                    </div>
                    <div style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px;">
                        <strong>First Usable:</strong> ${data.firstUsable}
                    </div>
                    <div style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px;">
                        <strong>Example Middle:</strong> ${generateRandomIPv6InSubnet(data)}
                    </div>
                    <div style="padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px;">
                        <strong>Last Usable:</strong> ${data.lastUsable}
                    </div>
                </div>
                <div style="margin-top: 1rem; padding: 1rem; background: rgba(99, 102, 241, 0.1); border-radius: 4px; font-size: 0.875rem;">
                    <strong>ðŸ’¡ Note:</strong> IPv6 subnets typically have astronomical numbers of addresses. A /64 subnet alone has 18,446,744,073,709,551,616 addresses - enough to give every person on Earth billions of addresses!
                </div>
            `;
            
            document.getElementById('ipv6-ip-list').innerHTML = exampleHTML;
        }

        function generateRandomIPv6InSubnet(data) {
            const segments = data.network.split(':');
            const prefix = data.prefix;
            
            const result = segments.map((seg, idx) => {
                const bitsInSeg = Math.max(0, Math.min(16, prefix - idx * 16));
                if (bitsInSeg === 16) return seg;
                if (bitsInSeg === 0) return Math.floor(Math.random() * 65536).toString(16).padStart(4, '0');
                
                const networkPart = parseInt(seg, 16);
                const hostBits = 16 - bitsInSeg;
                const randomHost = Math.floor(Math.random() * (2 ** hostBits));
                return (networkPart | randomHost).toString(16).padStart(4, '0');
            });
            
            return compressIPv6(result.join(':'));
        }

        function formatLargeNumber(numStr) {
            const num = BigInt(numStr);
            if (num < BigInt(1000)) return numStr;
            if (num < BigInt(1000000)) return (Number(num) / 1000).toFixed(2) + ' K';
            if (num < BigInt(1000000000)) return (Number(num) / 1000000).toFixed(2) + ' M';
            if (num < BigInt(1000000000000)) return (Number(num) / 1000000000).toFixed(2) + ' B';
            if (num < BigInt(1000000000000000)) return (Number(num) / 1000000000000).toFixed(2) + ' T';
            return (Number(num / BigInt(1000000000000000))).toFixed(2) + ' Q';
        }

        function copySubnetInfo(version) {
            if (!currentSubnetData || currentSubnetData.version !== version) {
                showToast('Calculate subnet first', 'error');
                return;
            }
            
            const data = currentSubnetData.data;
            let text = '';
            
            if (version === 'ipv4') {
                text = `IPv4 Subnet Information
========================
Address: ${data.ip}/${data.cidr}
Network: ${data.network}
Broadcast: ${data.broadcast}
Subnet Mask: ${data.subnetMask}
Wildcard Mask: ${data.wildcardMask}

IP Availability:
- Total Addresses: ${data.totalHosts.toLocaleString()}
- Usable Hosts: ${data.usableHosts.toLocaleString()}
- First Usable: ${data.firstUsable}
- Last Usable: ${data.lastUsable}

Network Details:
- IP Class: ${data.ipClass}
- IP Type: ${data.ipType}
- CIDR Notation: /${data.cidr}`;
            } else {
                text = `IPv6 Subnet Information
========================
Address: ${data.ip}/${data.prefix}
Full Address: ${data.fullIP}
Network: ${data.networkCompressed}
Type: ${data.ipv6Type}

Address Space:
- Total Addresses: ${data.totalAddresses}
- Usable Addresses: ${data.usableAddresses}
- First Usable: ${data.firstUsable}
- Last Usable: ${data.lastUsable}

Network Details:
- Prefix Length: /${data.prefix}`;
            }
            
            navigator.clipboard.writeText(text);
            showToast('Subnet information copied!', 'success');
        }

        // ===== PDF EDITOR FUNCTIONS =====
        let pdfEditorDoc = null;
        let pdfEditorCanvas = null;
        let pdfEditorCtx = null;
        let pdfEditorCurrentPage = 1;
        let pdfEditorTotalPages = 0;
        let pdfEditorScale = 1.5;
        let pdfEditorTool = null;
        let pdfEditorAnnotations = [];
        let pdfEditorHistory = [];
        let pdfEditorSelectedIndex = -1;
        let pdfEditorDragging = false;
        let pdfEditorDragStart = {x: 0, y: 0};
        let pdfEditorResizing = false;
        let pdfEditorResizeHandle = null;
        let pdfEditorSignatureImage = null;
        let pdfEditorDrawing = false;
        let pdfEditorDrawPoints = [];
        let pdfEditorTextInputActive = false;
        let pdfEditorIsDrawing = false;
        let pdfEditorLastX = 0;
        let pdfEditorLastY = 0;
        let pdfEditorHighlightColor = '#FFFF00';

        async function loadPdfForEditor() {
            const file = document.getElementById('pdf-editor-file').files[0];
            if (!file) return;

            try {
                const arrayBuffer = await file.arrayBuffer();
                pdfEditorDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                pdfEditorTotalPages = pdfEditorDoc.numPages;

                document.getElementById('pdf-editor-info').style.display = 'block';
                document.getElementById('pdf-editor-info').innerHTML = `ðŸ“„ <strong>${file.name}</strong><br>Pages: ${pdfEditorTotalPages} | Size: ${(file.size / 1024).toFixed(2)} KB`;

                const selector = document.getElementById('pdf-page-selector');
                selector.innerHTML = '';
                for (let i = 1; i <= pdfEditorTotalPages; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Page ${i} of ${pdfEditorTotalPages}`;
                    selector.appendChild(option);
                }

                pdfEditorCurrentPage = 1;
                pdfEditorAnnotations = [];
                pdfEditorHistory = [];
                pdfEditorSelectedIndex = -1;
                
                // Ensure only one keyboard listener exists (named function prevents duplicates)
                if (!window.pdfEditorKeyHandlerAttached) {
                    document.addEventListener('keydown', pdfEditorKeyHandler);
                    window.pdfEditorKeyHandlerAttached = true;
                }
                
                await renderPdfEditorPage();
                showToast('PDF loaded successfully!', 'success');
            } catch (error) {
                showToast('Failed to load PDF: ' + error.message, 'error');
            }
        }

        function pdfEditorKeyHandler(e) {
            if (e.key === 'Delete' && pdfEditorSelectedIndex >= 0 && !pdfEditorTextInputActive) {
                pdfEditorDeleteSelected();
            } else if (e.key === 'Escape' && pdfEditorTextInputActive) {
                cancelPdfTextInput();
            } else if (e.key === 'Enter' && pdfEditorTextInputActive) {
                e.preventDefault();
                savePdfTextInput();
            }
        }

        async function renderPdfEditorPage() {
            if (!pdfEditorDoc) return;

            const page = await pdfEditorDoc.getPage(pdfEditorCurrentPage);
            const viewport = page.getViewport({ scale: pdfEditorScale });

            const container = document.getElementById('pdf-editor-canvas-container');
            if (!pdfEditorCanvas) {
                pdfEditorCanvas = document.createElement('canvas');
                pdfEditorCanvas.style.border = '1px solid var(--border)';
                pdfEditorCanvas.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
                container.innerHTML = '';
                container.appendChild(pdfEditorCanvas);

                pdfEditorCanvas.addEventListener('mousedown', handlePdfEditorMouseDown);
                pdfEditorCanvas.addEventListener('mousemove', handlePdfEditorMouseMove);
                pdfEditorCanvas.addEventListener('mouseup', handlePdfEditorMouseUp);
                pdfEditorCanvas.addEventListener('click', handlePdfEditorClick);
            }

            pdfEditorCanvas.width = viewport.width;
            pdfEditorCanvas.height = viewport.height;
            pdfEditorCtx = pdfEditorCanvas.getContext('2d');

            await page.render({
                canvasContext: pdfEditorCtx,
                viewport: viewport
            }).promise;

            renderPdfAnnotations();
        }

        function selectPdfTool(tool) {
            pdfEditorTool = tool;

            document.querySelectorAll('#pdf-text-tool, #pdf-signature-tool, #pdf-draw-tool, #pdf-highlight-tool').forEach(btn => {
                btn.style.background = 'var(--bg-tertiary)';
                btn.style.borderColor = 'var(--border)';
            });

            const selectedBtn = document.getElementById(`pdf-${tool}-tool`);
            if (selectedBtn) {
                selectedBtn.style.background = 'rgba(99, 102, 241, 0.2)';
                selectedBtn.style.borderColor = 'var(--primary)';
            }

            document.getElementById('pdf-text-options').style.display = tool === 'text' ? 'block' : 'none';
            document.getElementById('pdf-signature-options').style.display = tool === 'signature' ? 'block' : 'none';
            document.getElementById('pdf-draw-options').style.display = tool === 'draw' ? 'block' : 'none';
            document.getElementById('pdf-highlight-options').style.display = tool === 'highlight' ? 'block' : 'none';

            if (pdfEditorCanvas) {
                pdfEditorCanvas.style.cursor = tool === 'text' ? 'text' : 
                                                 tool === 'signature' ? 'copy' :
                                                 tool === 'draw' ? 'crosshair' : 
                                                 tool === 'highlight' ? 'cell' : 'default';
            }
        }

        function uploadSignatureImage() {
            const file = document.getElementById('pdf-signature-upload').files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    pdfEditorSignatureImage = img;
                    const preview = document.getElementById('pdf-signature-preview');
                    preview.innerHTML = '';
                    const previewImg = document.createElement('img');
                    previewImg.src = e.target.result;
                    previewImg.style.maxWidth = '100%';
                    previewImg.style.maxHeight = '100px';
                    preview.appendChild(previewImg);
                    showToast('Signature uploaded! Click on PDF to place it', 'success');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function handlePdfEditorClick(e) {
            const rect = pdfEditorCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Check if clicking on existing annotation to select it
            let clickedIndex = -1;
            for (let i = pdfEditorAnnotations.length - 1; i >= 0; i--) {
                const ann = pdfEditorAnnotations[i];
                if (ann.page !== pdfEditorCurrentPage) continue;
                
                if (isPointInAnnotation(x, y, ann)) {
                    clickedIndex = i;
                    break;
                }
            }
            
            if (clickedIndex >= 0) {
                // Select the annotation
                pdfEditorSelectedIndex = clickedIndex;
                updateSelectedInfo();
                renderPdfAnnotations();
                return;
            }
            
            // Otherwise, add new annotation based on tool
            if (pdfEditorTool === 'text') {
                showPdfTextInput(x, y);
            } else if (pdfEditorTool === 'signature' && pdfEditorSignatureImage) {
                saveToHistory();
                pdfEditorAnnotations.push({
                    page: pdfEditorCurrentPage,
                    type: 'signature',
                    x, y,
                    width: 150,
                    height: 50,
                    image: pdfEditorSignatureImage
                });
                pdfEditorSelectedIndex = pdfEditorAnnotations.length - 1;
                updateSelectedInfo();
                renderPdfAnnotations();
                showToast('Signature placed! Drag corners to resize, drag center to move', 'success');
            } else if (pdfEditorTool === 'signature' && !pdfEditorSignatureImage) {
                showToast('Please upload a signature image first', 'error');
            }
        }
        
        function isPointInAnnotation(x, y, ann) {
            if (ann.type === 'text') {
                // Approximate text bounds
                pdfEditorCtx.font = `${ann.size}px Arial`;
                const metrics = pdfEditorCtx.measureText(ann.text);
                return x >= ann.x && x <= ann.x + metrics.width && 
                       y >= ann.y - ann.size && y <= ann.y;
            } else if (ann.type === 'signature' || ann.type === 'highlight') {
                return x >= ann.x && x <= ann.x + ann.width && 
                       y >= ann.y && y <= ann.y + ann.height;
            } else if (ann.type === 'draw') {
                // Check if click is near any point in the path
                for (let point of ann.points) {
                    const dist = Math.sqrt((x - point.x) ** 2 + (y - point.y) ** 2);
                    if (dist < 10) return true;
                }
            }
            return false;
        }
        
        function showPdfTextInput(x, y) {
            const input = document.getElementById('pdf-text-input');
            input.style.display = 'block';
            input.style.left = x + 'px';
            input.style.top = y + 'px';
            
            const size = parseInt(document.getElementById('pdf-text-size').value);
            const color = document.getElementById('pdf-text-color').value;
            input.style.fontSize = size + 'px';
            input.style.color = color;
            
            input.textContent = '';
            input.focus();
            
            pdfEditorTextInputActive = true;
            input.dataset.x = x;
            input.dataset.y = y;
        }
        
        function savePdfTextInput() {
            const input = document.getElementById('pdf-text-input');
            const text = input.textContent.trim();
            
            if (text) {
                saveToHistory();
                const x = parseFloat(input.dataset.x);
                const y = parseFloat(input.dataset.y);
                const size = parseInt(document.getElementById('pdf-text-size').value);
                const color = document.getElementById('pdf-text-color').value;
                
                pdfEditorAnnotations.push({
                    page: pdfEditorCurrentPage,
                    type: 'text',
                    x, y, text, size, color
                });
                
                pdfEditorSelectedIndex = pdfEditorAnnotations.length - 1;
                updateSelectedInfo();
                renderPdfAnnotations();
            }
            
            input.style.display = 'none';
            input.textContent = '';
            pdfEditorTextInputActive = false;
        }
        
        function cancelPdfTextInput() {
            const input = document.getElementById('pdf-text-input');
            input.style.display = 'none';
            input.textContent = '';
            pdfEditorTextInputActive = false;
        }

        function handlePdfEditorMouseDown(e) {
            if (pdfEditorTextInputActive) return;
            
            const rect = pdfEditorCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Check if clicking on resize handle of selected annotation
            if (pdfEditorSelectedIndex >= 0) {
                const ann = pdfEditorAnnotations[pdfEditorSelectedIndex];
                if (ann.type === 'signature' && ann.page === pdfEditorCurrentPage) {
                    const handle = getResizeHandle(x, y, ann);
                    if (handle) {
                        pdfEditorResizing = true;
                        pdfEditorResizeHandle = handle;
                        pdfEditorDragStart = {x, y, origWidth: ann.width, origHeight: ann.height, origX: ann.x, origY: ann.y};
                        return;
                    }
                }
                
                // Check if clicking on selected annotation to drag
                if (isPointInAnnotation(x, y, ann)) {
                    pdfEditorDragging = true;
                    pdfEditorDragStart = {x, y, origX: ann.x, origY: ann.y};
                    return;
                }
            }
            
            // Otherwise handle draw/highlight
            if (pdfEditorTool === 'draw' || pdfEditorTool === 'highlight') {
                pdfEditorIsDrawing = true;
                pdfEditorLastX = x;
                pdfEditorLastY = y;

                saveToHistory();
                if (pdfEditorTool === 'draw') {
                    const size = parseInt(document.getElementById('pdf-brush-size').value);
                    const color = document.getElementById('pdf-brush-color').value;
                    pdfEditorAnnotations.push({
                        page: pdfEditorCurrentPage,
                        type: 'draw',
                        points: [{ x, y }],
                        size, color
                    });
                    pdfEditorSelectedIndex = pdfEditorAnnotations.length - 1;
                } else if (pdfEditorTool === 'highlight') {
                    pdfEditorAnnotations.push({
                        page: pdfEditorCurrentPage,
                        type: 'highlight',
                        x,
                        y,
                        width: 0,
                        height: 20,
                        color: pdfEditorHighlightColor
                    });
                    pdfEditorSelectedIndex = pdfEditorAnnotations.length - 1;
                }
                updateSelectedInfo();
            }
        }

        function handlePdfEditorMouseMove(e) {
            const rect = pdfEditorCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Update cursor based on what's under the mouse
            if (!pdfEditorResizing && !pdfEditorDragging && pdfEditorSelectedIndex >= 0) {
                const ann = pdfEditorAnnotations[pdfEditorSelectedIndex];
                if (ann.page === pdfEditorCurrentPage) {
                    const handle = getResizeHandle(x, y, ann);
                    if (handle) {
                        const cursors = {
                            'nw': 'nwse-resize',
                            'ne': 'nesw-resize',
                            'sw': 'nesw-resize',
                            'se': 'nwse-resize'
                        };
                        pdfEditorCanvas.style.cursor = cursors[handle] || 'default';
                    } else if (isPointInAnnotation(x, y, ann)) {
                        pdfEditorCanvas.style.cursor = 'move';
                    } else {
                        // Reset to tool cursor
                        pdfEditorCanvas.style.cursor = pdfEditorTool === 'text' ? 'text' : 
                                                        pdfEditorTool === 'signature' ? 'copy' :
                                                        pdfEditorTool === 'draw' ? 'crosshair' : 
                                                        pdfEditorTool === 'highlight' ? 'cell' : 'default';
                    }
                }
            }
            
            // Handle resizing
            if (pdfEditorResizing && pdfEditorSelectedIndex >= 0) {
                const ann = pdfEditorAnnotations[pdfEditorSelectedIndex];
                const dx = x - pdfEditorDragStart.x;
                const dy = y - pdfEditorDragStart.y;
                
                if (pdfEditorResizeHandle === 'se') {
                    ann.width = Math.max(20, pdfEditorDragStart.origWidth + dx);
                    ann.height = Math.max(20, pdfEditorDragStart.origHeight + dy);
                } else if (pdfEditorResizeHandle === 'sw') {
                    ann.width = Math.max(20, pdfEditorDragStart.origWidth - dx);
                    ann.height = Math.max(20, pdfEditorDragStart.origHeight + dy);
                    ann.x = pdfEditorDragStart.origX + dx;
                } else if (pdfEditorResizeHandle === 'ne') {
                    ann.width = Math.max(20, pdfEditorDragStart.origWidth + dx);
                    ann.height = Math.max(20, pdfEditorDragStart.origHeight - dy);
                    ann.y = pdfEditorDragStart.origY + dy;
                } else if (pdfEditorResizeHandle === 'nw') {
                    ann.width = Math.max(20, pdfEditorDragStart.origWidth - dx);
                    ann.height = Math.max(20, pdfEditorDragStart.origHeight - dy);
                    ann.x = pdfEditorDragStart.origX + dx;
                    ann.y = pdfEditorDragStart.origY + dy;
                }
                
                renderPdfAnnotations();
                return;
            }
            
            // Handle dragging
            if (pdfEditorDragging && pdfEditorSelectedIndex >= 0) {
                const ann = pdfEditorAnnotations[pdfEditorSelectedIndex];
                const dx = x - pdfEditorDragStart.x;
                const dy = y - pdfEditorDragStart.y;
                
                ann.x = pdfEditorDragStart.origX + dx;
                ann.y = pdfEditorDragStart.origY + dy;
                
                renderPdfAnnotations();
                return;
            }
            
            // Handle drawing
            if (!pdfEditorIsDrawing) return;

            if (pdfEditorTool === 'draw') {
                const currentAnnotation = pdfEditorAnnotations[pdfEditorAnnotations.length - 1];
                currentAnnotation.points.push({ x, y });
                renderPdfAnnotations();
            } else if (pdfEditorTool === 'highlight') {
                const currentAnnotation = pdfEditorAnnotations[pdfEditorAnnotations.length - 1];
                currentAnnotation.width = x - currentAnnotation.x;
                renderPdfAnnotations();
            }

            pdfEditorLastX = x;
            pdfEditorLastY = y;
        }

        function handlePdfEditorMouseUp() {
            pdfEditorIsDrawing = false;
            pdfEditorDragging = false;
            pdfEditorResizing = false;
            pdfEditorResizeHandle = null;
        }
        
        function getResizeHandle(x, y, ann) {
            const handleSize = 12;  // Match the larger handle size
            const handles = [
                {name: 'nw', x: ann.x, y: ann.y},
                {name: 'ne', x: ann.x + ann.width, y: ann.y},
                {name: 'sw', x: ann.x, y: ann.y + ann.height},
                {name: 'se', x: ann.x + ann.width, y: ann.y + ann.height}
            ];
            
            for (let h of handles) {
                if (Math.abs(x - h.x) < handleSize && Math.abs(y - h.y) < handleSize) {
                    return h.name;
                }
            }
            return null;
        }

        async function renderPdfAnnotations() {
            if (!pdfEditorCanvas || !pdfEditorCtx || !pdfEditorDoc) return;

            const page = await pdfEditorDoc.getPage(pdfEditorCurrentPage);
            const viewport = page.getViewport({ scale: pdfEditorScale });

            pdfEditorCanvas.width = viewport.width;
            pdfEditorCanvas.height = viewport.height;

            await page.render({
                canvasContext: pdfEditorCtx,
                viewport: viewport
            }).promise;

            pdfEditorAnnotations
                .filter((ann, i) => ann.page === pdfEditorCurrentPage)
                .forEach((ann, listIndex) => {
                    const globalIndex = pdfEditorAnnotations.indexOf(ann);
                    const isSelected = globalIndex === pdfEditorSelectedIndex;
                    
                    if (ann.type === 'text') {
                        pdfEditorCtx.font = `${ann.size}px Arial`;
                        pdfEditorCtx.fillStyle = ann.color;
                        pdfEditorCtx.fillText(ann.text, ann.x, ann.y);
                        
                        if (isSelected) {
                            const metrics = pdfEditorCtx.measureText(ann.text);
                            // Glowing selection border
                            pdfEditorCtx.shadowColor = 'rgba(99, 102, 241, 0.5)';
                            pdfEditorCtx.shadowBlur = 8;
                            pdfEditorCtx.strokeStyle = '#6366f1';
                            pdfEditorCtx.lineWidth = 3;
                            pdfEditorCtx.strokeRect(ann.x - 4, ann.y - ann.size - 4, metrics.width + 8, ann.size + 8);
                            pdfEditorCtx.shadowBlur = 0;
                        }
                    } else if (ann.type === 'signature') {
                        pdfEditorCtx.drawImage(ann.image, ann.x, ann.y, ann.width, ann.height);
                        
                        if (isSelected) {
                            // Glowing selection border with animated effect
                            pdfEditorCtx.shadowColor = 'rgba(99, 102, 241, 0.6)';
                            pdfEditorCtx.shadowBlur = 12;
                            pdfEditorCtx.strokeStyle = '#6366f1';
                            pdfEditorCtx.lineWidth = 3;
                            pdfEditorCtx.strokeRect(ann.x - 2, ann.y - 2, ann.width + 4, ann.height + 4);
                            pdfEditorCtx.shadowBlur = 0;
                            
                            // Larger, more visible resize handles with gradient
                            const handleSize = 12;
                            const handles = [
                                {x: ann.x, y: ann.y, cursor: 'nwse-resize'},
                                {x: ann.x + ann.width, y: ann.y, cursor: 'nesw-resize'},
                                {x: ann.x, y: ann.y + ann.height, cursor: 'nesw-resize'},
                                {x: ann.x + ann.width, y: ann.y + ann.height, cursor: 'nwse-resize'}
                            ];
                            
                            handles.forEach(h => {
                                // Outer glow
                                pdfEditorCtx.shadowColor = 'rgba(99, 102, 241, 0.8)';
                                pdfEditorCtx.shadowBlur = 6;
                                pdfEditorCtx.fillStyle = '#ffffff';
                                pdfEditorCtx.fillRect(h.x - handleSize/2, h.y - handleSize/2, handleSize, handleSize);
                                pdfEditorCtx.shadowBlur = 0;
                                
                                // Inner color
                                pdfEditorCtx.fillStyle = '#6366f1';
                                pdfEditorCtx.fillRect(h.x - handleSize/2 + 2, h.y - handleSize/2 + 2, handleSize - 4, handleSize - 4);
                            });
                        }
                    } else if (ann.type === 'draw') {
                        pdfEditorCtx.strokeStyle = ann.color;
                        pdfEditorCtx.lineWidth = ann.size;
                        pdfEditorCtx.lineCap = 'round';
                        pdfEditorCtx.lineJoin = 'round';
                        pdfEditorCtx.beginPath();
                        ann.points.forEach((point, i) => {
                            if (i === 0) {
                                pdfEditorCtx.moveTo(point.x, point.y);
                            } else {
                                pdfEditorCtx.lineTo(point.x, point.y);
                            }
                        });
                        pdfEditorCtx.stroke();
                        
                        if (isSelected) {
                            // Draw glowing selection dots at key points
                            pdfEditorCtx.shadowColor = 'rgba(99, 102, 241, 0.7)';
                            pdfEditorCtx.shadowBlur = 6;
                            pdfEditorCtx.fillStyle = '#6366f1';
                            const step = Math.max(1, Math.floor(ann.points.length / 10));
                            ann.points.forEach((point, i) => {
                                if (i % step === 0 || i === ann.points.length - 1) {
                                    pdfEditorCtx.beginPath();
                                    pdfEditorCtx.arc(point.x, point.y, 5, 0, Math.PI * 2);
                                    pdfEditorCtx.fill();
                                }
                            });
                            pdfEditorCtx.shadowBlur = 0;
                        }
                    } else if (ann.type === 'highlight') {
                        pdfEditorCtx.fillStyle = ann.color + '80';
                        pdfEditorCtx.fillRect(ann.x, ann.y, ann.width, ann.height);
                        
                        if (isSelected) {
                            // Glowing selection border
                            pdfEditorCtx.shadowColor = 'rgba(99, 102, 241, 0.5)';
                            pdfEditorCtx.shadowBlur = 10;
                            pdfEditorCtx.strokeStyle = '#6366f1';
                            pdfEditorCtx.lineWidth = 3;
                            pdfEditorCtx.strokeRect(ann.x - 2, ann.y - 2, ann.width + 4, ann.height + 4);
                            pdfEditorCtx.shadowBlur = 0;
                        }
                    }
                });
        }
        
        function saveToHistory() {
            pdfEditorHistory.push(JSON.parse(JSON.stringify(pdfEditorAnnotations)));
            if (pdfEditorHistory.length > 20) pdfEditorHistory.shift();
        }
        
        function updateSelectedInfo() {
            const info = document.getElementById('pdf-selected-info');
            if (pdfEditorSelectedIndex >= 0 && pdfEditorSelectedIndex < pdfEditorAnnotations.length) {
                const ann = pdfEditorAnnotations[pdfEditorSelectedIndex];
                info.style.display = 'block';
                document.getElementById('pdf-selected-type').textContent = ann.type.charAt(0).toUpperCase() + ann.type.slice(1);
            } else {
                info.style.display = 'none';
                pdfEditorSelectedIndex = -1;
            }
        }
        
        function pdfEditorUndo() {
            if (pdfEditorHistory.length === 0) {
                showToast('Nothing to undo', 'error');
                return;
            }
            pdfEditorAnnotations = pdfEditorHistory.pop();
            pdfEditorSelectedIndex = -1;
            updateSelectedInfo();
            renderPdfAnnotations();
            showToast('Undo successful', 'success');
        }
        
        function pdfEditorDeleteSelected() {
            if (pdfEditorSelectedIndex < 0) {
                showToast('No annotation selected', 'error');
                return;
            }
            saveToHistory();
            pdfEditorAnnotations.splice(pdfEditorSelectedIndex, 1);
            pdfEditorSelectedIndex = -1;
            updateSelectedInfo();
            renderPdfAnnotations();
            showToast('Annotation deleted', 'success');
        }

        function setPdfHighlightColor(color) {
            pdfEditorHighlightColor = color;
        }

        function zoomPdfEditor(direction) {
            if (direction === 'in') {
                pdfEditorScale += 0.25;
            } else {
                pdfEditorScale = Math.max(0.5, pdfEditorScale - 0.25);
            }
            renderPdfEditorPage();
        }

        function changePdfPage() {
            pdfEditorCurrentPage = parseInt(document.getElementById('pdf-page-selector').value);
            renderPdfEditorPage();
        }

        function clearPdfEdits() {
            if (confirm('Are you sure you want to clear all edits?')) {
                pdfEditorAnnotations = [];
                pdfEditorHistory = [];
                pdfEditorSelectedIndex = -1;
                updateSelectedInfo();
                renderPdfEditorPage();
                showToast('All edits cleared', 'success');
            }
        }

        async function savePdfEdits() {
            if (!pdfEditorDoc) {
                showToast('No PDF loaded', 'error');
                return;
            }

            try {
                const pdfBytes = await pdfEditorDoc.getData();
                const pdfDoc = await PDFLib.PDFDocument.load(pdfBytes);

                for (let pageNum = 1; pageNum <= pdfEditorTotalPages; pageNum++) {
                    const page = pdfDoc.getPage(pageNum - 1);
                    const { height } = page.getSize();

                    const pageAnnotations = pdfEditorAnnotations.filter(ann => ann.page === pageNum);

                    for (const ann of pageAnnotations) {
                        if (ann.type === 'text') {
                            const rgb = hexToRgb(ann.color);
                            page.drawText(ann.text, {
                                x: ann.x / pdfEditorScale,
                                y: height - (ann.y / pdfEditorScale),
                                size: ann.size / pdfEditorScale,
                                color: PDFLib.rgb(rgb.r / 255, rgb.g / 255, rgb.b / 255)
                            });
                        } else if (ann.type === 'signature' && ann.image) {
                            const canvas = document.createElement('canvas');
                            canvas.width = ann.image.width;
                            canvas.height = ann.image.height;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(ann.image, 0, 0);
                            const pngImageBytes = canvas.toDataURL('image/png').split(',')[1];
                            const pngImage = await pdfDoc.embedPng(atob(pngImageBytes));
                            page.drawImage(pngImage, {
                                x: ann.x / pdfEditorScale,
                                y: height - ((ann.y + ann.height) / pdfEditorScale),
                                width: ann.width / pdfEditorScale,
                                height: ann.height / pdfEditorScale
                            });
                        } else if (ann.type === 'highlight') {
                            const rgb = hexToRgb(ann.color);
                            page.drawRectangle({
                                x: ann.x / pdfEditorScale,
                                y: height - ((ann.y + ann.height) / pdfEditorScale),
                                width: ann.width / pdfEditorScale,
                                height: ann.height / pdfEditorScale,
                                color: PDFLib.rgb(rgb.r / 255, rgb.g / 255, rgb.b / 255),
                                opacity: 0.5
                            });
                        }
                    }
                }

                const editedPdfBytes = await pdfDoc.save();
                const blob = new Blob([editedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'edited_' + Date.now() + '.pdf';
                a.click();
                URL.revokeObjectURL(url);

                showToast('Edited PDF saved successfully!', 'success');
            } catch (error) {
                showToast('Error saving PDF: ' + error.message, 'error');
            }
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : { r: 0, g: 0, b: 0 };
        }

    </script>

    <!-- Tooltip positioning script: positions fixed tooltips to avoid clipping by parent containers -->
    <script>
    (function(){
        function positionTooltip(tooltipEl, hostEl) {
            if (!tooltipEl || !hostEl) return;
            // Reset to measure natural size
            tooltipEl.style.left = '0px';
            tooltipEl.style.top = '0px';
            tooltipEl.style.maxWidth = 'calc(100vw - 32px)';

            const hostRect = hostEl.getBoundingClientRect();
            const ttRect = tooltipEl.getBoundingClientRect();
            // Preferred above host
            let top = hostRect.top - ttRect.height - 8;
            let left = hostRect.left + (hostRect.width - ttRect.width) / 2;

            // Clamp horizontally
            left = Math.max(8, Math.min(left, window.innerWidth - ttRect.width - 8));

            // If not enough space above, place below
            if (top < 8) {
                top = hostRect.bottom + 8;
                tooltipEl.style.transformOrigin = 'top center';
                tooltipEl.style.transform = 'translateY(8px)';
            } else {
                tooltipEl.style.transformOrigin = 'bottom center';
                tooltipEl.style.transform = 'translateY(-4px)';
            }

            tooltipEl.style.left = Math.round(left) + 'px';
            tooltipEl.style.top = Math.round(top) + 'px';
        }

        function showTooltip(tt, host) {
            tt.style.visibility = 'visible';
            tt.style.opacity = '1';
            // Position after next frame so dimensions are measured correctly
            requestAnimationFrame(function(){ positionTooltip(tt, host); });
        }

        function hideTooltip(tt) {
            tt.style.visibility = '';
            tt.style.opacity = '';
            tt.style.left = '';
            tt.style.top = '';
            tt.style.transform = '';
        }

        document.querySelectorAll('.tooltip').forEach(function(host){
            var tt = host.querySelector('.tooltiptext');
            if (!tt) return;
            // Ensure tooltip has fixed positioning (matches CSS) so it's removed from flow and never clipped
            tt.style.position = 'fixed';

            host.addEventListener('mouseenter', function(e){ showTooltip(tt, host); });
            host.addEventListener('focus', function(e){ showTooltip(tt, host); }, true);
            host.addEventListener('mousemove', function(e){ positionTooltip(tt, host); });
            host.addEventListener('mouseleave', function(e){ hideTooltip(tt); });
            host.addEventListener('blur', function(e){ hideTooltip(tt); }, true);
        });
    })();
    </script>
    </div>
</body>
</html>